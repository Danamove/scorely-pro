<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scorely - Professional Candidate Analysis Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        .step-indicator {
            transition: all 0.3s ease;
        }
        .step-active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            transform: scale(1.1);
        }
        .step-completed {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        .step-inactive {
            background: #e5e7eb;
            color: #6b7280;
        }
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            min-width: 300px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        .toast.show {
            transform: translateX(0);
        }
        .score-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            color: white;
            margin-bottom: 15px;
        }
        .score-top { background: linear-gradient(135deg, #10b981, #059669); }
        .score-good { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .score-average { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .score-low { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .profile-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .profile-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        .admin-panel {
            background: linear-gradient(135deg, #1f2937, #111827);
            min-height: 100vh;
        }
        .metric-card {
            background: linear-gradient(135deg, #374151, #1f2937);
            border: 1px solid #4b5563;
        }
        .chart-container {
            height: 300px;
            position: relative;
        }
        .feedback-stars {
            font-size: 1.5rem;
            color: #d1d5db;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        .feedback-stars.active {
            color: #fbbf24;
        }
        .feedback-stars:hover {
            color: #f59e0b;
        }
        .save-indicator {
            opacity: 0;
            transition: opacity 0.3s ease;
            font-size: 0.875rem;
            color: #10b981;
        }
        .save-indicator.show {
            opacity: 1;
        }
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .progress-bar {
            background: linear-gradient(90deg, #3b82f6, #1d4ed8);
            transition: width 0.5s ease;
        }
        .email-template {
            background: #f8fafc;
            border-left: 4px solid #3b82f6;
            padding: 16px;
            margin: 12px 0;
            border-radius: 0 8px 8px 0;
        }
        .smart-insight {
            background: linear-gradient(135deg, #ede9fe, #ddd6fe);
            border: 1px solid #c4b5fd;
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <!-- Header -->
    <header class="bg-white shadow-lg border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center">
                        <i class="fas fa-chart-line text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">Scorely</h1>
                        <p class="text-sm text-gray-600">Professional Candidate Analysis</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="save-indicator" id="autoSaveIndicator">
                        <i class="fas fa-check-circle mr-1"></i>
                        <span>Saved</span>
                    </div>
                    <button onclick="resetAll()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-redo mr-2"></i>Reset
                    </button>
                    <button onclick="showAdminModal()" class="bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white px-4 py-2 rounded-lg transition-all">
                        <i class="fas fa-cog mr-2"></i>Admin
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Step Indicators -->
    <div class="bg-white border-b border-gray-200 py-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center">
                <div class="flex space-x-4">
                    <div class="step-indicator step-active w-10 h-10 rounded-full flex items-center justify-center font-semibold cursor-pointer" onclick="goToStep(1)" id="step1">1</div>
                    <div class="step-indicator step-inactive w-10 h-10 rounded-full flex items-center justify-center font-semibold cursor-pointer" onclick="goToStep(2)" id="step2">2</div>
                    <div class="step-indicator step-inactive w-10 h-10 rounded-full flex items-center justify-center font-semibold cursor-pointer" onclick="goToStep(3)" id="step3">3</div>
                    <div class="step-indicator step-inactive w-10 h-10 rounded-full flex items-center justify-center font-semibold cursor-pointer" onclick="goToStep(4)" id="step4">4</div>
                    <div class="step-indicator step-inactive w-10 h-10 rounded-full flex items-center justify-center font-semibold cursor-pointer" onclick="goToStep(5)" id="step5">5</div>
                    <div class="step-indicator step-inactive w-10 h-10 rounded-full flex items-center justify-center font-semibold cursor-pointer" onclick="goToStep(6)" id="step6">6</div>
                </div>
                <div class="text-sm text-gray-600 font-medium" id="stepTitle">Job Requirements</div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Step 1: Job Requirements -->
        <div id="step1Content" class="step-content">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="flex items-center mb-6">
                    <i class="fas fa-briefcase text-blue-600 text-2xl mr-3"></i>
                    <h2 class="text-2xl font-bold text-gray-900">Job Requirements</h2>
                </div>
                <p class="text-gray-600 mb-8">Define the core requirements for this position</p>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-star text-red-500 mr-1"></i>Job Title
                        </label>
                        <input type="text" id="jobTitle" placeholder="e.g., Senior Full-Stack Developer" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                               oninput="debouncedAutoSave()">
                        <p class="text-xs text-gray-500 mt-1">Be specific about seniority level and key responsibilities</p>
                        
                        <label class="block text-sm font-semibold text-gray-700 mb-2 mt-6">
                            <i class="fas fa-file-alt text-blue-600 mr-1"></i>Job Description
                        </label>
                        <textarea id="jobDescription" rows="6" 
                                  placeholder="Describe the role, responsibilities, and basic requirements..."
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                  oninput="debouncedAutoSave()"></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3">
                            <i class="fas fa-map-marker-alt text-green-600 mr-1"></i>Location Preferences
                        </label>
                        <div class="grid grid-cols-2 gap-3">
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="locTelAviv" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Tel Aviv, Israel</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="locJerusalem" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Jerusalem, Israel</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="locHaifa" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Haifa, Israel</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="locGlobal" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Global/Remote</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="locNY" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">New York, USA</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="locLondon" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">London, UK</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end mt-8">
                    <button onclick="nextStep()" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-3 rounded-lg transition-all">
                        Next <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 2: Special Requirements -->
        <div id="step2Content" class="step-content hidden">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="flex items-center mb-6">
                    <i class="fas fa-star text-purple-600 text-2xl mr-3"></i>
                    <h2 class="text-2xl font-bold text-gray-900">Special Requirements</h2>
                </div>
                <p class="text-gray-600 mb-8">Define advanced criteria and specific needs</p>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3">
                            <i class="fas fa-industry text-blue-600 mr-1"></i>Industry Experience
                        </label>
                        <div class="grid grid-cols-2 gap-3 mb-6">
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="indFintech" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">FinTech</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="indSaaS" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">SaaS</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="indEcommerce" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">E-commerce</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="indHealthtech" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">HealthTech</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="indData" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Data</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="indAI" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">AI</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="indAutomotive" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Automotive</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="indCyber" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Cybersecurity</span>
                            </label>
                        </div>
                        
                        <label class="block text-sm font-semibold text-gray-700 mb-3">
                            <i class="fas fa-building text-green-600 mr-1"></i>Company Size
                        </label>
                        <div class="grid grid-cols-2 gap-3">
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="sizeStartup" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Startup (1-50)</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="sizeScaleup" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Scale-up (51-200)</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="sizeMidsize" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Mid-size (201-1000)</span>
                            </label>
                            <label class="flex items-center space-x-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="sizeEnterprise" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" onchange="debouncedAutoSave()">
                                <span class="text-sm">Enterprise (1000+)</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-exclamation-triangle text-orange-600 mr-1"></i>Must Have Requirements
                        </label>
                        <textarea id="mustHave" rows="5" 
                                  placeholder="Critical requirements that are non-negotiable..."
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-6"
                                  oninput="debouncedAutoSave()"></textarea>
                        
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-heart text-red-600 mr-1"></i>Nice to Have
                        </label>
                        <textarea id="niceToHave" rows="5" 
                                  placeholder="Preferred qualifications that would be a bonus..."
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                  oninput="debouncedAutoSave()"></textarea>
                    </div>
                </div>
                
                <div class="flex justify-between mt-8">
                    <button onclick="prevStep()" class="bg-gray-500 hover:bg-gray-600 text-white px-8 py-3 rounded-lg transition-colors">
                        <i class="fas fa-arrow-left mr-2"></i>Previous
                    </button>
                    <button onclick="nextStep()" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-3 rounded-lg transition-all">
                        Next <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 3: Skills & Preferences -->
        <div id="step3Content" class="step-content hidden">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="flex items-center mb-6">
                    <i class="fas fa-code text-green-600 text-2xl mr-3"></i>
                    <h2 class="text-2xl font-bold text-gray-900">Skills & Preferences</h2>
                </div>
                <p class="text-gray-600 mb-8">Define technical and soft skills requirements</p>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-cogs text-blue-600 mr-1"></i>Technical Skills
                        </label>
                        <textarea id="technicalSkills" rows="6" 
                                  placeholder="List required technical skills, technologies, and tools..."
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-6"
                                  oninput="debouncedAutoSave()"></textarea>
                        
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-users text-purple-600 mr-1"></i>Soft Skills
                        </label>
                        <textarea id="softSkills" rows="6" 
                                  placeholder="Communication, leadership, problem-solving abilities..."
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                  oninput="debouncedAutoSave()"></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-clock text-orange-600 mr-1"></i>Experience Level
                        </label>
                        <select id="experienceLevel" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-6" onchange="debouncedAutoSave()">
                            <option value="">Select experience level</option>
                            <option value="entry">Entry Level (0-2 years)</option>
                            <option value="mid">Mid Level (3-5 years)</option>
                            <option value="senior">Senior Level (6-10 years)</option>
                            <option value="lead">Lead/Principal (10+ years)</option>
                        </select>
                        
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-plus text-green-600 mr-1"></i>Additional Preferences
                        </label>
                        <textarea id="niceToHaveSkills" rows="6" 
                                  placeholder="Any additional skills or qualifications that would be beneficial..."
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                  oninput="debouncedAutoSave()"></textarea>
                    </div>
                </div>
                
                <div class="flex justify-between mt-8">
                    <button onclick="prevStep()" class="bg-gray-500 hover:bg-gray-600 text-white px-8 py-3 rounded-lg transition-colors">
                        <i class="fas fa-arrow-left mr-2"></i>Previous
                    </button>
                    <button onclick="nextStep()" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-3 rounded-lg transition-all">
                        Next <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 4: Similar Profiles & Lists -->
        <div id="step4Content" class="step-content hidden">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="flex items-center mb-6">
                    <i class="fas fa-user-friends text-indigo-600 text-2xl mr-3"></i>
                    <h2 class="text-2xl font-bold text-gray-900">Similar Profiles & Target Lists</h2>
                </div>
                <p class="text-gray-600 mb-8">Provide examples of ideal candidates and company targeting</p>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-star text-yellow-500 mr-2"></i>Example Profiles
                        </h3>
                        
                        <div class="space-y-6">
                            <div class="border border-gray-200 rounded-lg p-4">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="font-medium text-gray-900">Example Profile 1</h4>
                                    <div class="flex space-x-2">
                                        <button onclick="document.getElementById('exampleProfile1').click()" class="text-blue-600 hover:text-blue-700 text-sm">
                                            <i class="fas fa-upload mr-1"></i>Upload PDF
                                        </button>
                                    </div>
                                </div>
                                <input type="file" id="exampleProfile1" accept=".pdf,.txt" class="hidden">
                                <textarea id="exampleProfile1Text" rows="6" 
                                          placeholder="Paste or describe an ideal candidate profile..."
                                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                          oninput="debouncedAutoSave()"></textarea>
                            </div>
                            
                            <div class="border border-gray-200 rounded-lg p-4">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="font-medium text-gray-900">Example Profile 2</h4>
                                    <div class="flex space-x-2">
                                        <button onclick="document.getElementById('exampleProfile2').click()" class="text-blue-600 hover:text-blue-700 text-sm">
                                            <i class="fas fa-upload mr-1"></i>Upload PDF
                                        </button>
                                    </div>
                                </div>
                                <input type="file" id="exampleProfile2" accept=".pdf,.txt" class="hidden">
                                <textarea id="exampleProfile2Text" rows="6" 
                                          placeholder="Paste or describe another ideal candidate profile..."
                                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                          oninput="debouncedAutoSave()"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-building text-green-600 mr-2"></i>Company Targeting
                        </h3>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-bullseye text-green-600 mr-1"></i>Target Companies
                                </label>
                                <p class="text-xs text-gray-500 mb-2">Companies where ideal candidates work - profiles from these companies get bonus points</p>
                                <textarea id="targetCompanies" rows="4" 
                                          placeholder="List companies where you'd like to find similar candidates..."
                                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                          oninput="debouncedAutoSave()"></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-ban text-red-600 mr-1"></i>Blacklist Companies
                                </label>
                                <p class="text-xs text-gray-500 mb-2">Companies to avoid or deprioritize in scoring</p>
                                <textarea id="blacklistCompanies" rows="4" 
                                          placeholder="List companies to exclude or deprioritize..."
                                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                          oninput="debouncedAutoSave()"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-between mt-8">
                    <button onclick="prevStep()" class="bg-gray-500 hover:bg-gray-600 text-white px-8 py-3 rounded-lg transition-colors">
                        <i class="fas fa-arrow-left mr-2"></i>Previous
                    </button>
                    <button onclick="nextStep()" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-3 rounded-lg transition-all">
                        Next <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 5: Analysis Setup -->
        <div id="step5Content" class="step-content hidden">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="flex items-center mb-6">
                    <i class="fas fa-upload text-blue-600 text-2xl mr-3"></i>
                    <h2 class="text-2xl font-bold text-gray-900">Analysis Setup</h2>
                </div>
                <p class="text-gray-600 mb-8">Upload candidate profiles and configure analysis parameters</p>
                
                <!-- File Upload Section -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">
                        <i class="fas fa-file-upload text-blue-600 mr-2"></i>Upload Candidate Profiles
                    </h3>
                    
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 transition-colors">
                        <input type="file" id="fileUpload" accept=".csv,.xlsx,.xls" class="hidden" onchange="handleFileUpload(event)">
                        <div onclick="document.getElementById('fileUpload').click()" class="cursor-pointer">
                            <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                            <p class="text-lg text-gray-600 mb-2">Click to upload or drag and drop</p>
                            <p class="text-sm text-gray-500">Supports CSV and Excel files</p>
                        </div>
                    </div>
                    
                    <div id="fileInfo" class="hidden mt-4 p-4 bg-green-50 border border-green-200 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-600 mr-2"></i>
                            <span id="fileInfoText" class="text-green-800 font-medium"></span>
                        </div>
                    </div>
                </div>
                
                <!-- Analysis Configuration -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-sliders-h text-purple-600 mr-2"></i>Scoring Weights
                        </h3>
                        <p class="text-sm text-gray-600 mb-4">Adjust the importance of different scoring criteria (total must equal 100%)</p>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Technical Skills</label>
                                <div class="flex items-center space-x-3">
                                    <input type="range" id="technicalWeight" min="0" max="100" value="30" 
                                           class="flex-1" oninput="updateWeights(); debouncedAutoSave()">
                                    <span id="technicalWeightValue" class="text-sm font-medium text-gray-700 min-w-[3rem]">30%</span>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Experience Level</label>
                                <div class="flex items-center space-x-3">
                                    <input type="range" id="experienceWeight" min="0" max="100" value="25" 
                                           class="flex-1" oninput="updateWeights(); debouncedAutoSave()">
                                    <span id="experienceWeightValue" class="text-sm font-medium text-gray-700 min-w-[3rem]">25%</span>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Cultural Fit</label>
                                <div class="flex items-center space-x-3">
                                    <input type="range" id="culturalWeight" min="0" max="100" value="25" 
                                           class="flex-1" oninput="updateWeights(); debouncedAutoSave()">
                                    <span id="culturalWeightValue" class="text-sm font-medium text-gray-700 min-w-[3rem]">25%</span>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Industry Experience</label>
                                <div class="flex items-center space-x-3">
                                    <input type="range" id="industryWeight" min="0" max="100" value="20" 
                                           class="flex-1" oninput="updateWeights(); debouncedAutoSave()">
                                    <span id="industryWeightValue" class="text-sm font-medium text-gray-700 min-w-[3rem]">20%</span>
                                </div>
                            </div>
                            <div class="pt-2 border-t border-gray-200">
                                <div class="flex justify-between text-sm">
                                    <span class="font-medium text-gray-700">Total:</span>
                                    <span id="totalWeight" class="font-medium text-gray-900">100%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-robot text-indigo-600 mr-2"></i>AI Model Selection
                        </h3>
                        <p class="text-sm text-gray-600 mb-4">Choose the analysis approach</p>
                        
                        <div class="space-y-3">
                            <label class="flex items-start space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="radio" name="aiModel" value="text-embedding-3-small" class="mt-1" onchange="debouncedAutoSave()">
                                <div>
                                    <div class="font-medium text-gray-900">text-embedding-3-small</div>
                                    <div class="text-sm text-gray-600">Fast & cost-effective semantic matching</div>
                                </div>
                            </label>
                            <label class="flex items-start space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="radio" name="aiModel" value="GPT-4" class="mt-1" onchange="debouncedAutoSave()">
                                <div>
                                    <div class="font-medium text-gray-900">GPT-4</div>
                                    <div class="text-sm text-gray-600">Deep analysis & detailed insights</div>
                                </div>
                            </label>
                            <label class="flex items-start space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="radio" name="aiModel" value="Hybrid Mode" checked class="mt-1" onchange="debouncedAutoSave()">
                                <div>
                                    <div class="font-medium text-gray-900">Hybrid Mode</div>
                                    <div class="text-sm text-gray-600">Best of both worlds - optimal accuracy</div>
                                </div>
                            </label>
                        </div>
                        
                        <div class="mt-6">
                            <h4 class="text-md font-semibold text-gray-900 mb-3">Row Range Selection</h4>
                            <p class="text-sm text-gray-600 mb-3">Select which profiles to analyze (starts from row 2 to exclude headers)</p>
                            <div class="grid grid-cols-3 gap-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Total Profiles</label>
                                    <input type="number" id="totalProfiles" readonly 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Start Row</label>
                                    <input type="number" id="startRow" value="2" min="2" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                           oninput="validateRowRange(); debouncedAutoSave()">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">End Row</label>
                                    <input type="number" id="endRow" value="51" min="2" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                           oninput="validateRowRange(); debouncedAutoSave()">
                                </div>
                            </div>
                            <p id="rangeInfo" class="text-sm text-gray-600 mt-2">Will analyze 50 profiles (rows 2-51)</p>
                            <div class="mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                <p class="text-sm text-blue-800">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    Scoring is saved continuously between batches. You can process in segments and results will accumulate.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-between mt-8">
                    <button onclick="prevStep()" class="bg-gray-500 hover:bg-gray-600 text-white px-8 py-3 rounded-lg transition-colors">
                        <i class="fas fa-arrow-left mr-2"></i>Previous
                    </button>
                    <button id="startAnalysisBtn" onclick="startAnalysis()" disabled 
                            class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white px-8 py-3 rounded-lg transition-all disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed">
                        <i class="fas fa-play mr-2"></i>Start Analysis
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 6: Results -->
        <div id="step6Content" class="step-content hidden">
            <div class="space-y-8">
                <!-- Analysis Progress -->
                <div id="analysisProgress" class="bg-white rounded-xl shadow-lg p-8 hidden">
                    <div class="text-center">
                        <div class="loading-spinner w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full mx-auto mb-4"></div>
                        <h3 class="text-xl font-semibold text-gray-900 mb-2">Analyzing Profiles...</h3>
                        <p id="progressText" class="text-gray-600 mb-4">Processing candidates...</p>
                        <div class="w-full bg-gray-200 rounded-full h-3 mb-4">
                            <div id="progressBar" class="progress-bar h-3 rounded-full" style="width: 0%"></div>
                        </div>
                        <button onclick="cancelAnalysis()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-stop mr-2"></i>Cancel Analysis
                        </button>
                    </div>
                </div>

                <!-- Results Dashboard -->
                <div id="resultsSection">
                    <!-- Results Header -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-900">Analysis Results</h2>
                                <p class="text-gray-600">Candidate scoring and recommendations</p>
                            </div>
                            <div class="flex space-x-3">
                                <button onclick="exportProfiles()" class="bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white px-6 py-3 rounded-lg transition-all">
                                    <i class="fas fa-download mr-2"></i>Export Profiles 60+
                                </button>
                                <button onclick="exportInsights()" class="bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white px-6 py-3 rounded-lg transition-all">
                                    <i class="fas fa-lightbulb mr-2"></i>Export Insights
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Summary Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-star text-green-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <div class="text-2xl font-bold text-gray-900">8</div>
                                    <div class="text-sm text-gray-600">TOP Candidates</div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-thumbs-up text-blue-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <div class="text-2xl font-bold text-gray-900">23</div>
                                    <div class="text-sm text-gray-600">GOOD Matches</div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-chart-line text-yellow-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <div class="text-2xl font-bold text-gray-900">76</div>
                                    <div class="text-sm text-gray-600">Average Score</div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-users text-purple-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <div class="text-2xl font-bold text-gray-900">50</div>
                                    <div class="text-sm text-gray-600">Analyzed</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Top Candidates -->
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">
                            <i class="fas fa-trophy text-yellow-500 mr-2"></i>Top Candidates
                        </h3>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" id="topCandidates">
                            <!-- Example candidates will be populated here -->
                            <div class="profile-card bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6">
                                <div class="score-badge score-top">Score: 85</div>
                                <h4 class="text-lg font-semibold text-gray-900 mb-2">Sarah Chen</h4>
                                <p class="text-gray-600 mb-3"><strong>Company:</strong> TechCorp</p>
                                <p class="text-gray-600 mb-4"><strong>Title:</strong> Senior Full-Stack Developer</p>
                                
                                <div class="mb-4">
                                    <h5 class="font-semibold text-gray-900 mb-2">ðŸ“Š Detailed Scores:</h5>
                                    <div class="grid grid-cols-2 gap-2 text-sm">
                                        <div>Technical: <span class="font-semibold">90/100</span></div>
                                        <div>Cultural: <span class="font-semibold">80/100</span></div>
                                        <div>Experience: <span class="font-semibold">85/100</span></div>
                                        <div>Industry: <span class="font-semibold">85/100</span></div>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <h5 class="font-semibold text-gray-900 mb-2">ðŸ’ª Strengths:</h5>
                                    <ul class="text-sm text-gray-700 list-disc list-inside">
                                        <li>Strong full-stack expertise with modern tech stack</li>
                                        <li>Proven startup experience and adaptability</li>
                                        <li>System architecture and migration experience</li>
                                    </ul>
                                </div>
                                
                                <div class="mb-4">
                                    <h5 class="font-semibold text-gray-900 mb-2">âš ï¸ Considerations:</h5>
                                    <ul class="text-sm text-gray-700 list-disc list-inside">
                                        <li>May expect senior-level compensation</li>
                                        <li>Limited enterprise-scale experience</li>
                                    </ul>
                                </div>
                                
                                <div class="email-template">
                                    <h5 class="font-semibold text-gray-900 mb-2">ðŸ“§ Email Templates:</h5>
                                    <div class="space-y-2 text-sm">
                                        <div class="p-2 bg-white rounded border">
                                            <strong>Option 1:</strong> "Your experience architecting scalable systems and leading technical migrations demonstrates the kind of engineering leadership we need."
                                        </div>
                                        <div class="p-2 bg-white rounded border">
                                            <strong>Option 2:</strong> "Your track record of building full-stack solutions while navigating fast-paced startup environments aligns perfectly with our scaling challenges."
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="profile-card bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6">
                                <div class="score-badge score-good">Score: 72</div>
                                <h4 class="text-lg font-semibold text-gray-900 mb-2">Alex Rodriguez</h4>
                                <p class="text-gray-600 mb-3"><strong>Company:</strong> InnovateTech</p>
                                <p class="text-gray-600 mb-4"><strong>Title:</strong> Backend Engineer</p>
                                
                                <div class="mb-4">
                                    <h5 class="font-semibold text-gray-900 mb-2">ðŸ“Š Detailed Scores:</h5>
                                    <div class="grid grid-cols-2 gap-2 text-sm">
                                        <div>Technical: <span class="font-semibold">85/100</span></div>
                                        <div>Cultural: <span class="font-semibold">70/100</span></div>
                                        <div>Experience: <span class="font-semibold">65/100</span></div>
                                        <div>Industry: <span class="font-semibold">75/100</span></div>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <h5 class="font-semibold text-gray-900 mb-2">ðŸ’ª Strengths:</h5>
                                    <ul class="text-sm text-gray-700 list-disc list-inside">
                                        <li>Strong backend development skills</li>
                                        <li>Good technical foundation</li>
                                        <li>Growth potential and learning attitude</li>
                                    </ul>
                                </div>
                                
                                <div class="mb-4">
                                    <h5 class="font-semibold text-gray-900 mb-2">âš ï¸ Considerations:</h5>
                                    <ul class="text-sm text-gray-700 list-disc list-inside">
                                        <li>Limited startup experience</li>
                                        <li>May need mentoring in full-stack development</li>
                                    </ul>
                                </div>
                                
                                <div class="email-template">
                                    <h5 class="font-semibold text-gray-900 mb-2">ðŸ“§ Email Templates:</h5>
                                    <div class="space-y-2 text-sm">
                                        <div class="p-2 bg-white rounded border">
                                            <strong>Option 1:</strong> "Your backend expertise and technical foundation would be valuable as we scale our infrastructure."
                                        </div>
                                        <div class="p-2 bg-white rounded border">
                                            <strong>Option 2:</strong> "Your development skills and growth mindset align well with our team's collaborative approach."
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Smart AI Engine -->
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">
                            <i class="fas fa-brain text-purple-500 mr-2"></i>Smart AI Engine
                        </h3>
                        
                        <div class="space-y-6">
                            <div class="smart-insight">
                                <h4 class="font-semibold text-purple-900 mb-3">
                                    <i class="fas fa-gem text-purple-600 mr-2"></i>Hidden Gems (3 candidates)
                                </h4>
                                <p class="text-purple-800 mb-3">Candidates with unique potential that may not show in traditional scoring:</p>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center p-3 bg-white rounded border">
                                        <div>
                                            <strong>David Kim (Score: 68)</strong> - Career transition from finance to tech shows exceptional learning ability
                                        </div>
                                        <a href="#" class="text-purple-600 hover:text-purple-700">
                                            <i class="fas fa-linkedin"></i>
                                        </a>
                                    </div>
                                    <div class="flex justify-between items-center p-3 bg-white rounded border">
                                        <div>
                                            <strong>Maya Patel (Score: 71)</strong> - Open source contributions demonstrate passion beyond work requirements
                                        </div>
                                        <a href="#" class="text-purple-600 hover:text-purple-700">
                                            <i class="fas fa-linkedin"></i>
                                        </a>
                                    </div>
                                    <div class="flex justify-between items-center p-3 bg-white rounded border">
                                        <div>
                                            <strong>Lisa Zhang (Score: 69)</strong> - Recent graduate with impressive project portfolio
                                        </div>
                                        <a href="#" class="text-purple-600 hover:text-purple-700">
                                            <i class="fas fa-linkedin"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="smart-insight bg-gradient-to-br from-orange-50 to-yellow-50 border-orange-200">
                                <h4 class="font-semibold text-orange-900 mb-3">
                                    <i class="fas fa-exclamation-triangle text-orange-600 mr-2"></i>Low Profile Data (5 candidates)
                                </h4>
                                <p class="text-orange-800 mb-3">Candidates with insufficient information who might be worth a follow-up call:</p>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center p-3 bg-white rounded border">
                                        <div>
                                            <strong>Tom Wilson</strong> - Limited LinkedIn data but strong technical keywords suggest potential
                                        </div>
                                        <a href="#" class="text-orange-600 hover:text-orange-700">
                                            <i class="fas fa-linkedin"></i>
                                        </a>
                                    </div>
                                    <div class="flex justify-between items-center p-3 bg-white rounded border">
                                        <div>
                                            <strong>Emma Johnson</strong> - Profile summary contains relevant skills but lacks detail
                                        </div>
                                        <a href="#" class="text-orange-600 hover:text-orange-700">
                                            <i class="fas fa-linkedin"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="smart-insight bg-gradient-to-br from-blue-50 to-cyan-50 border-blue-200">
                                <h4 class="font-semibold text-blue-900 mb-3">
                                    <i class="fas fa-search text-blue-600 mr-2"></i>Worth Reviewing (2 candidates)
                                </h4>
                                <p class="text-blue-800 mb-3">Unique candidates worth considering despite lower scores:</p>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center p-3 bg-white rounded border">
                                        <div>
                                            <strong>Michael Chen (Score: 58)</strong> - Founder experience shows entrepreneurial mindset valuable for startup environment
                                        </div>
                                        <a href="#" class="text-blue-600 hover:text-blue-700">
                                            <i class="fas fa-linkedin"></i>
                                        </a>
                                    </div>
                                    <div class="flex justify-between items-center p-3 bg-white rounded border">
                                        <div>
                                            <strong>Rachel Green (Score: 62)</strong> - Unique combination of technical and design skills
                                        </div>
                                        <a href="#" class="text-blue-600 hover:text-blue-700">
                                            <i class="fas fa-linkedin"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Hiring Insights -->
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">
                            <i class="fas fa-chart-bar text-indigo-500 mr-2"></i>Hiring Insights
                        </h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-4">
                                    <i class="fas fa-building text-blue-600 mr-2"></i>Top Talent Sources
                                </h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-700">Tech startups</span>
                                        <span class="font-semibold text-blue-600">40%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-700">Elite military units</span>
                                        <span class="font-semibold text-blue-600">25%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-700">Top universities</span>
                                        <span class="font-semibold text-blue-600">20%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-700">Big tech companies</span>
                                        <span class="font-semibold text-blue-600">15%</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-4">
                                    <i class="fas fa-lightbulb text-yellow-600 mr-2"></i>Recommendations
                                </h4>
                                <ul class="space-y-2 text-gray-700">
                                    <li class="flex items-start">
                                        <i class="fas fa-arrow-right text-green-600 mt-1 mr-2"></i>
                                        Focus recruiting efforts on Series A-B startups and Technion/Tel Aviv University alumni networks
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-arrow-right text-green-600 mt-1 mr-2"></i>
                                        TOP candidates likely expect 15-25% above market rate due to competitive background
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-arrow-right text-green-600 mt-1 mr-2"></i>
                                        Consider profiles with rapid career progression as indicators of high potential
                                    </li>
                                </ul>
                                
                                <div class="mt-6 p-4 bg-green-50 border border-green-200 rounded-lg">
                                    <h5 class="font-semibold text-green-900 mb-2">ðŸ’° Salary Expectations</h5>
                                    <p class="text-green-800 text-sm">Based on candidate backgrounds, expect salary ranges 15-25% above standard market rates due to high-quality profiles and competitive startup experience.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AI Feedback System -->
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">
                            <i class="fas fa-comment-alt text-green-500 mr-2"></i>AI Feedback System
                        </h3>
                        <p class="text-gray-600 mb-6">Help improve scoring accuracy for future analyses</p>
                        
                        <div class="space-y-6">
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-3">Overall Scoring Quality</h4>
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm text-gray-600">Rate the overall accuracy:</span>
                                    <div class="flex space-x-1" id="overallRating">
                                        <i class="fas fa-star feedback-stars" onclick="setOverallRating(1)"></i>
                                        <i class="fas fa-star feedback-stars" onclick="setOverallRating(2)"></i>
                                        <i class="fas fa-star feedback-stars" onclick="setOverallRating(3)"></i>
                                        <i class="fas fa-star feedback-stars" onclick="setOverallRating(4)"></i>
                                        <i class="fas fa-star feedback-stars" onclick="setOverallRating(5)"></i>
                                    </div>
                                    <span id="ratingText" class="text-sm text-gray-500 ml-2">Click to rate</span>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-3">Quick Profile Feedback</h4>
                                <div class="space-y-3">
                                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <span class="text-gray-700">Sarah Chen - Score 85</span>
                                        <div class="flex space-x-1">
                                            <i class="fas fa-star feedback-stars active"></i>
                                            <i class="fas fa-star feedback-stars active"></i>
                                            <i class="fas fa-star feedback-stars active"></i>
                                            <i class="fas fa-star feedback-stars active"></i>
                                            <i class="fas fa-star feedback-stars"></i>
                                        </div>
                                        <span class="text-sm text-gray-500">Score accurate</span>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <span class="text-gray-700">Alex Rodriguez - Score 72</span>
                                        <div class="flex space-x-1">
                                            <i class="fas fa-star feedback-stars active"></i>
                                            <i class="fas fa-star feedback-stars active"></i>
                                            <i class="fas fa-star feedback-stars active"></i>
                                            <i class="fas fa-star feedback-stars"></i>
                                            <i class="fas fa-star feedback-stars"></i>
                                        </div>
                                        <span class="text-sm text-gray-500">Slightly overrated</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-3">General Comments</h4>
                                <textarea id="feedbackComments" rows="4" 
                                          placeholder="Share your thoughts on the analysis quality, any patterns you noticed, or suggestions for improvement..."
                                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                            </div>
                            
                            <div class="flex justify-end">
                                <button onclick="submitFeedback()" class="bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white px-8 py-3 rounded-lg transition-all">
                                    <i class="fas fa-paper-plane mr-2"></i>Submit Feedback
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex justify-between mt-8">
                    <button onclick="prevStep()" class="bg-gray-500 hover:bg-gray-600 text-white px-8 py-3 rounded-lg transition-colors">
                        <i class="fas fa-arrow-left mr-2"></i>Previous
                    </button>
                    <button onclick="resetAll()" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-3 rounded-lg transition-all">
                        <i class="fas fa-redo mr-2"></i>New Analysis
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Admin Modal -->
    <div id="adminModal" class="fixed inset-0 z-50 hidden">
        <div class="fixed inset-0 bg-black bg-opacity-50" onclick="hideAdminModal()"></div>
        <div class="fixed inset-0 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
                <div class="flex items-center justify-between p-6 border-b border-gray-200">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-purple-600 to-blue-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-shield-alt text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">Admin Access</h3>
                            <p class="text-sm text-gray-600">Enter your credentials to access admin features</p>
                        </div>
                    </div>
                    <button onclick="hideAdminModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-6">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                            <input type="email" id="adminEmail" value="dana@added-value.co.il" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                            <input type="password" id="adminPassword" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 mt-6">
                        <button onclick="hideAdminModal()" class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                            Cancel
                        </button>
                        <button onclick="adminLogin()" class="px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-lg transition-all">
                            Login
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="fixed inset-0 z-50 hidden admin-panel">
        <div class="flex h-full">
            <!-- Sidebar -->
            <div class="w-64 bg-gray-800 p-6">
                <div class="flex items-center space-x-3 mb-8">
                    <div class="w-10 h-10 bg-gradient-to-br from-purple-600 to-blue-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-shield-alt text-white"></i>
                    </div>
                    <div>
                        <h2 class="text-lg font-semibold text-white">Admin Panel</h2>
                        <p class="text-sm text-gray-400">Scorely Management</p>
                    </div>
                </div>
                
                <nav class="space-y-2">
                    <button onclick="showAdminSection('dashboard')" class="admin-nav-btn w-full flex items-center space-x-3 px-4 py-3 text-gray-300 hover:text-white hover:bg-gray-700 rounded-lg transition-colors">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </button>
                    <button onclick="showAdminSection('apikeys')" class="admin-nav-btn w-full flex items-center space-x-3 px-4 py-3 text-gray-300 hover:text-white hover:bg-gray-700 rounded-lg transition-colors">
                        <i class="fas fa-key"></i>
                        <span>API Keys</span>
                    </button>
                    <button onclick="showAdminSection('users')" class="admin-nav-btn w-full flex items-center space-x-3 px-4 py-3 text-gray-300 hover:text-white hover:bg-gray-700 rounded-lg transition-colors">
                        <i class="fas fa-users"></i>
                        <span>Users</span>
                    </button>
                    <button onclick="showAdminSection('performance')" class="admin-nav-btn w-full flex items-center space-x-3 px-4 py-3 text-gray-300 hover:text-white hover:bg-gray-700 rounded-lg transition-colors">
                        <i class="fas fa-chart-line"></i>
                        <span>Performance</span>
                    </button>
                    <button onclick="showAdminSection('settings')" class="admin-nav-btn w-full flex items-center space-x-3 px-4 py-3 text-gray-300 hover:text-white hover:bg-gray-700 rounded-lg transition-colors">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </button>
                </nav>
                
                <div class="absolute bottom-6 left-6 right-6">
                    <button onclick="closeAdminPanel()" class="w-full flex items-center justify-center space-x-2 px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Exit Admin</span>
                    </button>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="flex-1 overflow-auto">
                <!-- Dashboard -->
                <div id="adminDashboard" class="admin-section p-8">
                    <h3 class="text-2xl font-bold text-white mb-8">System Dashboard</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="metric-card p-6 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="text-2xl font-bold text-white">1,247</div>
                                    <div class="text-sm text-gray-400">Total Analyses</div>
                                </div>
                                <i class="fas fa-chart-bar text-blue-400 text-2xl"></i>
                            </div>
                        </div>
                        <div class="metric-card p-6 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="text-2xl font-bold text-white">9</div>
                                    <div class="text-sm text-gray-400">Active Users</div>
                                </div>
                                <i class="fas fa-users text-green-400 text-2xl"></i>
                            </div>
                        </div>
                        <div class="metric-card p-6 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="text-2xl font-bold text-white">98.5%</div>
                                    <div class="text-sm text-gray-400">Success Rate</div>
                                </div>
                                <i class="fas fa-check-circle text-green-400 text-2xl"></i>
                            </div>
                        </div>
                        <div class="metric-card p-6 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="text-2xl font-bold text-white">2.3s</div>
                                    <div class="text-sm text-gray-400">Avg Response</div>
                                </div>
                                <i class="fas fa-clock text-yellow-400 text-2xl"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="metric-card p-6 rounded-lg">
                            <h4 class="text-lg font-semibold text-white mb-4">Usage Over Time</h4>
                            <div class="chart-container">
                                <canvas id="usageChart"></canvas>
                            </div>
                        </div>
                        <div class="metric-card p-6 rounded-lg">
                            <h4 class="text-lg font-semibold text-white mb-4">Model Performance</h4>
                            <div class="chart-container">
                                <canvas id="performanceChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- API Keys -->
                <div id="adminApikeys" class="admin-section p-8 hidden">
                    <h3 class="text-2xl font-bold text-white mb-8">API Key Management</h3>
                    
                    <div class="metric-card p-6 rounded-lg mb-6">
                        <h4 class="text-lg font-semibold text-white mb-4">OpenAI API Configuration</h4>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">API Key</label>
                                <div class="flex space-x-3">
                                    <input type="password" id="openaiApiKey" value="sk-proj-****" 
                                           class="flex-1 px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <button onclick="toggleApiKeyVisibility()" class="px-4 py-3 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Organization ID</label>
                                    <input type="text" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Rate Limit (RPM)</label>
                                    <input type="number" value="60" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                            </div>
                            <button class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors">
                                <i class="fas fa-save mr-2"></i>Save Configuration
                            </button>
                        </div>
                    </div>
                    
                    <div class="metric-card p-6 rounded-lg">
                        <h4 class="text-lg font-semibold text-white mb-4">API Usage Statistics</h4>
                        <div class="grid grid-cols-3 gap-6">
                            <div class="text-center">
                                <div class="text-3xl font-bold text-blue-400">$247.50</div>
                                <div class="text-sm text-gray-400">This Month</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-green-400">15,240</div>
                                <div class="text-sm text-gray-400">Tokens Used</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-yellow-400">1,847</div>
                                <div class="text-sm text-gray-400">API Calls</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Users -->
                <div id="adminUsers" class="admin-section p-8 hidden">
                    <h3 class="text-2xl font-bold text-white mb-8">User Management</h3>
                    
                    <div class="metric-card p-6 rounded-lg">
                        <div class="flex justify-between items-center mb-6">
                            <h4 class="text-lg font-semibold text-white">Active Users (9/9)</h4>
                            <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-plus mr-2"></i>Add User
                            </button>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr class="border-b border-gray-600">
                                        <th class="text-gray-300 font-semibold py-3">User</th>
                                        <th class="text-gray-300 font-semibold py-3">Role</th>
                                        <th class="text-gray-300 font-semibold py-3">Last Active</th>
                                        <th class="text-gray-300 font-semibold py-3">Analyses</th>
                                        <th class="text-gray-300 font-semibold py-3">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="text-white">
                                    <tr class="border-b border-gray-700">
                                        <td class="py-4">dana@added-value.co.il</td>
                                        <td class="py-4"><span class="bg-purple-600 px-2 py-1 rounded text-xs">Admin</span></td>
                                        <td class="py-4">2 hours ago</td>
                                        <td class="py-4">342</td>
                                        <td class="py-4">
                                            <button class="text-blue-400 hover:text-blue-300 mr-3">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-red-400 hover:text-red-300">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    <tr class="border-b border-gray-700">
                                        <td class="py-4">alex@added-value.co.il</td>
                                        <td class="py-4"><span class="bg-purple-600 px-2 py-1 rounded text-xs">Admin</span></td>
                                        <td class="py-4">1 day ago</td>
                                        <td class="py-4">298</td>
                                        <td class="py-4">
                                            <button class="text-blue-400 hover:text-blue-300 mr-3">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-red-400 hover:text-red-300">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Performance -->
                <div id="adminPerformance" class="admin-section p-8 hidden">
                    <h3 class="text-2xl font-bold text-white mb-8">Performance Metrics</h3>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="metric-card p-6 rounded-lg">
                            <h4 class="text-lg font-semibold text-white mb-4">Response Times</h4>
                            <div class="space-y-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">Embedding API</span>
                                    <span class="text-green-400 font-semibold">1.2s avg</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">GPT-4 API</span>
                                    <span class="text-yellow-400 font-semibold">3.8s avg</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">File Processing</span>
                                    <span class="text-green-400 font-semibold">0.5s avg</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">Total Pipeline</span>
                                    <span class="text-blue-400 font-semibold">2.3s avg</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="metric-card p-6 rounded-lg">
                            <h4 class="text-lg font-semibold text-white mb-4">Error Rates</h4>
                            <div class="chart-container">
                                <canvas id="errorChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card p-6 rounded-lg mt-8">
                        <h4 class="text-lg font-semibold text-white mb-4">Model Performance Comparison</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr class="border-b border-gray-600">
                                        <th class="text-gray-300 font-semibold py-3">Model</th>
                                        <th class="text-gray-300 font-semibold py-3">Avg Response Time</th>
                                        <th class="text-gray-300 font-semibold py-3">Success Rate</th>
                                        <th class="text-gray-300 font-semibold py-3">Cost per Request</th>
                                        <th class="text-gray-300 font-semibold py-3">User Satisfaction</th>
                                    </tr>
                                </thead>
                                <tbody class="text-white">
                                    <tr class="border-b border-gray-700">
                                        <td class="py-4">text-embedding-3-small</td>
                                        <td class="py-4">1.2s</td>
                                        <td class="py-4">99.8%</td>
                                        <td class="py-4">$0.0001</td>
                                        <td class="py-4">4.2/5</td>
                                    </tr>
                                    <tr class="border-b border-gray-700">
                                        <td class="py-4">GPT-4</td>
                                        <td class="py-4">3.8s</td>
                                        <td class="py-4">98.2%</td>
                                        <td class="py-4">$0.03</td>
                                        <td class="py-4">4.7/5</td>
                                    </tr>
                                    <tr class="border-b border-gray-700">
                                        <td class="py-4">Hybrid Mode</td>
                                        <td class="py-4">2.3s</td>
                                        <td class="py-4">99.1%</td>
                                        <td class="py-4">$0.021</td>
                                        <td class="py-4">4.8/5</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Settings -->
                <div id="adminSettings" class="admin-section p-8 hidden">
                    <h3 class="text-2xl font-bold text-white mb-8">System Settings</h3>
                    
                    <div class="space-y-8">
                        <div class="metric-card p-6 rounded-lg">
                            <h4 class="text-lg font-semibold text-white mb-4">Hybrid Mode Configuration</h4>
                            <div class="grid grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Embedding Weight</label>
                                    <div class="flex items-center space-x-3">
                                        <input type="range" id="adminEmbeddingWeight" min="0" max="100" value="30" 
                                               class="flex-1" oninput="updateAdminWeights()">
                                        <span id="adminEmbeddingValue" class="text-white min-w-[3rem]">30%</span>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">GPT Weight</label>
                                    <div class="flex items-center space-x-3">
                                        <input type="range" id="adminGptWeight" min="0" max="100" value="70" 
                                               class="flex-1" oninput="updateAdminWeights()">
                                        <span id="adminGptValue" class="text-white min-w-[3rem]">70%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="metric-card p-6 rounded-lg">
                            <h4 class="text-lg font-semibold text-white mb-4">Rate Limiting</h4>
                            <div class="grid grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Concurrent Requests</label>
                                    <input type="number" value="5" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Batch Size</label>
                                    <input type="number" value="10" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Retry Attempts</label>
                                    <input type="number" value="3" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white">
                                </div>
                            </div>
                        </div>
                        
                        <div class="metric-card p-6 rounded-lg">
                            <h4 class="text-lg font-semibold text-white mb-4">Security Settings</h4>
                            <div class="space-y-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">Enable Two-Factor Authentication</span>
                                    <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                                        Enabled
                                    </button>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">Session Timeout (minutes)</span>
                                    <input type="number" value="60" class="w-20 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white">
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">Max Login Attempts</span>
                                    <input type="number" value="3" class="w-20 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white">
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex justify-end">
                            <button class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg transition-colors">
                                <i class="fas fa-save mr-2"></i>Save All Settings
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentStep = 1;
        let candidateData = [];
        let analysisResults = [];
        let isCancelled = false;
        let saveTimeout;
        let overallRating = 0;
        let performanceMetrics = {
            embeddingTime: 0,
            gptTime: 0,
            totalTime: 0,
            processedCount: 0,
            errorCount: 0,
            retryCount: 0
        };

        // Admin credentials
        const adminCredentials = {
            'dana@added-value.co.il': 'Scorely2025!',
            'alex@added-value.co.il': 'Anoutherscorely2025!'
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            updateStepDisplay();
            loadSavedData();
            initializeFileHandlers();
            initializeCharts();
            validateCurrentStep();
        });

        // Step Navigation
        function goToStep(step) {
            if (step >= 1 && step <= 6) {
                currentStep = step;
                updateStepDisplay();
                debouncedAutoSave();
            }
        }

        function nextStep() {
            if (validateCurrentStep() && currentStep < 6) {
                currentStep++;
                updateStepDisplay();
                debouncedAutoSave();
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepDisplay();
                debouncedAutoSave();
            }
        }

        function updateStepDisplay() {
            // Hide all step content
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));
            
            // Show current step content
            const currentContent = document.getElementById(`step${currentStep}Content`);
            if (currentContent) {
                currentContent.classList.remove('hidden');
            }

            // Update step indicators
            for (let i = 1; i <= 6; i++) {
                const stepEl = document.getElementById(`step${i}`);
                if (stepEl) {
                    stepEl.className = 'step-indicator w-10 h-10 rounded-full flex items-center justify-center font-semibold cursor-pointer';
                    if (i < currentStep) {
                        stepEl.classList.add('step-completed');
                        stepEl.innerHTML = '<i class="fas fa-check"></i>';
                    } else if (i === currentStep) {
                        stepEl.classList.add('step-active');
                        stepEl.textContent = i;
                    } else {
                        stepEl.classList.add('step-inactive');
                        stepEl.textContent = i;
                    }
                }
            }

            // Update step title
            const titles = {
                1: 'Job Requirements',
                2: 'Special Requirements', 
                3: 'Skills & Preferences',
                4: 'Similar Profiles & Lists',
                5: 'Analysis Setup',
                6: 'Results & Analytics'
            };
            
            const titleEl = document.getElementById('stepTitle');
            if (titleEl) {
                titleEl.textContent = titles[currentStep] || '';
            }

            // Show results if on step 6
            if (currentStep === 6) {
                document.getElementById('resultsSection').style.display = 'block';
            }
        }

        // Validation
        function validateCurrentStep() {
            switch (currentStep) {
                case 1:
                    const jobTitle = document.getElementById('jobTitle').value.trim();
                    const jobDescription = document.getElementById('jobDescription').value.trim();
                    if (!jobTitle || !jobDescription) {
                        showToast('Please fill in job title and description', 'error');
                        return false;
                    }
                    break;
                case 5:
                    if (candidateData.length === 0) {
                        showToast('Please upload a candidate file before proceeding', 'error');
                        return false;
                    }
                    break;
            }
            return true;
        }

        // Auto-save functionality
        function debouncedAutoSave() {
            showSaveIndicator();
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(() => {
                autoSave();
                hideSaveIndicator();
            }, 500);
        }

        function autoSave() {
            const formData = {
                currentStep,
                jobTitle: document.getElementById('jobTitle')?.value || '',
                jobDescription: document.getElementById('jobDescription')?.value || '',
                mustHave: document.getElementById('mustHave')?.value || '',
                niceToHave: document.getElementById('niceToHave')?.value || '',
                technicalSkills: document.getElementById('technicalSkills')?.value || '',
                softSkills: document.getElementById('softSkills')?.value || '',
                niceToHaveSkills: document.getElementById('niceToHaveSkills')?.value || '',
                experienceLevel: document.getElementById('experienceLevel')?.value || '',
                exampleProfile1Text: document.getElementById('exampleProfile1Text')?.value || '',
                exampleProfile2Text: document.getElementById('exampleProfile2Text')?.value || '',
                targetCompanies: document.getElementById('targetCompanies')?.value || '',
                blacklistCompanies: document.getElementById('blacklistCompanies')?.value || '',
                // Checkboxes
                locTelAviv: document.getElementById('locTelAviv')?.checked || false,
                locJerusalem: document.getElementById('locJerusalem')?.checked || false,
                locHaifa: document.getElementById('locHaifa')?.checked || false,
                locGlobal: document.getElementById('locGlobal')?.checked || false,
                locNY: document.getElementById('locNY')?.checked || false,
                locLondon: document.getElementById('locLondon')?.checked || false,
                // Industries
                indFintech: document.getElementById('indFintech')?.checked || false,
                indSaaS: document.getElementById('indSaaS')?.checked || false,
                indEcommerce: document.getElementById('indEcommerce')?.checked || false,
                indHealthtech: document.getElementById('indHealthtech')?.checked || false,
                indData: document.getElementById('indData')?.checked || false,
                indAI: document.getElementById('indAI')?.checked || false,
                indAutomotive: document.getElementById('indAutomotive')?.checked || false,
                indCyber: document.getElementById('indCyber')?.checked || false,
                // Company sizes
                sizeStartup: document.getElementById('sizeStartup')?.checked || false,
                sizeScaleup: document.getElementById('sizeScaleup')?.checked || false,
                sizeMidsize: document.getElementById('sizeMidsize')?.checked || false,
                sizeEnterprise: document.getElementById('sizeEnterprise')?.checked || false,
                // Weights
                technicalWeight: document.getElementById('technicalWeight')?.value || 30,
                experienceWeight: document.getElementById('experienceWeight')?.value || 25,
                culturalWeight: document.getElementById('culturalWeight')?.value || 25,
                industryWeight: document.getElementById('industryWeight')?.value || 20,
                // AI Model
                aiModel: document.querySelector('input[name="aiModel"]:checked')?.value || 'Hybrid Mode',
                // Row range
                startRow: document.getElementById('startRow')?.value || 2,
                endRow: document.getElementById('endRow')?.value || 51
            };

            try {
                localStorage.setItem('scorelyFormData', JSON.stringify(formData));
            } catch (error) {
                console.warn('Could not save to localStorage:', error);
            }
        }

        function loadSavedData() {
            try {
                const savedData = localStorage.getItem('scorelyFormData');
                if (!savedData) return;

                const formData = JSON.parse(savedData);
                
                // Restore form values
                Object.keys(formData).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        if (element.type === 'checkbox') {
                            element.checked = formData[key];
                        } else if (element.type === 'radio') {
                            if (element.value === formData[key]) {
                                element.checked = true;
                            }
                        } else {
                            element.value = formData[key];
                        }
                    }
                });

                // Restore radio buttons
                if (formData.aiModel) {
                    const radio = document.querySelector(`input[name="aiModel"][value="${formData.aiModel}"]`);
                    if (radio) radio.checked = true;
                }

                // Restore current step
                if (formData.currentStep) {
                    currentStep = formData.currentStep;
                    updateStepDisplay();
                }

                updateWeights();
            } catch (error) {
                console.warn('Could not load saved data:', error);
            }
        }

        function showSaveIndicator() {
            const indicator = document.getElementById('autoSaveIndicator');
            indicator.innerHTML = '<i class="fas fa-spinner loading-spinner mr-1"></i><span>Saving...</span>';
            indicator.classList.add('show');
        }

        function hideSaveIndicator() {
            const indicator = document.getElementById('autoSaveIndicator');
            indicator.innerHTML = '<i class="fas fa-check-circle mr-1"></i><span>Saved</span>';
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }

        // Toast notifications
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast p-4 rounded-lg shadow-lg text-white ${
                type === 'success' ? 'bg-green-600' :
                type === 'error' ? 'bg-red-600' :
                type === 'warning' ? 'bg-yellow-600' : 'bg-blue-600'
            }`;
            
            const icon = type === 'success' ? 'check-circle' :
                        type === 'error' ? 'exclamation-triangle' :
                        type === 'warning' ? 'exclamation-circle' : 'info-circle';
            
            toast.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${icon} mr-3"></i>
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            document.getElementById('toastContainer').appendChild(toast);
            
            // Show animation
            setTimeout(() => toast.classList.add('show'), 100);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 5000);
        }

        // Weight management
        function updateWeights() {
            const weights = ['technical', 'experience', 'cultural', 'industry'];
            let total = 0;
            
            weights.forEach(weight => {
                const value = parseInt(document.getElementById(weight + 'Weight').value);
                document.getElementById(weight + 'WeightValue').textContent = value + '%';
                total += value;
            });
            
            document.getElementById('totalWeight').textContent = total + '%';
            
            // Change color based on total
            const totalEl = document.getElementById('totalWeight');
            if (total === 100) {
                totalEl.className = 'font-medium text-green-600';
            } else if (total > 100) {
                totalEl.className = 'font-medium text-red-600';
            } else {
                totalEl.className = 'font-medium text-yellow-600';
            }
        }

        // File handling
        function initializeFileHandlers() {
            // Example profile file handlers
            document.getElementById('exampleProfile1').addEventListener('change', function(e) {
                handleExampleProfileUpload(e, 'exampleProfile1Text');
            });

            document.getElementById('exampleProfile2').addEventListener('change', function(e) {
                handleExampleProfileUpload(e, 'exampleProfile2Text');
            });
        }

        function handleExampleProfileUpload(event, textAreaId) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById(textAreaId).value = e.target.result;
                debouncedAutoSave();
                showToast(`${file.name} loaded successfully`, 'success');
            };
            reader.readAsText(file);
        }

        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const fileInfo = document.getElementById('fileInfo');
            const fileInfoText = document.getElementById('fileInfoText');
            
            try {
                showToast('Processing file...', 'info');
                
                let profiles = [];
                
                if (file.name.endsWith('.csv')) {
                    const text = await file.text();
                    profiles = parseCSV(text);
                } else if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                    const buffer = await file.arrayBuffer();
                    profiles = parseExcel(buffer);
                } else {
                    throw new Error('Unsupported file format. Please use CSV or Excel files.');
                }

                // Process and validate profiles
                candidateData = await processProfiles(profiles);
                
                console.log(`Loaded ${candidateData.length} profiles successfully`);
                
                // Update UI
                const totalProfilesEl = document.getElementById('totalProfiles');
                const endRowEl = document.getElementById('endRow');
                
                if (totalProfilesEl) totalProfilesEl.value = candidateData.length;
                if (endRowEl) {
                    endRowEl.max = candidateData.length + 1;
                    endRowEl.value = Math.min(candidateData.length + 1, parseInt(endRowEl.value));
                }
                
                // Show file info
                fileInfo.classList.remove('hidden');
                fileInfo.classList.remove('bg-red-50', 'border-red-200');
                fileInfo.classList.add('bg-green-50', 'border-green-200');
                fileInfoText.textContent = `Uploaded ${file.name} â€” ${candidateData.length} profiles loaded`;
                
                // Enable analysis button
                const startBtn = document.getElementById('startAnalysisBtn');
                if (startBtn) startBtn.disabled = false;
                
                validateRowRange();
                debouncedAutoSave();
                showToast(`Successfully loaded ${candidateData.length} profiles`, 'success');
                
            } catch (error) {
                console.error('File processing error:', error);
                
                fileInfo.classList.remove('hidden');
                fileInfo.classList.remove('bg-green-50', 'border-green-200');
                fileInfo.classList.add('bg-red-50', 'border-red-200');
                fileInfoText.textContent = `Error: ${error.message}`;
                
                showToast(`Failed to process file: ${error.message}`, 'error');
            }
        }

        function parseCSV(csvText) {
            return new Promise((resolve) => {
                Papa.parse(csvText, {
                    header: true,
                    skipEmptyLines: true,
                    transformHeader: transformHeader,
                    complete: function(results) {
                        resolve(results.data);
                    }
                });
            });
        }

        function parseExcel(arrayBuffer) {
            return new Promise((resolve) => {
                try {
                    const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                    const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                    const data = XLSX.utils.sheet_to_json(worksheet, { 
                        defval: '',
                        raw: false 
                    });
                    
                    // Transform headers
                    const transformedData = data.map(row => {
                        const newRow = {};
                        Object.keys(row).forEach(key => {
                            const newKey = transformHeader(key);
                            newRow[newKey] = row[key];
                        });
                        return newRow;
                    });
                    
                    resolve(transformedData);
                } catch (error) {
                    throw new Error('Failed to parse Excel file: ' + error.message);
                }
            });
        }

        function transformHeader(header) {
            const headerMap = {
                'full name': 'name',
                'fullname': 'name',
                'candidate name': 'name',
                'name': 'name',
                'linkedin url': 'linkedinUrl',
                'linkedin': 'linkedinUrl',
                'linkedin profile': 'linkedinUrl',
                'url': 'linkedinUrl',
                'company': 'company',
                'current company': 'company',
                'organization': 'company',
                'title': 'title',
                'job title': 'title',
                'current title': 'title',
                'position': 'title',
                'role': 'title',
                'profile summary': 'summary',
                'summary': 'summary',
                'description': 'summary',
                'bio': 'summary',
                'profile': 'summary',
                'about': 'summary'
            };
            
            const normalized = header.toLowerCase().trim();
            return headerMap[normalized] || header;
        }

        async function processProfiles(profiles) {
            const processedProfiles = [];
            
            for (const profile of profiles) {
                // Skip empty profiles
                if (!profile.name && !profile.company && !profile.summary) {
                    continue;
                }
                
                // If missing key fields, try to extract from summary using AI
                if ((!profile.name || !profile.company || !profile.title) && profile.summary) {
                    try {
                        const enriched = await enrichProfileWithAI(profile.summary);
                        processedProfiles.push({
                            ...profile,
                            ...enriched,
                            summary: profile.summary // Keep original summary
                        });
                    } catch (error) {
                        console.warn('AI enrichment failed for profile:', error);
                        processedProfiles.push(profile);
                    }
                } else {
                    processedProfiles.push(profile);
                }
            }
            
            return processedProfiles;
        }

        async function enrichProfileWithAI(rawSummary) {
            // This would be implemented with actual OpenAI API call
            // For demo purposes, return mock data
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Mock extraction - in real implementation, this would call OpenAI
                    const mockExtraction = {
                        name: extractNameFromSummary(rawSummary),
                        company: extractCompanyFromSummary(rawSummary),
                        title: extractTitleFromSummary(rawSummary),
                        linkedinUrl: '',
                        skills: extractSkillsFromSummary(rawSummary),
                        experienceYears: extractExperienceFromSummary(rawSummary),
                        location: extractLocationFromSummary(rawSummary)
                    };
                    resolve(mockExtraction);
                }, 100);
            });
        }

        // Helper functions for mock extraction
        function extractNameFromSummary(summary) {
            const nameMatch = summary.match(/^([A-Z][a-z]+ [A-Z][a-z]+)/);
            return nameMatch ? nameMatch[1] : 'Unknown';
        }

        function extractCompanyFromSummary(summary) {
            const companyKeywords = ['at ', 'work at ', 'working at ', 'employed by ', 'company '];
            for (const keyword of companyKeywords) {
                const index = summary.toLowerCase().indexOf(keyword);
                if (index !== -1) {
                    const afterKeyword = summary.substring(index + keyword.length);
                    const companyMatch = afterKeyword.match(/^([A-Za-z0-9\s&.-]+)/);
                    if (companyMatch) {
                        return companyMatch[1].trim();
                    }
                }
            }
            return 'Unknown Company';
        }

        function extractTitleFromSummary(summary) {
            const titleKeywords = ['engineer', 'developer', 'manager', 'director', 'lead', 'senior', 'junior', 'analyst'];
            for (const keyword of titleKeywords) {
                if (summary.toLowerCase().includes(keyword)) {
                    const sentences = summary.split(/[.!?]/);
                    for (const sentence of sentences) {
                        if (sentence.toLowerCase().includes(keyword)) {
                            return sentence.trim() || 'Professional';
                        }
                    }
                }
            }
            return 'Professional';
        }

        function extractSkillsFromSummary(summary) {
            const commonSkills = ['javascript', 'python', 'react', 'node.js', 'java', 'sql', 'aws', 'docker'];
            const foundSkills = commonSkills.filter(skill => 
                summary.toLowerCase().includes(skill)
            );
            return foundSkills.join(', ') || 'Various technical skills';
        }

        function extractExperienceFromSummary(summary) {
            const expMatch = summary.match(/(\d+)\+?\s*(year|yr)/i);
            return expMatch ? parseInt(expMatch[1]) : 3;
        }

        function extractLocationFromSummary(summary) {
            const locations = ['tel aviv', 'jerusalem', 'haifa', 'new york', 'london', 'san francisco'];
            for (const location of locations) {
                if (summary.toLowerCase().includes(location)) {
                    return location;
                }
            }
            return 'Global';
        }

        function validateRowRange() {
            const startRow = parseInt(document.getElementById('startRow').value);
            const endRow = parseInt(document.getElementById('endRow').value);
            const totalProfiles = candidateData.length;
            
            const rangeInfo = document.getElementById('rangeInfo');
            
            if (startRow < 2) {
                document.getElementById('startRow').value = 2;
                return;
            }
            
            if (endRow > totalProfiles + 1) {
                document.getElementById('endRow').value = totalProfiles + 1;
                return;
            }
            
            if (startRow >= endRow) {
                rangeInfo.textContent = 'Invalid range: Start row must be less than end row';
                rangeInfo.className = 'text-sm text-red-600 mt-2';
                return;
            }
            
            const profileCount = endRow - startRow;
            rangeInfo.textContent = `Will analyze ${profileCount} profiles (rows ${startRow}-${endRow - 1})`;
            rangeInfo.className = 'text-sm text-gray-600 mt-2';
        }

        // Analysis functionality
        async function startAnalysis() {
            if (candidateData.length === 0) {
                showToast('Please upload a candidate file first', 'error');
                return;
            }

            const selectedModel = document.querySelector('input[name="aiModel"]:checked').value;
            const startRow = parseInt(document.getElementById('startRow').value);
            const endRow = parseInt(document.getElementById('endRow').value);
            
            // Slice candidates for analysis (adjust for 0-based indexing)
            const profilesToAnalyze = candidateData.slice(startRow - 1, endRow - 1);
            
            if (profilesToAnalyze.length === 0) {
                showToast('No profiles in selected range', 'error');
                return;
            }

            // Initialize analysis
            isCancelled = false;
            performanceMetrics = {
                embeddingTime: 0,
                gptTime: 0,
                totalTime: 0,
                processedCount: 0,
                errorCount: 0,
                retryCount: 0
            };

            // Show progress UI
            document.getElementById('analysisProgress').classList.remove('hidden');
            document.getElementById('resultsSection').style.display = 'none';
            
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDjgm7xx5k3NGo7U0sNV6B%2FrelItEYsYTWRzwVbfPHD6gJNk8MI9sJmDaKiEqfYkNpGxl7OLZLA5XleymDepSBpQ4%2BhfHF651KTGaewgDR2CAb60OsNOK%2Fkxlxrx2wd0rvrrnUPpfLAisTxA7Yk39fuJ%2B77Qlrn0fygonYnf08hbC1F9I6cGbij9A3aN%2BXOC9V%2F%2BF75Y1%2B1i3dY67UA3orrqjZYthF6oNuOk4UcK%2F%2Bm8BGaHesULSDYSRuPqgZ8OxxpKeM8VZK2BY3F3dRfhcEYSgE8P%2BUssOQQjOKkNO%2B5QtI29VXbg1M8e6xOpp1e%2BLWnXVLGdGY6M4wTjOF3sEonDk%2BZgdzjag2peejzLorhwW73rNmWAEbe4H3tuJfmUZsWLWVY%2Bwox%2BnFFYvFRFKrtViX46hx%2BO7qfoLRxsviXel1l6Ye44Ysac2sJrOY%2F9qgWkXb0wIrvm2xD%2BnPAKKxTv03XbUKXDA04jeg%2BkXN2GIydwwmK3hZ04HAfC7oJLThw%3D%3D";
        window.__genspark_locale = "en-US";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDjgm7xx5k3NGo7U0sNV6B/relItEYsYTWRzwVbfPHD6gJNk8MI9sJmDaKiEqfYkNpGxl7OLZLA5XleymDepSBpQ4+hfHF651KTGaewgDR2CAb60OsNOK/kxlxrx2wd0rvrrnUPpfLAisTxA7Yk39fuJ+77Qlrn0fygonYnf08hbC1F9I6cGbij9A3aN+XOC9V/+F75Y1+1i3dY67UA3orrqjZYthF6oNuOk4UcK/+m8BGaHesULSDYSRuPqgZ8OxxpKeM8VZK2BY3F3dRfhcEYSgE8P+UssOQQjOKkNO+5QtI29VXbg1M8e6xOpp1e+LWnXVLGdGY6M4wTjOF3sEonDk+Zgdzjag2peejzLorhwW73rNmWAEbe4H3tuJfmUZsWLWVY+wox+nFFYvFRFKrtViX46hx+O7qfoLRxsviXel1l6Ye44Ysac2sJrOY/9qgWkXb0wIrvm2xD+nPAKKxTv03XbUKXDA04jeg+kXN2GIydwwmK3hZ04HAfC7oJLThw==";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    
