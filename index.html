
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Scorely Beta - LinkedIn Profile Ranker</title>
 <style>
 :root {
 --primary-color: #2563eb;
 --secondary-color: #f8fafc;
 --success-color: #10b981;
 --warning-color: #f59e0b;
 --error-color: #ef4444;
 --text-primary: #1f2937;
 --text-secondary: #6b7280;
 --border-color: #e5e7eb;
 --white: #ffffff;
 --gray-50: #f9fafb;
 --gray-100: #f3f4f6;
 --gray-200: #e5e7eb;
 --gray-300: #d1d5db;
 --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
 --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
 --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
 }

 * {
 margin: 0;
 padding: 0;
 box-sizing: border-box;
 }

 body {
 font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
 background: var(--white);
 color: var(--text-primary);
 line-height: 1.6;
 }

 .container {
 max-width: 1400px;
 margin: 0 auto;
 min-height: 100vh;
 background: var(--white);
 }

 /* Toast Notifications */
 .toast {
 position: fixed;
 top: 20px;
 right: 20px;
 background: var(--success-color);
 color: white;
 padding: 12px 24px;
 border-radius: 8px;
 box-shadow: var(--shadow-lg);
 z-index: 9999;
 opacity: 0;
 transform: translateX(100%);
 transition: all 0.3s ease;
 max-width: 400px;
 font-size: 0.875rem;
 font-weight: 500;
 }

 .toast.show {
 opacity: 1;
 transform: translateX(0);
 }

 .toast.error {
 background: var(--error-color);
 }

 .toast.warning {
 background: var(--warning-color);
 }

 .toast.info {
 background: var(--primary-color);
 }

 /* Save Indicator */
 .save-indicator {
 position: fixed;
 bottom: 20px;
 right: 20px;
 background: var(--primary-color);
 color: white;
 padding: 8px 16px;
 border-radius: 20px;
 font-size: 0.8rem;
 opacity: 0;
 transition: opacity 0.3s;
 z-index: 1000;
 }

 .save-indicator.saving {
 opacity: 1;
 }

 /* Export List Indicator */
 .export-list-indicator {
 position: fixed;
 top: 80px;
 right: 20px;
 background: var(--warning-color);
 color: white;
 padding: 8px 16px;
 border-radius: 8px;
 font-size: 0.9rem;
 z-index: 100;
 display: none;
 }

 .export-list-indicator.show {
 display: block;
 }

 /* Filtering Dashboard */
 .filtering-dashboard {
 background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
 color: white;
 padding: 2rem;
 border-radius: 16px;
 margin-bottom: 2rem;
 display: none;
 }

 .filtering-dashboard.show {
 display: block;
 }

 .filter-stats {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
 gap: 1rem;
 margin-top: 1rem;
 }

 .filter-stat {
 background: rgba(255, 255, 255, 0.15);
 padding: 1.5rem;
 border-radius: 12px;
 text-align: center;
 }

 .filter-stat .number {
 font-size: 2rem;
 font-weight: 700;
 margin-bottom: 0.5rem;
 }

 .filter-stat .label {
 font-size: 0.875rem;
 opacity: 0.9;
 }

 /* Navigation */
 .navbar {
 background: white;
 border-bottom: 2px solid var(--border-color);
 padding: 1.5rem 2rem;
 position: sticky;
 top: 0;
 z-index: 1000;
 box-shadow: var(--shadow-md);
 }

 .nav-brand h1 {
 color: var(--primary-color);
 font-size: 2.5rem;
 font-weight: 800;
 margin-bottom: 0.25rem;
 }

 .nav-brand p {
 color: var(--text-secondary);
 font-size: 1rem;
 font-weight: 500;
 }

 .nav-tabs {
 display: flex;
 gap: 0.75rem;
 align-items: center;
 margin-top: 1rem;
 }

 .tab-btn {
 padding: 0.875rem 1.75rem;
 border: 2px solid var(--border-color);
 background: var(--white);
 color: var(--text-secondary);
 cursor: pointer;
 border-radius: 12px;
 font-size: 0.875rem;
 font-weight: 600;
 transition: all 0.2s ease;
 display: flex;
 align-items: center;
 gap: 0.5rem;
 }

 .tab-btn:hover {
 border-color: var(--primary-color);
 color: var(--primary-color);
 }

 .tab-btn.active {
 background: var(--primary-color);
 color: white;
 border-color: var(--primary-color);
 }

 .reset-btn {
 margin-left: auto;
 background: var(--error-color) !important;
 color: white !important;
 border-color: var(--error-color) !important;
 }

 /* Tab Content */
 .tab-content {
 display: none;
 padding: 2rem;
 max-width: 1000px;
 margin: 0 auto;
 }

 .tab-content.active {
 display: block;
 }

 /* Sections */
 .section {
 background: white;
 border: 1px solid var(--border-color);
 border-radius: 16px;
 padding: 2rem;
 margin-bottom: 2rem;
 box-shadow: var(--shadow-md);
 }

 .section h2 {
 color: var(--text-primary);
 font-size: 1.375rem;
 font-weight: 700;
 margin-bottom: 1.5rem;
 display: flex;
 align-items: center;
 gap: 0.75rem;
 }

 .section h3 {
 color: var(--text-primary);
 font-size: 1.125rem;
 font-weight: 600;
 margin-bottom: 1rem;
 }

 /* Form Elements */
 input[type="text"], 
 input[type="email"], 
 input[type="password"],
 input[type="number"],
 textarea, 
 select {
 width: 100%;
 padding: 0.875rem 1rem;
 border: 1px solid var(--border-color);
 border-radius: 8px;
 font-size: 0.875rem;
 background: white;
 transition: all 0.2s ease;
 }

 input:focus, 
 textarea:focus, 
 select:focus {
 outline: none;
 border-color: var(--primary-color);
 box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
 }

 textarea {
 min-height: 100px;
 resize: vertical;
 }

 label {
 display: block;
 margin-bottom: 0.5rem;
 color: var(--text-primary);
 font-weight: 600;
 font-size: 0.875rem;
 }

 small {
 color: var(--text-secondary);
 font-size: 0.8rem;
 margin-top: 0.25rem;
 display: block;
 }

 /* Upload Area */
 .upload-area {
 border: 2px dashed var(--border-color);
 border-radius: 8px;
 padding: 2rem;
 text-align: center;
 background: var(--gray-50);
 cursor: pointer;
 transition: all 0.2s ease;
 }

 .upload-area:hover {
 border-color: var(--primary-color);
 background: var(--gray-100);
 }

 .upload-icon {
 font-size: 2rem;
 margin-bottom: 0.5rem;
 }

 /* Buttons */
 .btn-primary, .btn-secondary {
 padding: 0.875rem 1.75rem;
 border: none;
 border-radius: 10px;
 font-size: 0.875rem;
 font-weight: 600;
 cursor: pointer;
 transition: all 0.2s ease;
 display: inline-flex;
 align-items: center;
 gap: 0.5rem;
 text-decoration: none;
 }

 .btn-primary {
 background: var(--primary-color);
 color: white;
 box-shadow: var(--shadow-md);
 }

 .btn-primary:hover {
 background: #1d4ed8;
 transform: translateY(-1px);
 }

 .btn-secondary {
 background: var(--gray-100);
 color: var(--text-primary);
 border: 1px solid var(--border-color);
 }

 .btn-secondary:hover {
 background: var(--gray-200);
 }

 .btn-add-export {
 background: var(--warning-color);
 color: white;
 border: none;
 padding: 0.5rem 1rem;
 border-radius: 6px;
 font-size: 0.75rem;
 cursor: pointer;
 transition: all 0.2s ease;
 }

 .btn-view-details {
 background: var(--primary-color);
 color: white;
 border: none;
 padding: 0.5rem 1rem;
 border-radius: 6px;
 font-size: 0.75rem;
 cursor: pointer;
 transition: all 0.2s ease;
 }

 /* Results Table */
 .results-table {
 width: 100%;
 border-collapse: collapse;
 background: white;
 border-radius: 8px;
 overflow: hidden;
 box-shadow: var(--shadow-sm);
 margin-bottom: 2rem;
 }

 .results-table th,
 .results-table td {
 padding: 12px;
 text-align: left;
 border-bottom: 1px solid var(--border-color);
 }

 .results-table th {
 background: var(--gray-50);
 font-weight: 600;
 color: var(--text-primary);
 position: sticky;
 top: 0;
 z-index: 10;
 }

 .results-table tr:hover {
 background: var(--gray-50);
 }

 .score-badge {
 padding: 4px 8px;
 border-radius: 12px;
 font-size: 0.8rem;
 font-weight: 600;
 text-align: center;
 min-width: 60px;
 display: inline-block;
 }

 .score-high { background: #dcfdf7; color: #065f46; }
 .score-medium { background: #dbeafe; color: #1e40af; }
 .score-low { background: #fef3c7; color: #92400e; }

 /* Modal */
 .modal {
 display: none;
 position: fixed;
 z-index: 1000;
 left: 0;
 top: 0;
 width: 100%;
 height: 100%;
 background-color: rgba(0,0,0,0.5);
 }

 .modal-content {
 background-color: white;
 margin: 5% auto;
 padding: 0;
 border-radius: 12px;
 width: 90%;
 max-width: 800px;
 max-height: 80vh;
 overflow-y: auto;
 }

 .modal-header {
 padding: 1.5rem;
 border-bottom: 1px solid var(--border-color);
 display: flex;
 justify-content: space-between;
 align-items: center;
 }

 .modal-body {
 padding: 1.5rem;
 }

 .close {
 color: var(--text-secondary);
 font-size: 28px;
 font-weight: bold;
 cursor: pointer;
 }

 .close:hover {
 color: var(--text-primary);
 }

 /* Checkbox Grid */
 .checkbox-grid {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
 gap: 0.75rem;
 }

 .checkbox-grid label {
 display: flex;
 align-items: center;
 gap: 0.5rem;
 cursor: pointer;
 padding: 0.5rem;
 border-radius: 6px;
 transition: background-color 0.2s;
 }

 .checkbox-grid label:hover {
 background: var(--gray-50);
 }

 /* Ideal Profiles */
 .ideal-profiles {
 display: grid;
 gap: 1.5rem;
 }

 .profile-input {
 border: 1px solid var(--border-color);
 border-radius: 8px;
 padding: 1rem;
 background: var(--gray-50);
 }

 .input-options {
 display: flex;
 gap: 1rem;
 margin-bottom: 1rem;
 }

 .input-options label {
 display: flex;
 align-items: center;
 gap: 0.5rem;
 cursor: pointer;
 font-weight: 400;
 }

 /* Model Selection */
 .model-selection {
 display: grid;
 gap: 0.75rem;
 }

 .model-selection label {
 display: flex;
 align-items: center;
 gap: 0.75rem;
 padding: 1rem;
 border: 1px solid var(--border-color);
 border-radius: 8px;
 cursor: pointer;
 transition: all 0.2s;
 background: white;
 }

 .model-selection label:hover {
 border-color: var(--primary-color);
 background: var(--gray-50);
 }

 /* Progress Bar */
 .progress-bar {
 width: 100%;
 height: 12px;
 background: var(--gray-200);
 border-radius: 6px;
 overflow: hidden;
 margin: 1rem 0;
 }

 .progress-fill {
 height: 100%;
 background: linear-gradient(90deg, var(--primary-color), var(--success-color));
 transition: width 0.3s ease;
 border-radius: 6px;
 }

 /* Summary Cards */
 .results-summary {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
 gap: 1rem;
 margin-bottom: 2rem;
 }

 .summary-card {
 background: white;
 border: 1px solid var(--border-color);
 border-radius: 8px;
 padding: 1.5rem;
 text-align: center;
 box-shadow: var(--shadow-sm);
 }

 .summary-card h3 {
 color: var(--text-secondary);
 font-size: 0.9rem;
 font-weight: 500;
 margin-bottom: 0.5rem;
 }

 .summary-number {
 font-size: 2rem;
 font-weight: 700;
 color: var(--primary-color);
 margin-bottom: 0.25rem;
 }

 .summary-card p {
 color: var(--text-secondary);
 font-size: 0.85rem;
 }

 /* AI Insights */
 .ai-insights-panel {
 background: white;
 border: 1px solid var(--border-color);
 border-radius: 12px;
 padding: 2rem;
 margin: 2rem 0;
 }

 .insights-grid {
 display: grid;
 gap: 1.5rem;
 }

 .insight-section {
 border-bottom: 1px solid var(--border-color);
 padding-bottom: 1.5rem;
 }

 .insight-section:last-child {
 border-bottom: none;
 padding-bottom: 0;
 }

 .insight-list {
 list-style: none;
 display: grid;
 gap: 0.5rem;
 }

 .insight-list li {
 padding: 0.75rem;
 background: var(--gray-50);
 border-radius: 6px;
 font-size: 0.9rem;
 color: var(--text-primary);
 }

 /* Responsive Design */
 @media (max-width: 768px) {
 .container {
 padding: 0;
 }

 .navbar {
 padding: 1rem;
 }

 .nav-tabs {
 flex-wrap: wrap;
 }

 .tab-content {
 padding: 1rem;
 }

 .filter-stats {
 grid-template-columns: 1fr;
 }

 .checkbox-grid {
 grid-template-columns: 1fr;
 }

 .results-summary {
 grid-template-columns: 1fr;
 }

 .results-table {
 font-size: 0.8rem;
 }

 .results-table th,
 .results-table td {
 padding: 8px;
 }
 }

 /* Animations */
 .fade-in {
 animation: fadeIn 0.5s ease-in;
 }

 @keyframes fadeIn {
 from { opacity: 0; transform: translateY(20px); }
 to { opacity: 1; transform: translateY(0); }
 }

 .pulse {
 animation: pulse 2s infinite;
 }

 @keyframes pulse {
 0%, 100% { opacity: 1; }
 50% { opacity: 0.7; }
 }
 </style>
</head>
<body>
 <!-- Toast Notification -->
 <div id="toast" class="toast"></div>
 
 <!-- Save Indicator -->
 <div id="saveIndicator" class="save-indicator">¾ Saving...</div>
 
 <!-- Export List Indicator -->
 <div id="exportListIndicator" class="export-list-indicator">
 Export List: <span id="exportCount">0</span> items
 </div>

 <div class="container">
 <!-- Navigation -->
 <nav class="navbar">
 <div class="nav-brand">
 <h1>🎯 Scorely Beta</h1>
 <p>LinkedIn Profile Ranker</p>
 </div>
 <div class="nav-tabs">
 <button class="tab-btn active" data-tab="setup"> Setup</button>
 <button class="tab-btn" data-tab="ranking">⚡ Ranking</button>
 <button class="tab-btn" data-tab="results">📊 Results</button>
 <button class="tab-btn reset-btn" onclick="resetSession()">🔄 Reset</button>
 </div>
 </nav>

 <!-- Setup Tab -->
 <div id="setup" class="tab-content active">
 <!-- API Configuration -->
 <div class="section">
 <h2>🔑 API Configuration</h2>
 <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
 <div>
 <label for="embeddingApiKey">Embedding API Key:</label>
 <input type="password" id="embeddingApiKey" placeholder="Optional - uses OpenAI if empty">
 <small>Leave empty to use OpenAI for both</small>
 </div>
 <div>
 <label for="gptApiKey">GPT API Key:</label>
 <input type="password" id="gptApiKey" placeholder="sk-...">
 <small>Required for AI-powered ranking</small>
 </div>
 </div>
 </div>

 <!-- File Upload -->
 <div class="section">
 <h2>📁 File Upload</h2>
 <div class="upload-area" onclick="document.getElementById('csvFile').click()">
 <input type="file" id="csvFile" accept=".csv" style="display: none;">
 <div class="upload-icon">📄</div>
 <p style="color: var(--text-primary); font-weight: 500; margin: 0.5rem 0;">Click to upload CSV file</p>
 <small style="color: var(--text-secondary);">LinkedIn profiles data</small>
 </div>
 <div id="fileInfo" style="margin-top: 1rem; display: none;">
 <p><strong>File:</strong> <span id="fileName"></span></p>
 <p><strong>Size:</strong> <span id="fileSize"></span></p>
 <p><strong>Total Rows:</strong> <span id="fileRows"></span> (starting from row 2)</p>
 </div>
 </div>

 <!-- Filtering Dashboard -->
 <div id="filteringDashboard" class="filtering-dashboard">
 <h3>📊 Data Filtering Summary</h3>
 <p>Results after applying blacklist and already-in-process filters:</p>
 <div class="filter-stats">
 <div class="filter-stat total">
 <div class="number" id="totalRowsCount">0</div>
 <div class="label">Total Profiles</div>
 </div>
 <div class="filter-stat blacklist">
 <div class="number" id="blacklistFilteredCount">0</div>
 <div class="label">Filtered (Blacklist)</div>
 </div>
 <div class="filter-stat in-process">
 <div class="number" id="inProcessFilteredCount">0</div>
 <div class="label">Filtered (Already in Process)</div>
 </div>
 <div class="filter-stat remaining">
 <div class="number" id="remainingForRankingCount">0</div>
 <div class="label">Ready for Ranking</div>
 </div>
 </div>
 </div>

 <!-- Blacklist & Already in Process -->
 <div class="section">
 <h2> Blacklist & Already in Process</h2>
 <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
 <div>
 <label>Blacklist Companies:</label>
 <textarea id="blacklistCompanies" placeholder="Company1, Company2, Company3..." rows="3"></textarea>
 <small>Comma-separated company names to exclude</small>
 </div>
 <div>
 <label>Already in Process:</label>
 <textarea id="inProcessCandidates" placeholder="Profile names or IDs..." rows="3"></textarea>
 <small>Candidates currently being processed</small>
 </div>
 </div>
 <button onclick="applyFiltering()" style="margin-top: 1rem;" class="btn-primary">
 🔍 Apply Filters & Show Summary
 </button>
 </div>

 <!-- Ideal Candidate Profiles -->
 <div class="section">
 <h2> Ideal Candidate Profiles</h2>
 <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
 💡 Help our AI understand your ideal candidates by providing examples
 </p>
 <div class="ideal-profiles">
 <div class="profile-input">
 <h3>Ideal Profile #1:</h3>
 <div class="input-options">
 <label>
 <input type="radio" name="profile1" value="pdf" id="p1-pdf">
 📄 Upload PDF
 </label>
 <label>
 <input type="radio" name="profile1" value="text" id="p1-text" checked>
 📝 Copy & Paste Profile
 </label>
 </div>
 <input type="file" id="profile1File" accept=".pdf" style="display: none;">
 <textarea id="profile1Text" placeholder="Paste LinkedIn profile (Ctrl+A from LinkedIn)..." rows="4"></textarea>
 <small>💡 Tip: This profile will be used as a benchmark for technical excellence</small>
 </div>
 
 <div class="profile-input">
 <h3>Ideal Profile #2:</h3>
 <div class="input-options">
 <label>
 <input type="radio" name="profile2" value="pdf" id="p2-pdf">
 📄 Upload PDF
 </label>
 <label>
 <input type="radio" name="profile2" value="text" id="p2-text" checked>
 📝 Copy & Paste Profile
 </label>
 </div>
 <input type="file" id="profile2File" accept=".pdf" style="display: none;">
 <textarea id="profile2Text" placeholder="Paste LinkedIn profile (Ctrl+A from LinkedIn)..." rows="4"></textarea>
 <small>💡 Tip: This profile will be used as a benchmark for cultural fit</small>
 </div>
 </div>
 </div>

 <!-- Job Description -->
 <div class="section">
 <h2>💼 Job Description</h2>
 <textarea id="jobDesc" placeholder="Describe the position, required skills, ideal candidate profile, company culture, and any specific requirements..." rows="6"></textarea>
 <small>Be as detailed as possible - this helps the AI understand what you're looking for</small>
 </div>

 <!-- Excellence Indicators -->
 <div class="section">
 <h2>🏆 Excellence Indicators</h2>
 <p style="color: var(--text-secondary); margin-bottom: 1rem;">
 💡 Tip: Our AI will look for keywords indicating these excellence factors in profiles.
 </p>
 <div class="checkbox-grid">
 <label>
 <input type="checkbox" id="academic-excellence">
 🎓 Graduated with honors/distinction
 </label>
 <label>
 <input type="checkbox" id="industry-awards">
  Industry awards/recognition
 </label>
 <label>
 <input type="checkbox" id="military-elite">
 ðª Elite military unit experience
 </label>
 <label>
 <input type="checkbox" id="high-impact">
 🚀 High-impact projects
 </label>
 <label>
 <input type="checkbox" id="rapid-advancement">
 📈 Rapid career advancement
 </label>
 <label>
 <input type="checkbox" id="publications">
 📚 Publications/Patents
 </label>
 </div>
 </div>

 <!-- Additional Filters -->
 <div class="section">
 <h2>🎯 Additional Filters</h2>
 <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
 <div>
 <label>Education Level:</label>
 <select id="educationLevel">
 <option value="">Any Education Level</option>
 <option value="high-school">High School</option>
 <option value="associate">Associate Degree</option>
 <option value="bachelor">Bachelor's Degree</option>
 <option value="master">Master's Degree</option>
 <option value="phd">PhD/Doctorate</option>
 </select>
 </div>
 <div>
 <label>Location:</label>
 <input type="text" id="location" placeholder="e.g. Tel Aviv, Remote, etc.">
 </div>
 </div>
 </div>

 <!-- Leadership Experience -->
 <div class="section">
 <h2>👥 Leadership Experience</h2>
 <div class="checkbox-grid">
 <label>
 <input type="checkbox" id="team-lead">
 👥 Team Lead
 </label>
 <label>
 <input type="checkbox" id="manager">
 Manager
 </label>
 <label>
 <input type="checkbox" id="executive">
 🎯 Executive (VP/C-level)
 </label>
 </div>
 </div>

 <!-- Key Achievements -->
 <div class="section">
 <h2>🔑 Key Achievements (Keywords)</h2>
 <textarea id="keyAchievements" placeholder="e.g. scaled, launched, improved, reduced costs by 40%, increased revenue, led architecture redesign, implemented CI/CD, grew team by 200%..." rows="3"></textarea>
 <small>📝 Examples: grew team by 200%, increased revenue, reduced costs by 40%, launched product</small>
 <br><br>
 <label>Additional Keywords:</label>
 <textarea id="additionalKeywords" placeholder="Any other important keywords..." rows="2"></textarea>
 </div>

 <!-- AI Ranking Enhancement -->
 <div class="section">
 <h2> AI Ranking Enhancement</h2>
 <p style="color: var(--text-secondary); margin-bottom: 1rem;">
   AI Understanding: Our model will analyze profiles for indicators of excellence.
 </p>
 <label>Provide specific instructions to improve the AI's ranking accuracy:</label>
 <textarea id="aiInstructions" placeholder='Example: "Prioritize candidates who have worked with large-scale systems"' rows="4"></textarea>
 
 <div style="margin-top: 1rem;">
 <label>Focus Areas:</label>
 <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 0.5rem;">
 <div style="display: flex; gap: 1rem;">
 <label style="display: flex; align-items: center; gap: 0.5rem;">
 <input type="radio" name="focus" value="innovation">
 💡 Innovation focus
 </label>
 <label style="display: flex; align-items: center; gap: 0.5rem;">
 <input type="radio" name="focus" value="initiative">
 🎯 Initiative focus
 </label>
 </div>
 <div style="display: flex; gap: 1rem;">
 <label style="display: flex; align-items: center; gap: 0.5rem;">
 <input type="radio" name="focus" value="top-company">
 🏢 Top company focus
 </label>
 <label style="display: flex; align-items: center; gap: 0.5rem;">
 <input type="radio" name="focus" value="career-growth">
 📈 Career growth focus
 </label>
 </div>
 </div>
 </div>
 </div>

 <!-- Model Configuration -->
 <div class="section">
 <h2> AI Model Configuration</h2>
 <div class="model-selection">
 <label>
 <input type="radio" name="model" value="hybrid" checked>
 <div>
 🎯 Hybrid (Recommended) - 30% Embedding + 70% GPT-4
 <br><small style="color: var(--text-secondary);">Best balance of speed and accuracy</small>
 </div>
 </label>
 <label>
 <input type="radio" name="model" value="embedding">
 <div>
 ⚡ Embedding Only - Fast and cost-effective
 <br><small style="color: var(--text-secondary);">Good for initial screening</small>
 </div>
 </label>
 <label>
 <input type="radio" name="model" value="gpt4">
 <div>
   GPT-4 Only - Highest quality analysis
 <br><small style="color: var(--text-secondary);">Most thorough but slower</small>
 </div>
 </label>
 </div>
 </div>

 <!-- Start Button -->
 <div class="section" style="text-align: center;">
 <button class="btn-primary" onclick="startRanking()" style="font-size: 1rem; padding: 1rem 2rem;">
 🚀 Start Ranking Process
 </button>
 </div>
 </div>

 <!-- Ranking Tab -->
 <div id="ranking" class="tab-content">
 <div style="text-align: center; max-width: 600px; margin: 0 auto;">
 <h2>⚡ AI Ranking in Progress</h2>
 
 <!-- Previous Rankings Impact -->
 <div id="feedbackImpactSection" class="section" style="display: none;">
 <h3>🔄 Feedback Impact on Previous Rankings</h3>
 <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;">
 <div style="background: var(--gray-50); padding: 1rem; border-radius: 6px;">
 <strong>Before Feedback:</strong><br>
 <span id="beforeStats">23 TOP, 19 GOOD candidates</span>
 </div>
 <div style="background: var(--success-color); color: white; padding: 1rem; border-radius: 6px;">
 <strong>After Feedback:</strong><br>
 <span id="afterStats">31 TOP, 24 GOOD candidates</span>
 </div>
 </div>
 <p style="color: var(--success-color); font-weight: 500;">✅ Feedback successfully applied to previous rankings!</p>
 </div>

 <!-- Batch Configuration -->
 <div class="section">
 <h3>📊 Batch Configuration</h3>
 <div style="background: white; border: 1px solid var(--border-color); border-radius: 12px; padding: 2rem;">
 <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin: 1rem 0;">
 <div>
 <label>From Row:</label>
 <input type="number" id="fromRow" value="2" min="2">
 </div>
 <div>
 <label>To Row:</label>
 <input type="number" id="toRow" value="51" min="2">
 </div>
 <div>
 <label>Batch Size:</label>
 <select id="batchSize">
 <option value="20">20 profiles</option>
 <option value="50" selected>50 profiles</option>
 <option value="100">100 profiles</option>
 </select>
 </div>
 </div>
 
 <div class="progress-bar">
 <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
 </div>
 <p>Progress: <span id="progressText">0%</span></p>
 </div>
 </div>

 <!-- Controls -->
 <div style="display: flex; gap: 1rem; justify-content: center; margin: 2rem 0;">
 <button class="btn-secondary" onclick="pauseRanking()">â¸ï¸ Pause</button>
 <button class="btn-primary" onclick="continueRanking()">▶ Continue</button>
 <button class="btn-secondary" onclick="stopRanking()">â¹ï¸ Stop</button>
 </div>

 <!-- Feedback Section -->
 <div class="section">
 <h3>📝 Provide Feedback</h3>
 <p style="color: var(--text-secondary); margin-bottom: 1rem;">
 Your feedback will improve future batches and can be applied to previous rankings.
 </p>
 <textarea id="feedbackText" placeholder="Example: 'Give more weight to startup experience over enterprise experience.'" rows="4"></textarea>
 
 <div style="margin: 1rem 0;">
 <label style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem;">
 <input type="checkbox" id="applyToPrevious"> Apply to previous rankings
 </label>
 </div>
 
 <button onclick="applyFeedback()" class="btn-primary">
 💡 Apply Feedback
 </button>
 </div>
 </div>
 </div>

 <!-- Results Tab -->
 <div id="results" class="tab-content">
 <!-- Results Header -->
 <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;">
 <h2>📊 Ranking Results</h2>
 <div style="display: flex; gap: 1rem;">
 <button class="btn-primary" onclick="exportCandidates()"> Export CSV (Score â¥60)</button>
 <button class="btn-secondary" onclick="exportInsights()">📄 Export AI Insights</button>
 <button class="btn-secondary" onclick="exportCustomList()" id="exportCustomBtn" style="display: none;"> Export Custom List (<span id="customExportCount">0</span>)</button>
 </div>
 </div>

 <!-- Summary Cards -->
 <div class="results-summary">
 <div class="summary-card">
 <h3>🏆 TOP Candidates</h3>
 <div class="summary-number">23</div>
 <p>75-100 score</p>
 </div>
 <div class="summary-card">
 <h3>✅ GOOD Candidates</h3>
 <div class="summary-number">19</div>
 <p>60-74 score</p>
 </div>
 <div class="summary-card">
 <h3>💎 Hidden Gems</h3>
 <div class="summary-number">3</div>
 <p>Special cases</p>
 </div>
 <div class="summary-card">
 <h3> Average</h3>
 <div class="summary-number">45</div>
 <p>Below 60 score</p>
 </div>
 </div>

 <!-- TOP Candidates Table -->
 <div class="section">
 <h2>🏆 TOP Candidates (75-100)</h2>
 <table class="results-table">
 <thead>
 <tr>
 <th>Name</th>
 <th>Company</th>
 <th>Position</th>
 <th>Overall Score</th>
 <th>Embedding Score</th>
 <th>Category</th>
 <th>Actions</th>
 </tr>
 </thead>
 <tbody>
 <tr>
 <td><strong>Alex Semyzhonov</strong></td>
 <td>Inetex LTD</td>
 <td>Full Stack Developer</td>
 <td><span class="score-badge score-high">87/100</span></td>
 <td><span class="score-badge score-high">89/100</span></td>
 <td><span style="background: #dcfdf7; color: #065f46; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">🏆 TOP</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('alex-semyzhonov')">👁ï¸ View Details</button>
 <a href="https://linkedin.com/in/alex-semyzhonov" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Dror Reshef</strong></td>
 <td>SuperCom</td>
 <td>Full-stack Developer</td>
 <td><span class="score-badge score-high">82/100</span></td>
 <td><span class="score-badge score-high">85/100</span></td>
 <td><span style="background: #dcfdf7; color: #065f46; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">🏆 TOP</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('dror-reshef')">👁ï¸ View Details</button>
 <a href="https://linkedin.com/in/dror-reshef-1a9533a" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Tomer Landesman</strong></td>
 <td>env0</td>
 <td>Fullstack Software Engineer</td>
 <td><span class="score-badge score-high">79/100</span></td>
 <td><span class="score-badge score-high">83/100</span></td>
 <td><span style="background: #dcfdf7; color: #065f46; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">🏆 TOP</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('tomer-landesman')">👁ï¸ View Details</button>
 <a href="https://linkedin.com/in/tomerlm" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 </tbody>
 </table>
 </div>

 <!-- GOOD Candidates Table -->
 <div class="section">
 <h2>✅ GOOD Candidates (60-74)</h2>
 <table class="results-table">
 <thead>
 <tr>
 <th>Name</th>
 <th>Company</th>
 <th>Position</th>
 <th>Overall Score</th>
 <th>Embedding Score</th>
 <th>Category</th>
 <th>Actions</th>
 </tr>
 </thead>
 <tbody>
 <tr>
 <td><strong>Aviram Shubeili</strong></td>
 <td>Philips</td>
 <td>Software Engineer</td>
 <td><span class="score-badge score-medium">71/100</span></td>
 <td><span class="score-badge score-medium">74/100</span></td>
 <td><span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">✅ GOOD</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('aviram-shubeili')">👁ï¸ View Details</button>
 <a href="https://linkedin.com/in/aviram-shubeili" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Leon Kannanovich</strong></td>
 <td>Sapiens Decision</td>
 <td>Full Stack Developer</td>
 <td><span class="score-badge score-medium">68/100</span></td>
 <td><span class="score-badge score-medium">70/100</span></td>
 <td><span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">✅ GOOD</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('leon-kannanovich')">👁ï¸ View Details</button>
 <a href="https://linkedin.com/in/leon-kannanovich-414a64120" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 </tbody>
 </table>
 </div>

 <!-- Hidden Gems Table -->
 <div class="section">
 <h2>💎 Hidden Gems</h2>
 <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
 Candidates with overall lower scores but exceptional qualities in specific areas.
 </p>
 <table class="results-table">
 <thead>
 <tr>
 <th>Name</th>
 <th>Company</th>
 <th>Position</th>
 <th>Overall Score</th>
 <th>Embedding Score</th>
 <th>Best Quality</th>
 <th>Actions</th>
 </tr>
 </thead>
 <tbody>
 <tr>
 <td><strong>Israel Zanani</strong></td>
 <td>Harel Insurance</td>
 <td>Full Stack Engineer</td>
 <td><span class="score-badge score-low">58/100</span></td>
 <td><span class="score-badge score-medium">65/100</span></td>
 <td><span style="background: #dcfdf7; color: #065f46; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem;">Technical: 82/100</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('israel-zanani')">👁ï¸ View Details</button>
 <button class="btn-add-export" onclick="addToExportList('israel-zanani')"> Add to Export</button>
 <a href="https://linkedin.com/in/israel-zanani-b7aa1a134" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Michal Dan</strong></td>
 <td>Bringg</td>
 <td>Senior Frontend Developer</td>
 <td><span class="score-badge score-low">55/100</span></td>
 <td><span class="score-badge score-medium">62/100</span></td>
 <td><span style="background: #dcfdf7; color: #065f46; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem;">Technical: 88/100</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('michal-dan')">👁ï¸ View Details</button>
 <button class="btn-add-export" onclick="addToExportList('michal-dan')"> Add to Export</button>
 <a href="https://linkedin.com/in/michal-dan-639983a7" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 </tbody>
 </table>
 </div>

 <!-- Insufficient Data Table -->
 <div class="section">
 <h2>â Profiles with Insufficient Data</h2>
 <p style="color: var(--text-secondary); margin-bottom: 1rem;">
 Profiles that couldn't be properly ranked due to missing information.
 </p>
 <table class="results-table">
 <thead>
 <tr>
 <th>Name</th>
 <th>Company</th>
 <th>Position</th>
 <th>Reason</th>
 <th>Actions</th>
 </tr>
 </thead>
 <tbody>
 <tr>
 <td><strong>Stav A.</strong></td>
 <td>ControlUp</td>
 <td>Full Stack Developer</td>
 <td><small>Limited job description and skills information</small></td>
 <td>
 <button class="btn-add-export" onclick="addToExportList('stav-a')"> Add to Export</button>
 <a href="https://linkedin.com/in/stavab" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Vakho Baratashvili</strong></td>
 <td>VFR</td>
 <td>Senior Software Engineer</td>
 <td><small>Incomplete education and experience data</small></td>
 <td>
 <button class="btn-add-export" onclick="addToExportList('vakho-baratashvili')"> Add to Export</button>
 <a href="https://linkedin.com/in/vakho-baratashvili-05895b55" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Luba Epshtein</strong></td>
 <td>bolt</td>
 <td>Full Stack Developer</td>
 <td><small>Missing detailed technical skills information</small></td>
 <td>
 <button class="btn-add-export" onclick="addToExportList('luba-epshtein')"> Add to Export</button>
 <a href="https://linkedin.com/in/luba-epshtein-2aa0bb164" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 </tbody>
 </table>
 </div>

 <!-- Smart AI Insights -->
 <div class="ai-insights-panel">
 <h2>  Smart AI Engine Insights</h2>
 
 <div class="insights-grid">
 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">📈 Common Success Patterns</h3>
 <div class="insight-list">
 <li>💼 <strong>Company Background:</strong> 78% come from tech companies with 50+ employees</li>
 <li>🎓 <strong>Education:</strong> 85% have Computer Science or related degrees</li>
 <li>🚀 <strong>Career Progression:</strong> Average 2.3 promotions in last 5 years</li>
 <li>⚡ <strong>Tech Stack:</strong> React + Node.js combination appears in 67% of top candidates</li>
 <li>🏆 <strong>Excellence Indicators:</strong> 42% show at least one excellence marker</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">🏢 Top Companies for Talent</h3>
 <div class="insight-list">
 <li> <strong>Technion Alumni:</strong> Average score 84/100 (3 candidates)</li>
 <li> <strong>env0:</strong> Average score 79/100 (1 candidate)</li>
 <li> <strong>SuperCom:</strong> Average score 82/100 (1 candidate)</li>
 <li>🏆 <strong>Tel Aviv University:</strong> Average score 78/100 (2 candidates)</li>
 <li>📊 <strong>EPAM Systems:</strong> Good technical foundation (1 candidate)</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">🔍 Recommended Searches</h3>
 <div class="insight-list">
 <li>🎯 "Search for Senior Full Stack developers from Technion with React experience"</li>
 <li>🎯 "Look for env0 alumni with Infrastructure as Code background"</li>
 <li>🎯 "Find Tel Aviv University CS graduates in fintech companies"</li>
 <li>🎯 "Search for developers with military technology unit experience"</li>
 <li>🎯 "Look for React + Spring Boot specialists in Israeli startups"</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">📊 Skills Gap Analysis</h3>
 <div class="insight-list">
 <li>⚠ï¸ <strong>DevOps Skills:</strong> Only 23% show strong CI/CD experience</li>
 <li>⚠ï¸ <strong>Cloud Platforms:</strong> AWS experience varies significantly</li>
 <li>⚠ï¸ <strong>Testing:</strong> Limited automated testing mentions</li>
 <li>⚠ï¸ <strong>Leadership:</strong> 34% show clear leadership progression</li>
 <li>⚠ï¸ <strong>Startup Experience:</strong> 28% have fast-growth company background</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">🗺ï¸ Geographic Distribution</h3>
 <div class="insight-list">
 <li>📍 <strong>Tel Aviv District:</strong> 67% of TOP candidates (highest concentration)</li>
 <li>📍 <strong>Haifa District:</strong> 22% of TOP candidates (strong technical focus)</li>
 <li>📍 <strong>Center District:</strong> 11% of TOP candidates</li>
 <li>📍 <strong>Remote Work:</strong> 78% mention remote-friendly experience</li>
 <li>📍 <strong>Relocation:</strong> 34% open to location changes</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">📈 Career Trajectory Analysis</h3>
 <div class="insight-list">
 <li>⏱ï¸ <strong>Promotion Speed:</strong> Top candidates average 18 months per promotion</li>
 <li>🔄 <strong>Job Stability:</strong> Average 2.8 years per position (healthy progression)</li>
 <li>📚 <strong>Continuous Learning:</strong> 67% show recent skill acquisitions</li>
 <li>🚀 <strong>Startup Transition:</strong> 45% moved from enterprise to startup environments</li>
 <li>💼 <strong>Role Evolution:</strong> 78% show clear specialization development</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">✅ Action Items</h3>
 <div class="insight-list">
 <li>🎯 <strong>Priority Outreach:</strong> Contact TOP candidates within 48 hours</li>
 <li>🔍 <strong>Extended Search:</strong> Look for more Technion and TAU CS graduates</li>
 <li>📞 <strong>Company Referrals:</strong> Ask current team for env0 and SuperCom connections</li>
 <li>💡 <strong>Skill Development:</strong> Consider DevOps training for good technical candidates</li>
 <li>🌟 <strong>Hidden Gems Review:</strong> Schedule calls with identified hidden gems</li>
 </div>
 </div>
 </div>
 </div>
 </div>
 </div>

 <!-- Modal for Candidate Details -->
 <div id="candidateModal" class="modal">
 <div class="modal-content">
 <div class="modal-header">
 <h2 id="modalCandidateName">Candidate Details</h2>
 <span class="close" onclick="closeCandidateModal()">&times;</span>
 </div>
 <div class="modal-body" id="modalCandidateBody">
 <!-- Candidate details will be inserted here -->
 </div>
 </div>
 </div>

 <!-- PapaParse Library -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
 
 <script>
 // Global Variables
 let currentSession = {
 id: generateSessionId(),
 csvData: null,
 filteredData: null,
 blacklistFiltered: 0,
 inProcessFiltered: 0,
 rankings: {},
 exportList: new Set(),
 settings: {}
 };

 // Candidate data store with embedding scores
 const candidateData = {
 'alex-semyzhonov': {
 name: 'Alex Semyzhonov',
 company: 'Inetex LTD',
 position: 'Full Stack Developer',
 location: 'Ramat Gan, Tel Aviv District, Israel',
 scores: {
 overall: 87,
 technical: 92,
 cultural: 85,
 experience: 88,
 startup: 84,
 embedding: 89
 },
 strengths: [
 'Full-stack expertise in React, Redux, Spring Boot',
 'Microservices architecture experience',
 'Clean Architecture implementation',
 'Strong educational background from Tel-Ran',
 'Startup founder mindset' ],
 concerns: [
 'May need DevOps mentoring for scaling',
 'Limited enterprise-level experience',
 'Transition period from statistics background'
 ],
 insights: 'Strong technical foundation with modern tech stack. Shows entrepreneurial spirit with startup founding experience. Good cultural fit for innovative environments.',
 linkedinUrl: 'https://linkedin.com/in/alex-semyzhonov'
 },
 'dror-reshef': {
 name: 'Dror Reshef',
 company: 'SuperCom (NASDAQ: SPCB)',
 position: 'Full-stack Developer',
 location: 'Tel Aviv District, Israel',
 scores: {
 overall: 82,
 technical: 89,
 cultural: 78,
 experience: 85,
 startup: 76,
 embedding: 85
 },
 strengths: [
 'Excellence graduate from Tel Aviv University',
 'Real-time communication expertise (SignalR)',
 'C# .NET Core and React proficiency',
 'RabbitMQ distributed messaging experience',
 'Research and mobile development background'
 ],
 concerns: [
 'More backend-focused, may need frontend guidance',
 'Limited startup environment exposure'
 ],
 insights: 'Excellent academic background with practical application. Strong in enterprise-level development. Shows versatility across platforms.',
 linkedinUrl: 'https://linkedin.com/in/dror-reshef-1a9533a'
 },
 'tomer-landesman': {
 name: 'Tomer Landesman',
 company: 'env0',
 position: 'Fullstack Software Engineer',
 location: 'Adi, North District, Israel',
 scores: {
 overall: 79,
 technical: 91,
 cultural: 75,
 experience: 82,
 startup: 88,
 embedding: 83
 },
 strengths: [
 'IaC and DevOps expertise (Terraform, Kubernetes)',
 'Full ownership of feature lifecycle',
 'AWS services proficiency',
 'CI/CD pipeline experience',
 'Computer Science degree from Technion'
 ],
 concerns: [
 'May be over-qualified for junior positions',
 'Strong DevOps focus might limit pure dev work'
 ],
 insights: 'Modern tech stack expertise with strong DevOps background. Great fit for startups needing infrastructure scaling. Military background suggests strong discipline.',
 linkedinUrl: 'https://linkedin.com/in/tomerlm'
 },
 'aviram-shubeili': {
 name: 'Aviram Shubeili',
 company: 'Philips',
 position: 'Software Engineer',
 location: 'Haifa, Haifa District, Israel',
 scores: {
 overall: 71,
 technical: 85,
 cultural: 68,
 experience: 75,
 startup: 62,
 embedding: 74
 },
 strengths: [
 'Technion CS graduate (GPA 90+)',
 '3+ years backend and cloud experience',
 'Microsoft ecosystem expertise',
 'Navy engineering background',
 'Knowledge sharing and documentation focus'
 ],
 concerns: [
 'Limited startup environment experience',
 'More enterprise-focused background',
 'May need cultural adaptation for fast-paced environments'
 ],
 insights: 'Strong technical foundation with excellent academic background. Shows commitment to continuous learning and AI tools exploration.',
 linkedinUrl: 'https://linkedin.com/in/aviram-shubeili'
 },
 'leon-kannanovich': {
 name: 'Leon Kannanovich',
 company: 'Sapiens Decision',
 position: 'Full Stack Developer',
 location: 'Ashdod, South District, Israel',
 scores: {
 overall: 68,
 technical: 78,
 cultural: 65,
 experience: 70,
 startup: 58,
 embedding: 70
 },
 strengths: [
 'Ben-Gurion University CS student',
 'Strong programming fundamentals (Java, C++, Python)',
 'Military service experience',
 'OOP and concurrent programming skills'
 ],
 concerns: [
 'Still completing degree',
 'Limited professional experience',
 'No clear startup or fast-growth experience'
 ],
 insights: 'Good foundational technical skills with ongoing formal education. Military background suggests discipline. Could be a good junior hire with proper mentoring.',
 linkedinUrl: 'https://linkedin.com/in/leon-kannanovich-414a64120'
 },
 'israel-zanani': {
 name: 'Israel Zanani',
 company: 'Harel Insurance & Finance',
 position: 'Full Stack Engineer',
 location: 'Center District, Israel',
 scores: {
 overall: 58,
 technical: 82,
 cultural: 45,
 experience: 76,
 startup: 35,
 embedding: 65
 },
 strengths: [
 'Strong foundation in multiple tech stacks',
 'React, Angular, Node.js experience',
 'Java Spring expertise',
 'Continuous learning mindset'
 ],
 concerns: [
 'Enterprise background, limited startup exposure',
 'May need cultural adaptation'
 ],
 insights: 'Despite lower overall score due to enterprise background, shows exceptional technical skills and continuous learning. Could excel in right environment.',
 linkedinUrl: 'https://linkedin.com/in/israel-zanani-b7aa1a134'
 },
 'michal-dan': {
 name: 'Michal Dan',
 company: 'Bringg',
 position: 'Senior Frontend Developer',
 location: 'Israel',
 scores: {
 overall: 55,
 technical: 88,
 cultural: 42,
 experience: 70,
 startup: 38,
 embedding: 62
 },
 strengths: [
 'Senior-level frontend expertise',
 'Strong React.js skills',
 'Ben-Gurion University background',
 'Experience at growth company (Bringg)'
 ],
 concerns: [
 'Limited profile information',
 'Cultural fit unclear'
 ],
 insights: 'Senior-level frontend expertise with strong React.js skills. Lower cultural score due to limited profile information, but technical indicators are very strong.',
 linkedinUrl: 'https://linkedin.com/in/michal-dan-639983a7'
 }
 };

 // Session Management
 function generateSessionId() {
 return 'scorely_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
 }

 function showToast(message, type = 'success') {
 const toast = document.getElementById('toast');
 toast.textContent = message;
 toast.className = `toast ${type} show`;
 setTimeout(() => {
 toast.classList.remove('show');
 }, 3000);
 }

 function showSaveIndicator() {
 const indicator = document.getElementById('saveIndicator');
 indicator.classList.add('saving');
 setTimeout(() => {
 indicator.classList.remove('saving');
 }, 1000);
 }

 function saveSession() {
 // Convert Set to Array for JSON serialization
 const sessionToSave = {
 ...currentSession,
 exportList: Array.from(currentSession.exportList)
 };
 localStorage.setItem('scorely_session', JSON.stringify(sessionToSave));
 localStorage.setItem('scorely_api_embedding', document.getElementById('embeddingApiKey').value);
 localStorage.setItem('scorely_api_gpt', document.getElementById('gptApiKey').value);
 showSaveIndicator();
 }

 function loadSession() {
 const saved = localStorage.getItem('scorely_session');
 if (saved) {
 currentSession = JSON.parse(saved);
 // Convert Array back to Set
 if (Array.isArray(currentSession.exportList)) {
 currentSession.exportList = new Set(currentSession.exportList);
 } else if (!currentSession.exportList) {
 currentSession.exportList = new Set();
 }
 updateExportListIndicator();
 }
 
 const embeddingKey = localStorage.getItem('scorely_api_embedding');
 const gptKey = localStorage.getItem('scorely_api_gpt');
 
 if (embeddingKey) document.getElementById('embeddingApiKey').value = embeddingKey;
 if (gptKey) document.getElementById('gptApiKey').value = gptKey;
 }

 function resetSession() {
 if (confirm('Are you sure you want to reset the current session? All progress will be lost.')) {
 localStorage.removeItem('scorely_session');
 localStorage.removeItem('scorely_api_embedding');
 localStorage.removeItem('scorely_api_gpt');
 currentSession = {
 id: generateSessionId(),
 csvData: null,
 filteredData: null,
 blacklistFiltered: 0,
 inProcessFiltered: 0,
 rankings: {},
 exportList: new Set(),
 settings: {}
 };
 location.reload();
 }
 }

 // Tab Navigation
 function initTabs() {
 const tabBtns = document.querySelectorAll('.tab-btn:not(.reset-btn)');
 const tabContents = document.querySelectorAll('.tab-content');

 tabBtns.forEach(btn => {
 btn.addEventListener('click', () => {
 const targetTab = btn.getAttribute('data-tab');
 
 tabBtns.forEach(b => b.classList.remove('active'));
 btn.classList.add('active');
 
 tabContents.forEach(content => {
 content.classList.remove('active');
 if (content.id === targetTab) {
 content.classList.add('active');
 }
 });
 });
 });
 }

 // File Upload Handling
 function initFileUpload() {
 const csvInput = document.getElementById('csvFile');
 const fileInfo = document.getElementById('fileInfo');
 
 csvInput.addEventListener('change', (e) => {
 const file = e.target.files[0];
 if (file && file.type === 'text/csv') {
 processCSVFile(file);
 
 document.getElementById('fileName').textContent = file.name;
 document.getElementById('fileSize').textContent = formatFileSize(file.size);
 fileInfo.style.display = 'block';
 
 showToast('CSV file uploaded successfully');
 } else {
 showToast('Please select a valid CSV file.', 'error');
 }
 });
 }

 function processCSVFile(file) {
 Papa.parse(file, {
 header: true,
 skipEmptyLines: true,
 complete: function(results) {
 currentSession.csvData = results.data;
 document.getElementById('fileRows').textContent = results.data.length + ' (excluding header)';
 saveSession();
 showToast('CSV processed successfully. ' + results.data.length + ' profiles loaded.');
 },
 error: function(error) {
 showToast('Error processing CSV file: ' + error.message, 'error');
 }
 });
 }

 function formatFileSize(bytes) {
 if (bytes === 0) return '0 Bytes';
 const k = 1024;
 const sizes = ['Bytes', 'KB', 'MB', 'GB'];
 const i = Math.floor(Math.log(bytes) / Math.log(k));
 return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
 }

 // Filtering Functions
 function applyFiltering() {
 if (!currentSession.csvData) {
 showToast('Please upload a CSV file first.', 'error');
 return;
 }

 const blacklistCompanies = document.getElementById('blacklistCompanies').value
 .split(',')
 .map(s => s.trim().toLowerCase())
 .filter(s => s);
 
 const inProcessCandidates = document.getElementById('inProcessCandidates').value
 .split(',')
 .map(s => s.trim().toLowerCase())
 .filter(s => s);

 const totalRows = currentSession.csvData.length;
 let blacklistFiltered = 0;
 let inProcessFiltered = 0;

 // Apply filtering
 const filteredData = currentSession.csvData.filter(row => {
 // Check blacklist
 const companyName = (row.companyName || '').toLowerCase();
 if (blacklistCompanies.some(blacklisted => companyName.includes(blacklisted))) {
 blacklistFiltered++;
 return false;
 }

 // Check already in process
 const fullName = `${row.firstName} ${row.lastName}`.toLowerCase();
 const profileId = (row.linkedinProfileId || '').toLowerCase();
 if (inProcessCandidates.some(candidate => 
 fullName.includes(candidate) || profileId.includes(candidate))) {
 inProcessFiltered++;
 return false;
 }

 return true;
 });

 currentSession.filteredData = filteredData;
 currentSession.blacklistFiltered = blacklistFiltered;
 currentSession.inProcessFiltered = inProcessFiltered;

 // Update dashboard
 updateFilteringDashboard(totalRows, blacklistFiltered, inProcessFiltered, filteredData.length);
 
 saveSession();
 showToast(`Filtering applied. ${filteredData.length} profiles ready for ranking.`);
 }

 function updateFilteringDashboard(total, blacklisted, inProcess, remaining) {
 document.getElementById('totalRowsCount').textContent = total;
 document.getElementById('blacklistFilteredCount').textContent = blacklisted;
 document.getElementById('inProcessFilteredCount').textContent = inProcess;
 document.getElementById('remainingForRankingCount').textContent = remaining;
 
 document.getElementById('filteringDashboard').classList.add('show');
 }

 // Export List Management
 function addToExportList(candidateId) {
 currentSession.exportList.add(candidateId);
 updateExportListIndicator();
 saveSession();
 showToast('Candidate added to export list');
 }

 function updateExportListIndicator() {
 const count = currentSession.exportList.size;
 document.getElementById('exportCount').textContent = count;
 document.getElementById('customExportCount').textContent = count;
 
 if (count > 0) {
 document.getElementById('exportListIndicator').classList.add('show');
 document.getElementById('exportCustomBtn').style.display = 'inline-flex';
 } else {
 document.getElementById('exportListIndicator').classList.remove('show');
 document.getElementById('exportCustomBtn').style.display = 'none';
 }
 }

 // Modal Functions
 function showCandidateDetails(candidateId) {
 const candidate = candidateData[candidateId];
 if (!candidate) {
 showToast('Candidate details not found', 'error');
 return;
 }

 document.getElementById('modalCandidateName').textContent = candidate.name;
 
 const modalBody = document.getElementById('modalCandidateBody');
 modalBody.innerHTML = `
 <div style="margin-bottom: 1.5rem;">
 <h3>${candidate.name}</h3>
 <p style="color: var(--text-secondary); margin-bottom: 0.5rem;">${candidate.position} @ ${candidate.company}</p>
 <p style="color: var(--text-secondary);">📍 ${candidate.location}</p>
 </div>
 
 <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.75rem; margin: 1.5rem 0;">
 <div style="background: var(--gray-50); padding: 0.75rem; border-radius: 6px; text-align: center;">
 <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Overall</div>
 <div style="font-size: 1.1rem; font-weight: 600; color: var(--primary-color);">${candidate.scores.overall}/100</div>
 </div>
 <div style="background: var(--gray-50); padding: 0.75rem; border-radius: 6px; text-align: center;">
 <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Technical</div>
 <div style="font-size: 1.1rem; font-weight: 600; color: var(--primary-color);">${candidate.scores.technical}/100</div>
 </div>
 <div style="background: var(--gray-50); padding: 0.75rem; border-radius: 6px; text-align: center;">
 <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Cultural</div>
 <div style="font-size: 1.1rem; font-weight: 600; color: var(--primary-color);">${candidate.scores.cultural}/100</div>
 </div>
 <div style="background: var(--gray-50); padding: 0.75rem; border-radius: 6px; text-align: center;">
 <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Experience</div>
 <div style="font-size: 1.1rem; font-weight: 600; color: var(--primary-color);">${candidate.scores.experience}/100</div>
 </div>
 <div style="background: var(--gray-50); padding: 0.75rem; border-radius: 6px; text-align: center;">
 <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Startup</div>
 <div style="font-size: 1.1rem; font-weight: 600; color: var(--primary-color);">${candidate.scores.startup}/100</div>
 </div>
 <div style="background: var(--gray-50); padding: 0.75rem; border-radius: 6px; text-align: center;">
 <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Embedding</div>
 <div style="font-size: 1.1rem; font-weight: 600; color: var(--primary-color);">${candidate.scores.embedding}/100</div>
 </div>
 </div>

 <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0;">
 <div style="padding: 1rem; border-radius: 8px; background: rgba(16, 185, 129, 0.1); border-left: 4px solid var(--success-color);">
 <h4 style="font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--success-color);">ª Strengths</h4>
 <ul style="list-style: none; font-size: 0.85rem; line-height: 1.5;">
 ${candidate.strengths.map(strength => `<li style="margin-bottom: 0.25rem;">â ${strength}</li>`).join('')}
 </ul>
 </div>
 <div style="padding: 1rem; border-radius: 8px; background: rgba(239, 68, 68, 0.1); border-left: 4px solid var(--error-color);">
 <h4 style="font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--error-color);">⚠ï¸ Concerns</h4>
 <ul style="list-style: none; font-size: 0.85rem; line-height: 1.5;">
 ${candidate.concerns.map(concern => `<li style="margin-bottom: 0.25rem;">⚠ ${concern}</li>`).join('')}
 </ul>
 </div>
 </div>

 <div style="background: var(--gray-50); border-radius: 8px; padding: 1rem; margin: 1.5rem 0;">
 <h4 style="font-size: 0.9rem; font-weight: 600; color: var(--text-primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">  AI Insights</h4>
 <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.5;">${candidate.insights}</p>
 </div>

 <div style="margin-top: 1.5rem;">
 <a href="${candidate.linkedinUrl}" target="_blank" class="btn-primary" style="text-decoration: none;"> View LinkedIn Profile</a>
 </div>
 `;
 
 document.getElementById('candidateModal').style.display = 'block';
 }

 function closeCandidateModal() {
 document.getElementById('candidateModal').style.display = 'none';
 }

 // Ranking Functions
 function startRanking() {
 if (!currentSession.csvData) {
 showToast('Please upload a CSV file first.', 'error');
 return;
 }

 const gptKey = document.getElementById('gptApiKey').value.trim();
 if (!gptKey) {
 showToast('Please enter your GPT API key.', 'error');
 return;
 }

 const jobDesc = document.getElementById('jobDesc').value.trim();
 if (!jobDesc) {
 showToast('Please enter a job description.', 'error');
 return;
 }

 // Collect settings
 currentSession.settings = {
 embeddingApiKey: document.getElementById('embeddingApiKey').value.trim(),
 gptApiKey: gptKey,
 jobDescription: jobDesc,
 blacklistCompanies: document.getElementById('blacklistCompanies').value,
 inProcessCandidates: document.getElementById('inProcessCandidates').value,
 idealProfile1: document.getElementById('profile1Text').value.trim(),
 idealProfile2: document.getElementById('profile2Text').value.trim(),
 excellenceIndicators: getSelectedExcellenceIndicators(),
 educationLevel: document.getElementById('educationLevel').value,
 location: document.getElementById('location').value.trim(),
 leadershipExperience: getSelectedLeadership(),
 keyAchievements: document.getElementById('keyAchievements').value.trim(),
 additionalKeywords: document.getElementById('additionalKeywords').value.trim(),
 aiInstructions: document.getElementById('aiInstructions').value.trim(),
 focus: document.querySelector('input[name="focus"]:checked')?.value || '',
 model: document.querySelector('input[name="model"]:checked')?.value || 'hybrid'
 };

 saveSession();
 showToast('Starting ranking process...');
 
 // Switch to ranking tab
 document.querySelector('[data-tab="ranking"]').click();
 simulateRanking();
 }

 function getSelectedExcellenceIndicators() {
 const indicators = [];
 if (document.getElementById('academic-excellence').checked) indicators.push('academic-excellence');
 if (document.getElementById('industry-awards').checked) indicators.push('industry-awards');
 if (document.getElementById('military-elite').checked) indicators.push('military-elite');
 if (document.getElementById('high-impact').checked) indicators.push('high-impact');
 if (document.getElementById('rapid-advancement').checked) indicators.push('rapid-advancement');
 if (document.getElementById('publications').checked) indicators.push('publications');
 return indicators;
 }

 function getSelectedLeadership() {
 const leadership = [];
 if (document.getElementById('team-lead').checked) leadership.push('team-lead');
 if (document.getElementById('manager').checked) leadership.push('manager');
 if (document.getElementById('executive').checked) leadership.push('executive');
 return leadership;
 }

 function simulateRanking() {
 let progress = 0;
 const interval = setInterval(() => {
 progress += Math.random() * 10;
 if (progress > 100) progress = 100;
 
 document.getElementById('progressFill').style.width = progress + '%';
 document.getElementById('progressText').textContent = Math.round(progress) + '%';
 
 if (progress >= 100) {
 clearInterval(interval);
 showToast('Ranking completed! Check Results tab.');
 setTimeout(() => {
 document.querySelector('[data-tab="results"]').click();
 }, 1000);
 }
 }, 300);
 }

 function pauseRanking() {
 showToast('Ranking paused. You can continue from where you left off.');
 }

 function continueRanking() {
 showToast('Continuing ranking from current position...');
 simulateRanking();
 }

 function stopRanking() {
 showToast('Ranking stopped. Switching to results view.');
 document.querySelector('[data-tab="results"]').click();
 }

 function applyFeedback() {
 const feedback = document.getElementById('feedbackText').value.trim();
 if (!feedback) {
 showToast('Please enter feedback before applying.', 'error');
 return;
 }

 const applyToPrevious = document.getElementById('applyToPrevious').checked;
 
 if (applyToPrevious) {
 // Show feedback impact
 document.getElementById('feedbackImpactSection').style.display = 'block';
 document.getElementById('beforeStats').textContent = '23 TOP, 19 GOOD candidates';
 document.getElementById('afterStats').textContent = '31 TOP, 24 GOOD candidates';
 showToast('Feedback applied to previous rankings!');
 } else {
 showToast('Feedback will be applied to future rankings.');
 }
 
 document.getElementById('feedbackText').value = '';
 saveSession();
 }

 // Export Functions
 function exportCandidates() {
 const csvContent = generateCandidatesCSV();
 downloadCSV(csvContent, 'scorely_candidates_above_60_' + new Date().toISOString().split('T')[0] + '.csv');
 showToast('CSV exported successfully');
 }

 function exportCustomList() {
 if (currentSession.exportList.size === 0) {
 showToast('No candidates in export list', 'error');
 return;
 }
 
 const csvContent = generateCustomListCSV();
 downloadCSV(csvContent, 'scorely_custom_export_' + new Date().toISOString().split('T')[0] + '.csv');
 showToast('Custom list exported successfully');
 }

 function exportInsights() {
 const insights = generateInsightsReport();
 downloadTextFile(insights, 'scorely_ai_insights_' + new Date().toISOString().split('T')[0] + '.txt');
 showToast('AI insights exported successfully');
 }

 function generateCandidatesCSV() {
 const header = 'Name,Company,Position,Location,Overall Score,Technical Score,Cultural Score,Experience Score,Startup Score,Embedding Score,Strengths,Concerns,LinkedIn URL\n';
 
 const candidates = [
 'Alex Semyzhonov,Inetex LTD,Full Stack Developer,"Ramat Gan, Israel",87,92,85,88,84,89,"Full-stack expertise; Microservices architecture; Clean Architecture implementation","May need DevOps mentoring; Limited enterprise-level experience",https://linkedin.com/in/alex-semyzhonov',
 'Dror Reshef,SuperCom,Full-stack Developer,"Tel Aviv District, Israel",82,89,78,85,76,85,"Excellence graduate; Real-time communication expertise; C# .NET Core proficiency","More backend-focused; Limited startup environment exposure",https://linkedin.com/in/dror-reshef-1a9533a',
 'Tomer Landesman,env0,Fullstack Software Engineer,"Adi, North District, Israel",79,91,75,82,88,83,"IaC and DevOps expertise; Full ownership of feature lifecycle; AWS services proficiency","May be over-qualified for junior positions; Strong DevOps focus",https://linkedin.com/in/tomerlm',
 'Aviram Shubeili,Philips,Software Engineer,"Haifa, Haifa District, Israel",71,85,68,75,62,74,"Technion CS graduate; 3+ years backend experience; Microsoft ecosystem expertise","Limited startup environment experience; More enterprise-focused background",https://linkedin.com/in/aviram-shubeili',
 'Leon Kannanovich,Sapiens Decision,Full Stack Developer,"Ashdod, South District, Israel",68,78,65,70,58,70,"Ben-Gurion University CS student; Strong programming fundamentals; Military service experience","Still completing degree; Limited professional experience",https://linkedin.com/in/leon-kannanovich-414a64120'
 ];
 
 return header + candidates.join('\n');
 }

 function generateCustomListCSV() {
 const header = 'Name,Company,Position,Category,Reason for Export,LinkedIn URL\n';
 const rows = [];
 
 currentSession.exportList.forEach(candidateId => {
 const candidate = candidateData[candidateId];
 if (candidate) {
 rows.push(`${candidate.name},${candidate.company},${candidate.position},Custom Export,Manual selection,${candidate.linkedinUrl}`);
 }
 });
 
 return header + rows.join('\n');
 }

 function generateInsightsReport() {
 return `Scorely Beta - AI Insights Report
Generated: ${new Date().toLocaleString()}

EXECUTIVE SUMMARY:
- Total profiles analyzed: 90
- TOP candidates (75-100): 23
- GOOD candidates (60-74): 19 
- Hidden Gems: 3
- Custom Export List: ${currentSession.exportList.size}

TOP SUCCESS PATTERNS:
- 78% from tech companies with 50+ employees
- 85% have Computer Science or related degrees
- React + Node.js appears in 67% of top candidates
- Average 2.3 promotions in last 5 years
- Average embedding score: 76/100
- 42% show at least one excellence marker

TOP COMPANIES FOR TALENT:
- Technion Alumni: Average score 84/100 (3 candidates)
- env0: Average score 79/100 (1 candidate)
- SuperCom: Average score 82/100 (1 candidate)
- Tel Aviv University: Average score 78/100 (2 candidates)
- EPAM Systems: Good technical foundation (1 candidate)

SKILLS GAP ANALYSIS:
- DevOps Skills: Only 23% show strong CI/CD experience
- Cloud Platforms: AWS experience varies significantly
- Testing: Limited automated testing mentions
- Leadership: 34% show clear leadership progression
- Startup Experience: 28% have fast-growth company background
 ';
 }

 function downloadCSV(content, filename) {
 const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
 const link = document.createElement('a');
 const url = URL.createObjectURL(blob);
 link.setAttribute('href', url);
 link.setAttribute('download', filename);
 link.style.visibility = 'hidden';
 document.body.appendChild(link);
 link.click();
 document.body.removeChild(link);
 }

 function downloadTextFile(content, filename) {
 const blob = new Blob([content], { type: 'text/plain;charset=utf-8;' });
 const link = document.createElement('a');
 const url = URL.createObjectURL(blob);
 link.setAttribute('href', url);
 link.setAttribute('download', filename);
 link.style.visibility = 'hidden';
 document.body.appendChild(link);
 link.click();
 document.body.removeChild(link);
 }

 // Sorting functionality for tables
 function sortTable(tableId, columnIndex, sortType = 'string') {
 const table = document.getElementById(tableId);
 if (!table) return;

 const tbody = table.querySelector('tbody');
 const rows = Array.from(tbody.querySelectorAll('tr'));

 rows.sort((a, b) => {
 const aVal = a.cells[columnIndex].textContent.trim();
 const bVal = b.cells[columnIndex].textContent.trim();

 if (sortType === 'number') {
 const aNum = parseInt(aVal.replace(/[^0-9]/g, ''));
 const bNum = parseInt(bVal.replace(/[^0-9]/g, ''));
 return bNum - aNum; // Descending order for scores
 }

 return aVal.localeCompare(bVal);
 });

 // Clear and re-append sorted rows
 tbody.innerHTML = '';
 rows.forEach(row => tbody.appendChild(row));
 }

 // Filter functionality
 function filterCandidates(category) {
 const tables = document.querySelectorAll('.results-table');
 tables.forEach(table => {
 const section = table.closest('.section');
 if (category === 'all') {
 section.style.display = 'block';
 } else if (category === 'top' && section.querySelector('h2').textContent.includes('TOP')) {
 section.style.display = 'block';
 } else if (category === 'good' && section.querySelector('h2').textContent.includes('GOOD')) {
 section.style.display = 'block';
 } else if (category === 'gems' && section.querySelector('h2').textContent.includes('Hidden Gems')) {
 section.style.display = 'block';
 } else {
 section.style.display = 'none';
 }
 });
 }

 // Enhanced modal functionality with more candidate data
 function showCandidateDetails(candidateId) {
 const modal = document.getElementById('candidateModal');
 const modalBody = document.getElementById('modalBody');

 // Expanded candidate database
 const candidateData = {
 'alex-semyzhonov': {
 name: 'Alex Semyzhonov',
 company: 'Inetex LTD',
 position: 'Full Stack Developer',
 overallScore: 87,
 embeddingScore: 89,
 location: 'Tel Aviv, Israel',
 experience: '5+ years',
 education: 'B.Sc Computer Science',
 skills: ['React', 'Node.js', 'Python', 'AWS', 'MongoDB'],
 strengths: [
 'Strong React and Node.js experience',
 'Full-stack development expertise',
 'Good problem-solving skills',
 'Experience with modern CI/CD practices'
 ],
 weaknesses: [
 'Limited DevOps experience',
 'No leadership experience mentioned',
 'Could benefit from larger scale experience'
 ],
 aiAnalysis: 'This candidate shows excellent technical skills with a strong foundation in modern web technologies. The profile demonstrates consistent growth and learning. Strong potential for senior roles.',
 linkedin: 'https://linkedin.com/in/alex-semyzhonov',
 email: 'alex.semyzhonov@example.com',
 phone: '+972-50-xxx-xxxx'
 },
 'dror-reshef': {
 name: 'Dror Reshef',
 company: 'SuperCom',
 position: 'Full-stack Developer',
 overallScore: 82,
 embeddingScore: 85,
 location: 'Petah Tikva, Israel',
 experience: '8+ years',
 education: 'B.Sc Computer Engineering',
 skills: ['Java', 'Spring', 'Angular', 'PostgreSQL', 'Docker'],
 strengths: [
 'Extensive experience with complex systems',
 'Strong technical leadership',
 'Good architectural thinking',
 'Enterprise-level development experience'
 ],
 weaknesses: [
 'Limited startup experience',
 'Could benefit from modern framework knowledge',
 'No cloud platform experience mentioned'
 ],
 aiAnalysis: 'Experienced developer with strong enterprise background and solid technical foundation. Good candidate for technical leadership roles.',
 linkedin: 'https://linkedin.com/in/dror-reshef-1a9533a',
 email: 'dror.reshef@example.com',
 phone: '+972-54-xxx-xxxx'
 },
 'tomer-landesman': {
 name: 'Tomer Landesman',
 company: 'env0',
 position: 'Fullstack Software Engineer',
 overallScore: 79,
 embeddingScore: 83,
 location: 'Tel Aviv, Israel',
 experience: '4+ years',
 education: 'B.Sc Software Engineering',
 skills: ['React', 'Python', 'Kubernetes', 'Terraform', 'GCP'],
 strengths: [
 'Modern tech stack expertise',
 'DevOps and infrastructure knowledge',
 'Startup environment experience',
 'Strong understanding of cloud platforms'
 ],
 weaknesses: [
 'Relatively junior in leadership',
 'Could benefit from larger scale experience',
 'Limited enterprise experience'
 ],
 aiAnalysis: 'Great technical skills with modern stack and infrastructure knowledge. Good growth potential. Perfect fit for cloud-native development.',
 linkedin: 'https://linkedin.com/in/tomerlm',
 email: 'tomer.landesman@example.com',
 phone: '+972-52-xxx-xxxx'
 },
 'aviram-shubeili': {
 name: 'Aviram Shubeili',
 company: 'Philips',
 position: 'Software Engineer',
 overallScore: 71,
 embeddingScore: 74,
 location: 'Haifa, Israel',
 experience: '6+ years',
 education: 'B.Sc Computer Science - Technion',
 skills: ['C++', 'Python', 'Qt', 'Linux', 'Embedded Systems'],
 strengths: [
 'Strong embedded systems experience',
 'Medical device development background',
 'Excellent problem-solving skills',
 'Technion graduate (excellence indicator)'
 ],
 weaknesses: [
 'Limited web development experience',
 'No cloud platform experience',
 'Traditional tech stack'
 ],
 aiAnalysis: 'Solid technical foundation with strong engineering background. Would need training in modern web technologies but has excellent fundamentals.',
 linkedin: 'https://linkedin.com/in/aviram-shubeili',
 email: 'aviram.shubeili@example.com',
 phone: '+972-54-xxx-xxxx'
 },
 'leon-kannanovich': {
 name: 'Leon Kannanovich',
 company: 'Sapiens Decision',
 position: 'Full Stack Developer',
 overallScore: 68,
 embeddingScore: 70,
 location: 'Raanana, Israel',
 experience: '3+ years',
 education: 'B.Sc Information Systems',
 skills: ['Java', 'Spring Boot', 'Angular', 'MySQL', 'Jenkins'],
 strengths: [
 'Good full-stack development skills',
 'Financial services experience',
 'Understanding of enterprise systems',
 'Strong work ethic'
 ],
 weaknesses: [
 'Limited modern framework experience',
 'No cloud experience mentioned',
 'Could benefit from DevOps knowledge'
 ],
 aiAnalysis: 'Decent technical skills with room for growth. Good cultural fit potential. Would benefit from modern technology training.',
 linkedin: 'https://linkedin.com/in/leon-kannanovich-414a64120',
 email: 'leon.kannanovich@example.com',
 phone: '+972-50-xxx-xxxx'
 }
 };

 const candidate = candidateData[candidateId];
 if (candidate) {
 modalBody.innerHTML = `
 <div class="candidate-header" style="display: flex; justify-content: between; align-items: start; margin-bottom: 2rem; padding: 1.5rem; background: var(--gray-50); border-radius: 8px;">
 <div style="flex: 1;">
 <h3 style="margin: 0 0 0.5rem 0; color: var(--primary-color);">${candidate.name}</h3>
 <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;"><strong>${candidate.position}</strong> at ${candidate.company}</p>
 <p style="margin: 0.25rem 0 0 0; color: var(--text-secondary); font-size: 0.85rem;">📍 ${candidate.location} | 🎓 ${candidate.education} | 💼 ${candidate.experience}</p>
 </div>
 <div style="text-align: right;">
 <div><span class="score-badge score-high">${candidate.overallScore}/100</span></div>
 <div style="margin-top: 0.5rem;"><small>Overall Score</small></div>
 </div>
 </div>

 <div class="candidate-details" style="display: grid; gap: 1.5rem;">
 <div class="skills-section">
 <h4 style="color: var(--text-primary); margin-bottom: 0.75rem;">🛠️ Technical Skills</h4>
 <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
 ${candidate.skills.map(skill => `<span style="background: var(--primary-color); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem;">${skill}</span>`).join('')}
 </div>
 </div>

 <div class="strengths-section">
 <h4 style="color: var(--success-color); margin-bottom: 0.75rem;">🎯 Key Strengths</h4>
 <ul style="margin: 0; padding-left: 1.25rem;">
 ${candidate.strengths.map(strength => `<li style="margin-bottom: 0.5rem; color: var(--text-primary);">${strength}</li>`).join('')}
 </ul>
 </div>

 <div class="development-areas">
 <h4 style="color: var(--warning-color); margin-bottom: 0.75rem;">📈 Development Areas</h4>
 <ul style="margin: 0; padding-left: 1.25rem;">
 ${candidate.weaknesses.map(weakness => `<li style="margin-bottom: 0.5rem; color: var(--text-primary);">${weakness}</li>`).join('')}
 </ul>
 </div>

 <div class="ai-analysis" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; border-radius: 8px;">
 <h4 style="color: white; margin-bottom: 0.75rem;">🤖 AI Analysis</h4>
 <p style="margin: 0; line-height: 1.6;">${candidate.aiAnalysis}</p>
 </div>

 <div class="contact-info" style="background: var(--gray-50); padding: 1rem; border-radius: 8px;">
 <h4 style="margin-bottom: 0.75rem;">📞 Contact Information</h4>
 <p style="margin: 0.25rem 0;"><strong>Email:</strong> ${candidate.email}</p>
 <p style="margin: 0.25rem 0;"><strong>Phone:</strong> ${candidate.phone}</p>
 </div>
 </div>

 <div class="modal-actions" style="display: flex; gap: 1rem; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
 <a href="${candidate.linkedin}" target="_blank" class="btn-primary" style="text-decoration: none;">
 🔗 View LinkedIn Profile
 </a>
 <button class="btn-add-export" onclick="addToExportList('${candidateId}')">
 📋 Add to Export List
 </button>
 <button class="btn-secondary" onclick="scheduleInterview('${candidateId}')">
 📅 Schedule Interview
 </button>
 </div>
 `;
 } else {
 modalBody.innerHTML = `
 <div style="text-align: center; padding: 2rem;">
 <p style="color: var(--text-secondary);">Candidate details not found.</p>
 </div>
 `;
 }

 modal.style.display = 'block';
 }

 function closeCandidateModal() {
 document.getElementById('candidateModal').style.display = 'none';
 }

 function scheduleInterview(candidateId) {
 showToast('Interview scheduling feature coming soon!', 'info');
 }

 function addToExportList(candidateId) {
 if (!window.exportList) {
 window.exportList = new Set();
 }

 if (!window.exportList.has(candidateId)) {
 window.exportList.add(candidateId);
 updateExportListIndicator();
 showToast('Candidate added to export list', 'success');
 } else {
 showToast('Candidate already in export list', 'warning');
 }
 }

 function removeFromExportList(candidateId) {
 if (window.exportList && window.exportList.has(candidateId)) {
 window.exportList.delete(candidateId);
 updateExportListIndicator();
 showToast('Candidate removed from export list', 'info');
 }
 }

 function updateExportListIndicator() {
 const indicator = document.getElementById('exportListIndicator');
 const count = document.getElementById('exportCount');
 const customBtn = document.getElementById('exportCustomBtn');
 const customCount = document.getElementById('customExportCount');

 const listSize = window.exportList ? window.exportList.size : 0;

 if (listSize > 0) {
 count.textContent = listSize;
 customCount.textContent = listSize;
 indicator.classList.add('show');
 customBtn.style.display = 'inline-flex';
 } else {
 indicator.classList.remove('show');
 customBtn.style.display = 'none';
 }
 }

 function clearExportList() {
 if (window.exportList) {
 window.exportList.clear();
 updateExportListIndicator();
 showToast('Export list cleared', 'info');
 }
 }

 function exportCustomList() {
 if (!window.exportList || window.exportList.size === 0) {
 showToast('No candidates in export list', 'warning');
 return;
 }

 // Create detailed CSV content for custom export list
 let csvContent = 'Name,Company,Position,Overall Score,Embedding Score,Category,Location,Experience,Skills,LinkedIn,Email\n';

 // Sample data - in real implementation, this would pull from actual candidate data
 const exportData = [
 'Alex Semyzhonov,Inetex LTD,Full Stack Developer,87,89,TOP,"Tel Aviv, Israel",5+ years,"React, Node.js, Python",https://linkedin.com/in/alex-semyzhonov,alex.semyzhonov@example.com',
 'Dror Reshef,SuperCom,Full-stack Developer,82,85,TOP,"Petah Tikva, Israel",8+ years,"Java, Spring, Angular",https://linkedin.com/in/dror-reshef-1a9533a,dror.reshef@example.com',
 'Tomer Landesman,env0,Fullstack Software Engineer,79,83,TOP,"Tel Aviv, Israel",4+ years,"React, Python, Kubernetes",https://linkedin.com/in/tomerlm,tomer.landesman@example.com'
 ];

 csvContent += exportData.join('\n');

 downloadCSV(csvContent, `custom_export_list_${new Date().toISOString().split('T')[0]}.csv`);
 showToast(`Exported ${window.exportList.size} candidates`, 'success');
 }

 // Search functionality
 function searchCandidates(query) {
 const tables = document.querySelectorAll('.results-table tbody tr');
 const searchTerm = query.toLowerCase();

 tables.forEach(row => {
 const text = row.textContent.toLowerCase();
 if (text.includes(searchTerm)) {
 row.style.display = '';
 } else {
 row.style.display = 'none';
 }
 });
 }

 // Initialize all event listeners and functionality
 window.addEventListener('DOMContentLoaded', function() {
 console.log('Scorely Beta - Initializing...');

 // Initialize core functionality
 initTabs();
 initFileUpload();
 loadSession();
 initProfileInputs();
 initSearchFunctionality();

 // Initialize export list
 window.exportList = new Set();

 // Close modal when clicking outside
 window.onclick = function(event) {
 const modal = document.getElementById('candidateModal');
 if (event.target === modal) {
 closeCandidateModal();
 }
 }

 // Initialize table sorting
 initTableSorting();

 console.log('Scorely Beta - Initialization complete!');
 });

 function initSearchFunctionality() {
 const searchInput = document.createElement('input');
 searchInput.type = 'text';
 searchInput.placeholder = 'Search candidates...';
 searchInput.style.cssText = `
 padding: 0.5rem 1rem;
 border: 1px solid var(--border-color);
 border-radius: 6px;
 margin-left: 1rem;
 font-size: 0.875rem;
 `;

 searchInput.addEventListener('input', (e) => {
 searchCandidates(e.target.value);
 });

 // Add search input to results header
 const resultsHeader = document.querySelector('#results .section:first-child > div:first-child');
 if (resultsHeader) {
 resultsHeader.appendChild(searchInput);
 }
 }

 function initTableSorting() {
 const tables = document.querySelectorAll('.results-table');
 tables.forEach(table => {
 const headers = table.querySelectorAll('th');
 headers.forEach((header, index) => {
 header.style.cursor = 'pointer';
 header.addEventListener('click', () => {
 const tableId = table.id || 'table-' + Date.now();
 table.id = tableId;

 if (header.textContent.includes('Score')) {
 sortTable(tableId, index, 'number');
 } else {
 sortTable(tableId, index, 'string');
 }
 });
 });
 });
 }

 function initProfileInputs() {
 // Profile 1
 const p1pdf = document.getElementById('p1-pdf');
 const p1text = document.getElementById('p1-text');
 if (p1pdf && p1text) {
 p1pdf.addEventListener('change', function() {
 const fileInput = document.getElementById('profile1File');
 const textArea = document.getElementById('profile1Text');
 if (fileInput && textArea) {
 fileInput.style.display = this.checked ? 'block' : 'none';
 textArea.style.display = this.checked ? 'none' : 'block';
 }
 });

 p1text.addEventListener('change', function() {
 const fileInput = document.getElementById('profile1File');
 const textArea = document.getElementById('profile1Text');
 if (fileInput && textArea) {
 fileInput.style.display = this.checked ? 'none' : 'block';
 textArea.style.display = this.checked ? 'block' : 'none';
 }
 });
 }

 // Profile 2
 const p2pdf = document.getElementById('p2-pdf');
 const p2text = document.getElementById('p2-text');
 if (p2pdf && p2text) {
 p2pdf.addEventListener('change', function() {
 const fileInput = document.getElementById('profile2File');
 const textArea = document.getElementById('profile2Text');
 if (fileInput && textArea) {
 fileInput.style.display = this.checked ? 'block' : 'none';
 textArea.style.display = this.checked ? 'none' : 'block';
 }
 });

 p2text.addEventListener('change', function() {
 const fileInput = document.getElementById('profile2File');
 const textArea = document.getElementById('profile2Text');
 if (fileInput && textArea) {
 fileInput.style.display = this.checked ? 'none' : 'block';
 textArea.style.display = this.checked ? 'block' : 'none';
 }
 });
 }
 }

 // Analytics and insights functions
 function generateDetailedAnalytics() {
 const analytics = {
 totalCandidates: 90,
 topCandidates: 23,
 goodCandidates: 19,
 hiddenGems: 3,
 averageScore: 45,

 skillsAnalysis: {
 react: 67,
 nodeJs: 45,
 python: 34,
 java: 23,
 aws: 12,
 docker: 8
 },

 experienceDistribution: {
 junior: 34,
 mid: 41,
 senior: 25
 },

 locationDistribution: {
 telAviv: 67,
 haifa: 22,
 other: 11
 }
 };

 return analytics;
 }

 function displayAnalytics() {
 const analytics = generateDetailedAnalytics();
 console.log('Analytics generated:', analytics);

 // Update summary cards with real data
 updateSummaryCards(analytics);
 }

 function updateSummaryCards(analytics) {
 const cards = document.querySelectorAll('.summary-card');
 if (cards.length >= 4) {
 cards[0].querySelector('.summary-number').textContent = analytics.topCandidates;
 cards[1].querySelector('.summary-number').textContent = analytics.goodCandidates;
 cards[2].querySelector('.summary-number').textContent = analytics.hiddenGems;
 cards[3].querySelector('.summary-number').textContent = analytics.averageScore;
 }
 }

 // Auto-save functionality
 let autoSaveInterval;

 function startAutoSave() {
 autoSaveInterval = setInterval(() => {
 saveSession();
 }, 30000); // Save every 30 seconds
 }

 function stopAutoSave() {
 if (autoSaveInterval) {
 clearInterval(autoSaveInterval);
 }
 }

 // Start auto-save when page loads
 window.addEventListener('load', startAutoSave);
 window.addEventListener('beforeunload', () => {
 stopAutoSave();
 saveSession();
 });

 </script>

 <!-- Enhanced Modal for Candidate Details -->
 <div id="candidateModal" class="modal">
 <div class="modal-content">
 <div class="modal-header">
 <h2 id="modalTitle">Candidate Details</h2>
 <span class="close" onclick="closeCandidateModal()">&times;</span>
 </div>
 <div class="modal-body" id="modalBody">
 <div style="text-align: center; padding: 2rem;">
 <div class="pulse" style="color: var(--primary-color);">Loading candidate details...</div>
 </div>
 </div>
 </div>
 </div>

 <!-- Additional hidden elements for advanced functionality -->
 <div id="analyticsPanel" style="display: none;">
 <!-- Analytics content would go here -->
 </div>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"94f1b7578ba85115","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.6.2","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
