<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Scorely Beta - LinkedIn Profile Ranker</title>
 <style>
 :root {
 --primary-color: #2563eb;
 --secondary-color: #f8fafc;
 --success-color: #10b981;
 --warning-color: #f59e0b;
 --error-color: #ef4444;
 --text-primary: #1f2937;
 --text-secondary: #6b7280;
 --border-color: #e5e7eb;
 --white: #ffffff;
 --gray-50: #f9fafb;
 --gray-100: #f3f4f6;
 --gray-200: #e5e7eb;
 --gray-300: #d1d5db;
 --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
 --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
 --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
 }

 * {
 margin: 0;
 padding: 0;
 box-sizing: border-box;
 }

 body {
 font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
 background: var(--white);
 color: var(--text-primary);
 line-height: 1.6;
 }

 .container {
 max-width: 1400px;
 margin: 0 auto;
 min-height: 100vh;
 background: var(--white);
 }

 /* Toast Notifications */
 .toast {
 position: fixed;
 top: 20px;
 right: 20px;
 background: var(--success-color);
 color: white;
 padding: 12px 24px;
 border-radius: 8px;
 box-shadow: var(--shadow-lg);
 z-index: 9999;
 opacity: 0;
 transform: translateX(100%);
 transition: all 0.3s ease;
 max-width: 400px;
 font-size: 0.875rem;
 font-weight: 500;
 }

 .toast.show {
 opacity: 1;
 transform: translateX(0);
 }

 .toast.error {
 background: var(--error-color);
 }

 .toast.warning {
 background: var(--warning-color);
 }

 .toast.info {
 background: var(--primary-color);
 }

 /* Save Indicator */
 .save-indicator {
 position: fixed;
 bottom: 20px;
 right: 20px;
 background: var(--primary-color);
 color: white;
 padding: 8px 16px;
 border-radius: 20px;
 font-size: 0.8rem;
 opacity: 0;
 transition: opacity 0.3s;
 z-index: 1000;
 }

 .save-indicator.saving {
 opacity: 1;
 }

 /* Export List Indicator */
 .export-list-indicator {
 position: fixed;
 top: 80px;
 right: 20px;
 background: var(--warning-color);
 color: white;
 padding: 8px 16px;
 border-radius: 8px;
 font-size: 0.9rem;
 z-index: 100;
 display: none;
 }

 .export-list-indicator.show {
 display: block;
 }

 /* Filtering Dashboard */
 .filtering-dashboard {
 background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
 color: white;
 padding: 2rem;
 border-radius: 16px;
 margin-bottom: 2rem;
 display: none;
 }

 .filtering-dashboard.show {
 display: block;
 }

 .filter-stats {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
 gap: 1rem;
 margin-top: 1rem;
 }

 .filter-stat {
 background: rgba(255, 255, 255, 0.15);
 padding: 1.5rem;
 border-radius: 12px;
 text-align: center;
 }

 .filter-stat .number {
 font-size: 2rem;
 font-weight: 700;
 margin-bottom: 0.5rem;
 }

 .filter-stat .label {
 font-size: 0.875rem;
 opacity: 0.9;
 }

 /* Navigation */
 .navbar {
 background: white;
 border-bottom: 2px solid var(--border-color);
 padding: 1.5rem 2rem;
 position: sticky;
 top: 0;
 z-index: 1000;
 box-shadow: var(--shadow-md);
 }

 .nav-brand h1 {
 color: var(--primary-color);
 font-size: 2.5rem;
 font-weight: 800;
 margin-bottom: 0.25rem;
 }

 .nav-brand p {
 color: var(--text-secondary);
 font-size: 1rem;
 font-weight: 500;
 }

 .nav-tabs {
 display: flex;
 gap: 0.75rem;
 align-items: center;
 margin-top: 1rem;
 }

 .tab-btn {
 padding: 0.875rem 1.75rem;
 border: 2px solid var(--border-color);
 background: var(--white);
 color: var(--text-secondary);
 cursor: pointer;
 border-radius: 12px;
 font-size: 0.875rem;
 font-weight: 600;
 transition: all 0.2s ease;
 display: flex;
 align-items: center;
 gap: 0.5rem;
 }

 .tab-btn:hover {
 border-color: var(--primary-color);
 color: var(--primary-color);
 }

 .tab-btn.active {
 background: var(--primary-color);
 color: white;
 border-color: var(--primary-color);
 }

 .reset-btn {
 margin-left: auto;
 background: var(--error-color) !important;
 color: white !important;
 border-color: var(--error-color) !important;
 }

 /* Tab Content */
 .tab-content {
 display: none;
 padding: 2rem;
 max-width: 1000px;
 margin: 0 auto;
 }

 .tab-content.active {
 display: block;
 }

 /* Sections */
 .section {
 background: white;
 border: 1px solid var(--border-color);
 border-radius: 16px;
 padding: 2rem;
 margin-bottom: 2rem;
 box-shadow: var(--shadow-md);
 }

 .section h2 {
 color: var(--text-primary);
 font-size: 1.375rem;
 font-weight: 700;
 margin-bottom: 1.5rem;
 display: flex;
 align-items: center;
 gap: 0.75rem;
 }

 .section h3 {
 color: var(--text-primary);
 font-size: 1.125rem;
 font-weight: 600;
 margin-bottom: 1rem;
 }

 /* Form Elements */
 input[type="text"], 
 input[type="email"], 
 input[type="password"],
 input[type="number"],
 textarea, 
 select {
 width: 100%;
 padding: 0.875rem 1rem;
 border: 1px solid var(--border-color);
 border-radius: 8px;
 font-size: 0.875rem;
 background: white;
 transition: all 0.2s ease;
 }

 input:focus, 
 textarea:focus, 
 select:focus {
 outline: none;
 border-color: var(--primary-color);
 box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
 }

 textarea {
 min-height: 100px;
 resize: vertical;
 }

 label {
 display: block;
 margin-bottom: 0.5rem;
 color: var(--text-primary);
 font-weight: 600;
 font-size: 0.875rem;
 }

 small {
 color: var(--text-secondary);
 font-size: 0.8rem;
 margin-top: 0.25rem;
 display: block;
 }

 /* Upload Area */
 .upload-area {
 border: 2px dashed var(--border-color);
 border-radius: 8px;
 padding: 2rem;
 text-align: center;
 background: var(--gray-50);
 cursor: pointer;
 transition: all 0.2s ease;
 }

 .upload-area:hover {
 border-color: var(--primary-color);
 background: var(--gray-100);
 }

 .upload-icon {
 font-size: 2rem;
 margin-bottom: 0.5rem;
 }

 /* Buttons */
 .btn-primary, .btn-secondary {
 padding: 0.875rem 1.75rem;
 border: none;
 border-radius: 10px;
 font-size: 0.875rem;
 font-weight: 600;
 cursor: pointer;
 transition: all 0.2s ease;
 display: inline-flex;
 align-items: center;
 gap: 0.5rem;
 text-decoration: none;
 }

 .btn-primary {
 background: var(--primary-color);
 color: white;
 box-shadow: var(--shadow-md);
 }

 .btn-primary:hover {
 background: #1d4ed8;
 transform: translateY(-1px);
 }

 .btn-secondary {
 background: var(--gray-100);
 color: var(--text-primary);
 border: 1px solid var(--border-color);
 }

 .btn-secondary:hover {
 background: var(--gray-200);
 }

 .btn-add-export {
 background: var(--warning-color);
 color: white;
 border: none;
 padding: 0.5rem 1rem;
 border-radius: 6px;
 font-size: 0.75rem;
 cursor: pointer;
 transition: all 0.2s ease;
 }

 .btn-view-details {
 background: var(--primary-color);
 color: white;
 border: none;
 padding: 0.5rem 1rem;
 border-radius: 6px;
 font-size: 0.75rem;
 cursor: pointer;
 transition: all 0.2s ease;
 }

 /* Results Table */
 .results-table {
 width: 100%;
 border-collapse: collapse;
 background: white;
 border-radius: 8px;
 overflow: hidden;
 box-shadow: var(--shadow-sm);
 margin-bottom: 2rem;
 }

 .results-table th,
 .results-table td {
 padding: 12px;
 text-align: left;
 border-bottom: 1px solid var(--border-color);
 }

 .results-table th {
 background: var(--gray-50);
 font-weight: 600;
 color: var(--text-primary);
 position: sticky;
 top: 0;
 z-index: 10;
 }

 .results-table tr:hover {
 background: var(--gray-50);
 }

 .score-badge {
 padding: 4px 8px;
 border-radius: 12px;
 font-size: 0.8rem;
 font-weight: 600;
 text-align: center;
 min-width: 60px;
 display: inline-block;
 }

 .score-high { background: #dcfdf7; color: #065f46; }
 .score-medium { background: #dbeafe; color: #1e40af; }
 .score-low { background: #fef3c7; color: #92400e; }

 /* Modal */
 .modal {
 display: none;
 position: fixed;
 z-index: 1000;
 left: 0;
 top: 0;
 width: 100%;
 height: 100%;
 background-color: rgba(0,0,0,0.5);
 }

 .modal-content {
 background-color: white;
 margin: 5% auto;
 padding: 0;
 border-radius: 12px;
 width: 90%;
 max-width: 800px;
 max-height: 80vh;
 overflow-y: auto;
 }

 .modal-header {
 padding: 1.5rem;
 border-bottom: 1px solid var(--border-color);
 display: flex;
 justify-content: space-between;
 align-items: center;
 }

 .modal-body {
 padding: 1.5rem;
 }

 .close {
 color: var(--text-secondary);
 font-size: 28px;
 font-weight: bold;
 cursor: pointer;
 }

 .close:hover {
 color: var(--text-primary);
 }

 /* Checkbox Grid */
 .checkbox-grid {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
 gap: 0.75rem;
 }

 .checkbox-grid label {
 display: flex;
 align-items: center;
 gap: 0.5rem;
 cursor: pointer;
 padding: 0.5rem;
 border-radius: 6px;
 transition: background-color 0.2s;
 }

 .checkbox-grid label:hover {
 background: var(--gray-50);
 }

 /* Ideal Profiles */
 .ideal-profiles {
 display: grid;
 gap: 1.5rem;
 }

 .profile-input {
 border: 1px solid var(--border-color);
 border-radius: 8px;
 padding: 1rem;
 background: var(--gray-50);
 }

 .input-options {
 display: flex;
 gap: 1rem;
 margin-bottom: 1rem;
 }

 .input-options label {
 display: flex;
 align-items: center;
 gap: 0.5rem;
 cursor: pointer;
 font-weight: 400;
 }

 /* Model Selection */
 .model-selection {
 display: grid;
 gap: 0.75rem;
 }

 .model-selection label {
 display: flex;
 align-items: center;
 gap: 0.75rem;
 padding: 1rem;
 border: 1px solid var(--border-color);
 border-radius: 8px;
 cursor: pointer;
 transition: all 0.2s;
 background: white;
 }

 .model-selection label:hover {
 border-color: var(--primary-color);
 background: var(--gray-50);
 }

 /* Progress Bar */
 .progress-bar {
 width: 100%;
 height: 12px;
 background: var(--gray-200);
 border-radius: 6px;
 overflow: hidden;
 margin: 1rem 0;
 }

 .progress-fill {
 height: 100%;
 background: linear-gradient(90deg, var(--primary-color), var(--success-color));
 transition: width 0.3s ease;
 border-radius: 6px;
 }

 /* Summary Cards */
 .results-summary {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
 gap: 1rem;
 margin-bottom: 2rem;
 }

 .summary-card {
 background: white;
 border: 1px solid var(--border-color);
 border-radius: 8px;
 padding: 1.5rem;
 text-align: center;
 box-shadow: var(--shadow-sm);
 }

 .summary-card h3 {
 color: var(--text-secondary);
 font-size: 0.9rem;
 font-weight: 500;
 margin-bottom: 0.5rem;
 }

 .summary-number {
 font-size: 2rem;
 font-weight: 700;
 color: var(--primary-color);
 margin-bottom: 0.25rem;
 }

 .summary-card p {
 color: var(--text-secondary);
 font-size: 0.85rem;
 }

 /* AI Insights */
 .ai-insights-panel {
 background: white;
 border: 1px solid var(--border-color);
 border-radius: 12px;
 padding: 2rem;
 margin: 2rem 0;
 }

 .insights-grid {
 display: grid;
 gap: 1.5rem;
 }

 .insight-section {
 border-bottom: 1px solid var(--border-color);
 padding-bottom: 1.5rem;
 }

 .insight-section:last-child {
 border-bottom: none;
 padding-bottom: 0;
 }

 .insight-list {
 list-style: none;
 display: grid;
 gap: 0.5rem;
 }

 .insight-list li {
 padding: 0.75rem;
 background: var(--gray-50);
 border-radius: 6px;
 font-size: 0.9rem;
 color: var(--text-primary);
 }

 /* Responsive Design */
 @media (max-width: 768px) {
 .container {
 padding: 0;
 }

 .navbar {
 padding: 1rem;
 }

 .nav-tabs {
 flex-wrap: wrap;
 }

 .tab-content {
 padding: 1rem;
 }

 .filter-stats {
 grid-template-columns: 1fr;
 }

 .checkbox-grid {
 grid-template-columns: 1fr;
 }

 .results-summary {
 grid-template-columns: 1fr;
 }

 .results-table {
 font-size: 0.8rem;
 }

 .results-table th,
 .results-table td {
 padding: 8px;
 }
 }

 /* Animations */
 .fade-in {
 animation: fadeIn 0.5s ease-in;
 }

 @keyframes fadeIn {
 from { opacity: 0; transform: translateY(20px); }
 to { opacity: 1; transform: translateY(0); }
 }

 .pulse {
 animation: pulse 2s infinite;
 }

 @keyframes pulse {
 0%, 100% { opacity: 1; }
 50% { opacity: 0.7; }
 }
 
        /* Loading Indicators */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 6px solid #f3f3f3;
            border-top: 6px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-container {
            width: 300px;
            background-color: #f0f0f0;
            border-radius: 10px;
            padding: 3px;
            margin-top: 20px;
        }

        .progress-bar-inner {
            height: 20px;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color));
            border-radius: 8px;
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: 600;
        }

        /* Auto-save Indicators */
        .auto-save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .auto-save-indicator.saving {
            background: var(--warning-color);
            opacity: 1;
        }

        .auto-save-indicator.saved {
            background: var(--success-color);
            opacity: 1;
        }

        .auto-save-indicator.error {
            background: var(--error-color);
            opacity: 1;
        }

        /* Enhanced Filtering Dashboard */
        .filtering-dashboard-enhanced {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .filtering-dashboard-enhanced.show {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .filter-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .filter-stat-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .filter-stat-card .number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .filter-stat-card .label {
            font-size: 0.9rem;
            opacity: 0.9;
            color: #f0f0f0;
        }

        .filter-stat-card .percentage {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 0.25rem;
        }

        /* Navigation Controls */
        .nav-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding: 0 1rem;
        }

        .nav-btn {
            padding: 0.75rem 1.5rem;
            border: 2px solid var(--primary-color);
            background: var(--white);
            color: var(--primary-color);
            cursor: pointer;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: var(--gray-100);
            color: var(--text-secondary);
            border-color: var(--border-color);
        }

        .nav-btn:disabled:hover {
            background: var(--gray-100);
            color: var(--text-secondary);
        }

        /* Save Confirmation */
        .save-confirmation {
            background: var(--success-color);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            display: none;
            animation: fadeInUp 0.3s ease-out;
        }

        .save-confirmation.show {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Enhanced File Upload Area */
        .upload-area-enhanced {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            background: var(--gray-50);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .upload-area-enhanced:hover {
            border-color: var(--primary-color);
            background: var(--gray-100);
            transform: translateY(-2px);
        }

        .upload-area-enhanced.dragover {
            border-color: var(--success-color);
            background: rgba(16, 185, 129, 0.1);
        }

        .upload-area-enhanced.uploading {
            pointer-events: none;
            opacity: 0.7;
        }

        .file-info-enhanced {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            display: none;
        }

        .file-info-enhanced.show {
            display: block;
            animation: fadeInUp 0.3s ease-out;
        }

        /* Real-time Statistics */
        .real-time-stats {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-sm);
        }

        .stats-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--gray-200);
        }

        .stats-row:last-child {
            border-bottom: none;
        }

        .stats-label {
            font-weight: 600;
            color: var(--text-primary);
        }

        .stats-value {
            font-weight: 700;
            color: var(--primary-color);
        }

        /* Enhanced Inputs with Save States */
        .input-container {
            position: relative;
        }

        .input-save-indicator {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .input-save-indicator.saving {
            color: var(--warning-color);
            opacity: 1;
        }

        .input-save-indicator.saved {
            color: var(--success-color);
            opacity: 1;
        }

        /* Tab Progress Indicator */
        .tab-progress {
            width: 100%;
            height: 4px;
            background: var(--gray-200);
            border-radius: 2px;
            margin-top: 0.5rem;
            overflow: hidden;
        }

        .tab-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color));
            width: 33.33%;
            transition: width 0.3s ease;
            border-radius: 2px;
        }

/* API Key Save Indicators */
.api-input-container {
    position: relative;
}

.save-indicator {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    background: var(--success-color);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.7rem;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.save-indicator.show {
    opacity: 1;
}

/* File Upload Enhanced Styles */
.upload-area {
    position: relative;
    border: 2px dashed var(--border-color);
    border-radius: 8px;
    padding: 2rem;
    text-align: center;
    background: var(--gray-50);
    cursor: pointer;
    transition: all 0.3s ease;
}

.upload-area:hover {
    border-color: var(--primary-color);
    background: var(--gray-100);
}

.upload-area.dragover {
    border-color: var(--primary-color);
    background: rgba(37, 99, 235, 0.1);
}

.upload-progress {
    display: none;
    margin-top: 1rem;
}

.progress-bar {
    width: 100%;
    height: 8px;
    background: var(--gray-200);
    border-radius: 4px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: var(--primary-color);
    transition: width 0.3s ease;
    width: 0%;
}

.file-info {
    margin-top: 1rem;
    padding: 1rem;
    background: var(--gray-50);
    border-radius: 8px;
    display: none;
}

.file-preview {
    margin-top: 1rem;
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid var(--border-color);
    border-radius: 8px;
}

.file-preview table {
    width: 100%;
    border-collapse: collapse;
}

.file-preview th,
.file-preview td {
    padding: 8px;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
    font-size: 0.8rem;
}

.file-preview th {
    background: var(--gray-100);
    font-weight: 600;
}

/* Bottom Navigation */
.tab-navigation {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 2rem;
    padding: 1rem 0;
    border-top: 1px solid var(--border-color);
}

.nav-btn {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 8px;
    background: var(--primary-color);
    color: white;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.nav-btn:hover {
    background: #1d4ed8;
    transform: translateY(-1px);
}

.nav-btn:disabled {
    background: var(--gray-300);
    cursor: not-allowed;
    transform: none;
}

.nav-btn.secondary {
    background: var(--gray-200);
    color: var(--text-primary);
}

.nav-btn.secondary:hover {
    background: var(--gray-300);
}

/* Enhanced Filtering Dashboard */
.filtering-dashboard {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 2rem;
    border-radius: 16px;
    margin-bottom: 2rem;
    display: none;
}

.filtering-dashboard.show {
    display: block;
    animation: slideDown 0.5s ease;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.filter-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.filter-stat {
    background: rgba(255, 255, 255, 0.15);
    padding: 1.5rem;
    border-radius: 12px;
    text-align: center;
    backdrop-filter: blur(10px);
}

.filter-stat .number {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
}

.filter-stat .label {
    font-size: 0.875rem;
    opacity: 0.9;
}

/* Success Messages */
.success-message {
    background: var(--success-color);
    color: white;
    padding: 1rem;
    border-radius: 8px;
    margin-top: 1rem;
    display: none;
    animation: slideIn 0.3s ease;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateX(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.success-message.show {
    display: block;
}

/* Sticky Bottom Navigation */
.tab-content {
    min-height: calc(100vh - 200px);
    padding-bottom: 100px; /* Space for fixed navigation */
}

.tab-navigation {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    background: white !important;
    border-top: 2px solid var(--border-color) !important;
    box-shadow: 0 -4px 8px -2px rgba(0, 0, 0, 0.15) !important;
    z-index: 1000 !important;
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 1.2rem 2rem !important;
    margin: 0 !important;
}

.tab-navigation .tab-progress {
    text-align: center;
    flex-grow: 1;
    margin: 0 1rem;
    font-weight: 600;
    color: var(--text-primary);
}

.tab-navigation .nav-btn {
    padding: 0.75rem 1.5rem !important;
    border: none !important;
    border-radius: 8px !important;
    font-weight: 600 !important;
    transition: all 0.3s ease !important;
    cursor: pointer !important;
    min-width: 120px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 0.5rem !important;
}

.tab-navigation .nav-btn:not(.secondary) {
    background: var(--primary-color) !important;
    color: white !important;
}

.tab-navigation .nav-btn.secondary {
    background: var(--gray-200) !important;
    color: var(--text-primary) !important;
}

.tab-navigation .nav-btn:hover:not(:disabled) {
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
}

.tab-navigation .nav-btn:disabled {
    background: var(--gray-300) !important;
    color: var(--gray-500) !important;
    cursor: not-allowed !important;
    transform: none !important;
}

.container {
    padding-bottom: 120px !important;
}

/* Hide duplicate navigations - keep only the last one visible */
.tab-navigation:not(:last-of-type) {
    display: none !important;
}

/* Mobile responsive */
@media (max-width: 768px) {
    .tab-navigation {
        padding: 1rem !important;
        flex-direction: column !important;
        gap: 1rem !important;
    }

    .tab-navigation .nav-btn {
        width: 100% !important;
        max-width: 200px !important;
    }

    .tab-content {
        padding-bottom: 140px !important;
    }
}


/* Enhanced API Input Containers */
.api-input-container {
    position: relative;
}

.save-indicator {
    position: absolute;
    right: 8px;
    top: 28px;
    background: var(--success-color);
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.7rem;
    font-weight: 600;
    opacity: 0;
    transform: translateY(-5px);
    transition: all 0.3s ease;
    pointer-events: none;
    z-index: 100;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
}

.save-indicator.show {
    opacity: 1;
    transform: translateY(0);
}

.save-indicator .save-text {
    display: flex;
    align-items: center;
    gap: 2px;
}

/* Enhanced File Upload Indicators */
.upload-success-banner {
    background: linear-gradient(135deg, var(--success-color), #059669);
    color: white;
    padding: 1rem;
    border-radius: 8px;
    margin-top: 1rem;
    display: none;
    animation: slideInUp 0.5s ease;
}

.upload-success-banner.show {
    display: block;
}

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.file-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
}

.file-stat-item {
    background: var(--gray-50);
    padding: 0.75rem;
    border-radius: 6px;
    text-align: center;
    border: 1px solid var(--border-color);
}

.file-stat-number {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--primary-color);
    margin-bottom: 0.25rem;
}

.file-stat-label {
    font-size: 0.8rem;
    color: var(--text-secondary);
}

</style>
</head>
<body>
    
    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Save Indicator -->
    <div id="saveIndicator" class="save-indicator"> Saving...</div>

    <!-- Export List Indicator -->
    <div id="exportListIndicator" class="export-list-indicator">
         Export List: <span id="exportCount">0</span> items
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div style="text-align: center; color: white;">
            <div class="loading-spinner"></div>
            <div class="progress-container">
                <div id="progressBar" class="progress-bar-inner">0%</div>
            </div>
            <p style="margin-top: 1rem; font-size: 1.1rem;" id="loadingText">Processing...</p>
        </div>
    </div>

    <!-- Auto-save Indicator -->
    <div id="autoSaveIndicator" class="auto-save-indicator">
        <span id="saveText">üíæ Saving...</span>
    </div>

 <!-- Toast Notification -->
 <div id="toast" class="toast"></div>
 
 <!-- Save Indicator -->
 <div id="saveIndicator" class="save-indicator">¬æ Saving...</div>
 
 <!-- Export List Indicator -->
 <div id="exportListIndicator" class="export-list-indicator">
 Export List: <span id="exportCount">0</span> items
 </div>

 <div class="container">
 <!-- Navigation -->
 <nav class="navbar">
 <div class="nav-brand">
 <h1>üéØ Scorely Beta</h1>
 <p>LinkedIn Profile Ranker</p>
 </div>
 <div class="nav-tabs">
                <button class="tab-btn active" data-tab="setup">üîß Setup</button>
                <button class="tab-btn" data-tab="ranking">‚ö° Ranking</button>
                <button class="tab-btn" data-tab="results">üìä Results</button>
                <button class="tab-btn reset-btn" onclick="resetSession()">üîÑ Reset</button>
            </div>
            <div class="tab-progress">
                <div id="tabProgress" class="tab-progress-fill"></div>
            </div>
</nav>

 <!-- Setup Tab -->
 <div id="setup" class="tab-content active">            <!-- Enhanced API Configuration -->
            <div class="section">
                <h2>üîë API Configuration</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="api-input-container">
                        <label for="embeddingApiKey">Embedding API Key:</label>
                        <input type="password" id="embeddingApiKey" placeholder="Optional - uses OpenAI if empty" oninput="handleAutoSave('embeddingApiKey')">
                        <div class="save-indicator" id="embeddingApiKeySaveIndicator">
                            <span class="save-text">üíæ Saved ‚úì</span>
                        </div>
                        <small>Leave empty to use OpenAI for both</small>
                    </div>
                    <div class="api-input-container">
                        <label for="gptApiKey">GPT API Key:</label>
                        <input type="password" id="gptApiKey" placeholder="sk-..." oninput="handleAutoSave('gptApiKey')">
                        <div class="save-indicator" id="gptApiKeySaveIndicator">
                            <span class="save-text">üíæ Saved ‚úì</span>
                        </div>
                        <small>Required for AI-powered ranking</small>
                    </div>
                </div>
            </div>/div>            <!-- File Upload -->
            <div class="section">
                <h2>üìÅ File Upload</h2>
                <div class="upload-area" id="uploadArea" onclick="document.getElementById('csvFile').click()">
                    <input type="file" id="csvFile" accept=".csv" style="display: none;">
                    <div class="upload-icon">üìÑ</div>
                    <p style="color: var(--text-primary); font-weight: 500; margin: 0.5rem 0;">Click to upload CSV file or drag & drop</p>
                    <small style="color: var(--text-secondary);">LinkedIn profiles data</small>
                </div>

                <div class="upload-progress" id="uploadProgress" style="display: none;">
                    <p><strong>üì§ Uploading file...</strong></p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p id="progressText">0%</p>
                </div>

                <div class="upload-success-banner" id="uploadSuccessBanner">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <span style="font-size: 1.2rem;">‚úÖ</span>
                        <strong>File uploaded successfully!</strong>
                    </div>
                    <p>Your CSV file has been processed and is ready for analysis.</p>
                </div>

                <div class="file-info" id="fileInfoSection" style="display: none;">
                    <h4>üìä File Information</h4>
                    <div class="file-stats">
                        <div class="file-stat-item">
                            <div class="file-stat-number" id="fileNameStat">-</div>
                            <div class="file-stat-label">File Name</div>
                        </div>
                        <div class="file-stat-item">
                            <div class="file-stat-number" id="fileSizeStat">-</div>
                            <div class="file-stat-label">File Size</div>
                        </div>
                        <div class="file-stat-item">
                            <div class="file-stat-number" id="totalRowsStat">-</div>
                            <div class="file-stat-label">Total Rows</div>
                        </div>
                        <div class="file-stat-item">
                            <div class="file-stat-number" id="columnsStat">-</div>
                            <div class="file-stat-label">Columns</div>
                        </div>
                    </div>

                    <h4>üìã Detected Columns</h4>
                    <div id="columnsDisplay" style="margin-bottom: 1rem;"></div>

                    <h4>üëÄ Data Preview (First 5 rows)</h4>
                    <div class="file-preview" id="filePreview"></div>
                </div>
            </div>/div>
                        <div class="stats-row">
                            <span class="stats-label">File Size:</span>
                            <span class="stats-value" id="fileSizeStat">-</span>
                        </div>
                        <div class="stats-row">
                            <span class="stats-label">Total Rows:</span>
                            <span class="stats-value" id="totalRowsStat">-</span>
                        </div>
                        <div class="stats-row">
                            <span class="stats-label">Valid Profiles:</span>
                            <span class="stats-value" id="validProfilesStat">-</span>
                        </div>
                        <div class="stats-row">
                            <span class="stats-label">Columns Detected:</span>
                            <span class="stats-value" id="columnsStat">-</span>
                        </div>
                    
            
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="nav-btn secondary" id="prevBtn" onclick="navigateTab(-1)">
                    ‚Üê Previous
                </button>
                <div class="tab-progress">
                    <span id="currentTabInfo">Step 1 of 3</span>
                </div>
                <button class="nav-btn" id="nextBtn" onclick="navigateTab(1)">
                    Next ‚Üí
                </button>
            </div>
                </div>
            </div>            <!-- Enhanced Filtering Dashboard -->
            <div id="filteringDashboardEnhanced" class="filtering-dashboard-enhanced">
                <h3>üîç Real-time Filtering Analysis</h3>
                <p>Live statistics update as you configure blacklist and already-in-process filters</p>
                <div class="filter-stats-grid">
                    <div class="filter-stat-card">
                        <div class="number" id="totalProfilesNum">0</div>
                        <div class="label">Total Profiles</div>
                        <div class="percentage" id="totalProfilesPerc">100%</div>
                    </div>
                    <div class="filter-stat-card">
                        <div class="number" id="blacklistFilteredNum">0</div>
                        <div class="label">Blacklist Filtered</div>
                        <div class="percentage" id="blacklistFilteredPerc">0%</div>
                    </div>
                    <div class="filter-stat-card">
                        <div class="number" id="inProcessFilteredNum">0</div>
                        <div class="label">Already in Process</div>
                        <div class="percentage" id="inProcessFilteredPerc">0%</div>
                    </div>
                    <div class="filter-stat-card">
                        <div class="number" id="remainingForRankingNum">0</div>
                        <div class="label">Ready for Ranking</div>
                        <div class="percentage" id="remainingForRankingPerc">0%</div>
                    </div>
                </div>
                <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 8px;">
                    <p style="margin: 0; font-size: 0.9rem;">
                        üí° <strong>Pro Tip:</strong> The filtering happens in real-time as you type. 
                        All data is automatically saved to your browser's local storage.
                    </p>
                </div>
            </div>
 <div class="filter-stat blacklist">
 <div class="number" id="blacklistFilteredCount">0</div>
 <div class="label">Filtered (Blacklist)</div>
 </div>
 <div class="filter-stat in-process">
 <div class="number" id="inProcessFilteredCount">0</div>
 <div class="label">Filtered (Already in Process)</div>
 </div>
 <div class="filter-stat remaining">
 <div class="number" id="remainingForRankingCount">0</div>
 <div class="label">Ready for Ranking</div>
 </div>
 </div>
 </div>            <!-- Enhanced Blacklist & Already in Process -->
            <div class="section">
                <h2>üö´ Filtering Configuration</h2>
                <div class="real-time-stats" style="margin-bottom: 1.5rem;">
                    <h4 style="margin-bottom: 1rem;">‚ö° Live Filtering Statistics</h4>
                    <div class="stats-row">
                        <span class="stats-label">Total Profiles Loaded:</span>
                        <span class="stats-value" id="liveTotalProfiles">0</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">Blacklist Matches:</span>
                        <span class="stats-value" id="liveBlacklistMatches">0</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">Already in Process:</span>
                        <span class="stats-value" id="liveInProcessMatches">0</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">Available for Ranking:</span>
                        <span class="stats-value" id="liveAvailableProfiles" style="color: var(--success-color);">0</span>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                    <div class="input-container">
                        <label>üö´ Blacklist Companies:</label>
                        <textarea id="blacklistCompanies" placeholder="Company1, Company2, Company3..." rows="4" 
                                  oninput="handleAutoSave('blacklistCompanies'); updateFilteringStats();"></textarea>
                        <small>Comma-separated company names to exclude (auto-saved)</small>
                        <div class="input-save-indicator" id="blacklistSaveIndicator">üíæ</div>
                    </div>
                    <div class="input-container">
                        <label>‚è≥ Already in Process:</label>
                        <textarea id="inProcessCandidates" placeholder="Profile names, emails, or IDs..." rows="4" 
                                  oninput="handleAutoSave('inProcessCandidates'); updateFilteringStats();"></textarea>
                        <small>Candidates currently being processed (auto-saved)</small>
                        <div class="input-save-indicator" id="inProcessSaveIndicator">üíæ</div>
                    </div>
                </div>

                <div style="margin-top: 1.5rem; text-align: center;">
                    <button onclick="applyFiltering()" style="margin-top: 1rem;" class="btn-primary">
                        üîç Apply Filters & Update Dashboard
                    </button>
                </div>
            </div>
 <button onclick="applyFiltering()" style="margin-top: 1rem;" class="btn-primary">
 üîç Apply Filters & Show Summary
 </button>
 </div>            <!-- Enhanced Ideal Candidate Profiles -->
            <div class="section">
                <h2>üéØ Ideal Candidate Profiles</h2>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    ü§ñ Help our AI understand your ideal candidates by providing examples (all data auto-saved)
                </p>
                <div class="ideal-profiles">
                    <div class="profile-input">
                        <h3>üèÜ Ideal Profile #1 (Technical Excellence):</h3>
                        <div class="input-options">
                            <label>
                                <input type="radio" name="profile1" value="pdf" id="p1-pdf">
                                üìÑ Upload PDF
                            </label>
                            <label>
                                <input type="radio" name="profile1" value="text" id="p1-text" checked>
                                üìù Copy & Paste Profile
                            </label>
                        </div>
                        <input type="file" id="profile1File" accept=".pdf" style="display: none;" onchange="handleIdealProfileSave(1, 'file')">
                        <div class="input-container">
                            <textarea id="profile1Text" placeholder="Paste LinkedIn profile (Ctrl+A from LinkedIn)..." rows="4" 
                                      oninput="handleAutoSave('profile1Text'); handleIdealProfileSave(1, 'text');"></textarea>
                            <div class="input-save-indicator" id="profile1SaveIndicator">üíæ</div>
                        </div>
                        <small>üí° This profile will be used as a benchmark for technical excellence</small>
                        <div id="profile1Confirmation" class="save-confirmation">
                            ‚úÖ <strong>Profile #1 Saved!</strong> Technical excellence benchmark updated.
                        </div>
                    </div>

                    <div class="profile-input">
                        <h3>ü§ù Ideal Profile #2 (Cultural Fit):</h3>
                        <div class="input-options">
                            <label>
                                <input type="radio" name="profile2" value="pdf" id="p2-pdf">
                                üìÑ Upload PDF
                            </label>
                            <label>
                                <input type="radio" name="profile2" value="text" id="p2-text" checked>
                                üìù Copy & Paste Profile
                            </label>
                        </div>
                        <input type="file" id="profile2File" accept=".pdf" style="display: none;" onchange="handleIdealProfileSave(2, 'file')">
                        <div class="input-container">
                            <textarea id="profile2Text" placeholder="Paste LinkedIn profile (Ctrl+A from LinkedIn)..." rows="4" 
                                      oninput="handleAutoSave('profile2Text'); handleIdealProfileSave(2, 'text');"></textarea>
                            <div class="input-save-indicator" id="profile2SaveIndicator">üíæ</div>
                        </div>
                        <small>üí° This profile will be used as a benchmark for cultural fit</small>
                        <div id="profile2Confirmation" class="save-confirmation">
                            ‚úÖ <strong>Profile #2 Saved!</strong> Cultural fit benchmark updated.
                        </div>
                    </div>
                </div>
            </div>            <!-- Enhanced Job Description -->
            <div class="section">
                <h2>üíº Job Description</h2>
                <div class="input-container">
                    <textarea id="jobDesc" placeholder="Describe the position, required skills, ideal candidate profile, company culture, and any specific requirements..." rows="6" 
                              oninput="handleAutoSave('jobDesc');"></textarea>
                    <div class="input-save-indicator" id="jobDescSaveIndicator">üíæ</div>
                </div>
                <small>Be as detailed as possible - this helps the AI understand what you're looking for (auto-saved)</small>
            </div>

 <!-- Additional Filters -->
 <div class="section">
 <h2>üéØ Additional Filters</h2>
 <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
 <div>
 <label>Education Level:</label>
 <select id="educationLevel">
 <option value="">Any Education Level</option>
 <option value="high-school">High School</option>
 <option value="associate">Associate Degree</option>
 <option value="bachelor">Bachelor's Degree</option>
 <option value="master">Master's Degree</option>
 <option value="phd">PhD/Doctorate</option>
 </select>
 </div>
 <div>
 <label>Location:</label>
 <input type="text" id="location" placeholder="e.g. Tel Aviv, Remote, etc.">
 </div>
 </div>
 </div>

 <!-- Leadership Experience -->
 <div class="section">
 <h2>üë• Leadership Experience</h2>
 <div class="checkbox-grid">
 <label>
 <input type="checkbox" id="team-lead">
 üë• Team Lead
 </label>
 <label>
 <input type="checkbox" id="manager">
 Manager
 </label>
 <label>
 <input type="checkbox" id="executive">
 üéØ Executive (VP/C-level)
 </label>
 </div>
 </div>

 <!-- Key Achievements -->
 <div class="section">
 <h2>üîë Key Achievements (Keywords)</h2>
 <textarea id="keyAchievements" placeholder="e.g. scaled, launched, improved, reduced costs by 40%, increased revenue, led architecture redesign, implemented CI/CD, grew team by 200%..." rows="3"></textarea>
 <small>üìù Examples: grew team by 200%, increased revenue, reduced costs by 40%, launched product</small>
 <br><br>
 <label>Additional Keywords:</label>
 <textarea id="additionalKeywords" placeholder="Any other important keywords..." rows="2"></textarea>
 </div>

 <!-- AI Ranking Enhancement -->
 <div class="section">
 <h2> AI Ranking Enhancement</h2>
 <p style="color: var(--text-secondary); margin-bottom: 1rem;">
   AI Understanding: Our model will analyze profiles for indicators of excellence.
 </p>
 <label>Provide specific instructions to improve the AI's ranking accuracy:</label>
 <textarea id="aiInstructions" placeholder='Example: "Prioritize candidates who have worked with large-scale systems"' rows="4"></textarea>
 
 <div style="margin-top: 1rem;">
 <label>Focus Areas:</label>
 <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 0.5rem;">
 <div style="display: flex; gap: 1rem;">
 <label style="display: flex; align-items: center; gap: 0.5rem;">
 <input type="radio" name="focus" value="innovation">
 üí° Innovation focus
 </label>
 <label style="display: flex; align-items: center; gap: 0.5rem;">
 <input type="radio" name="focus" value="initiative">
 üéØ Initiative focus
 </label>
 </div>
 <div style="display: flex; gap: 1rem;">
 <label style="display: flex; align-items: center; gap: 0.5rem;">
 <input type="radio" name="focus" value="top-company">
 üè¢ Top company focus
 </label>
 <label style="display: flex; align-items: center; gap: 0.5rem;">
 <input type="radio" name="focus" value="career-growth">
 üìà Career growth focus
 </label>
 </div>
 </div>
 </div>
 </div>

 <!-- Model Configuration -->
 <div class="section">
 <h2> AI Model Configuration</h2>
 <div class="model-selection">
 <label>
 <input type="radio" name="model" value="hybrid" checked>
 <div>
 üéØ Hybrid (Recommended) - 30% Embedding + 70% GPT-4
 <br><small style="color: var(--text-secondary);">Best balance of speed and accuracy</small>
 </div>
 </label>
 <label>
 <input type="radio" name="model" value="embedding">
 <div>
 ‚ö° Embedding Only - Fast and cost-effective
 <br><small style="color: var(--text-secondary);">Good for initial screening</small>
 </div>
 </label>
 <label>
 <input type="radio" name="model" value="gpt4">
 <div>
   GPT-4 Only - Highest quality analysis
 <br><small style="color: var(--text-secondary);">Most thorough but slower</small>
 </div>
 </label>
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="nav-btn secondary" id="prevBtn" onclick="navigateTab(-1)">
                    ‚Üê Previous
                </button>
                <div class="tab-progress">
                    <span id="currentTabInfo">Step 1 of 3</span>
                </div>
                <button class="nav-btn" id="nextBtn" onclick="navigateTab(1)">
                    Next ‚Üí
                </button>
            </div>
 </div>
 </div>

 <!-- Start Button -->
 <div class="section" style="text-align: center;">
 <button class="btn-primary" onclick="startRanking()" style="font-size: 1rem; padding: 1rem 2rem;">
 üöÄ Start Ranking Process
 </button>
 </div>
 </div>

 <!-- Ranking Tab -->
 <div id="ranking" class="tab-content">
 <div style="text-align: center; max-width: 600px; margin: 0 auto;">
 <h2>‚ö° AI Ranking in Progress</h2>
 
 <!-- Previous Rankings Impact -->
 <div id="feedbackImpactSection" class="section" style="display: none;">
 <h3>üîÑ Feedback Impact on Previous Rankings</h3>
 <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;">
 <div style="background: var(--gray-50); padding: 1rem; border-radius: 6px;">
 <strong>Before Feedback:</strong><br>
 <span id="beforeStats">23 TOP, 19 GOOD candidates</span>
 </div>
 <div style="background: var(--success-color); color: white; padding: 1rem; border-radius: 6px;">
 <strong>After Feedback:</strong><br>
 <span id="afterStats">31 TOP, 24 GOOD candidates</span>
 </div>
 </div>
 <p style="color: var(--success-color); font-weight: 500;">‚úÖ Feedback successfully applied to previous rankings!</p>
 </div>

 <!-- Batch Configuration -->
 <div class="section">
 <h3>üìä Batch Configuration</h3>
 <div style="background: white; border: 1px solid var(--border-color); border-radius: 12px; padding: 2rem;">
 <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin: 1rem 0;">
 <div>
 <label>From Row:</label>
 <input type="number" id="fromRow" value="2" min="2">
 </div>
 <div>
 <label>To Row:</label>
 <input type="number" id="toRow" value="51" min="2">
 </div>
 <div>
 <label>Batch Size:</label>
 <select id="batchSize">
 <option value="20">20 profiles</option>
 <option value="50" selected>50 profiles</option>
 <option value="100">100 profiles</option>
 </select>
 </div>
 </div>
 
 <div class="progress-bar">
 <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
 </div>
 <p>Progress: <span id="progressText">0%</span></p>
 </div>
 </div>

 <!-- Controls -->
 <div style="display: flex; gap: 1rem; justify-content: center; margin: 2rem 0;">
 <button class="btn-secondary" onclick="pauseRanking()">√¢¬è¬∏√Ø¬∏¬è Pause</button>
 <button class="btn-primary" onclick="continueRanking()">‚ñ∂ Continue</button>
 <button class="btn-secondary" onclick="stopRanking()">√¢¬è¬π√Ø¬∏¬è Stop</button>
 </div>

 <!-- Feedback Section -->
 <div class="section">
 <h3>üìù Provide Feedback</h3>
 <p style="color: var(--text-secondary); margin-bottom: 1rem;">
 Your feedback will improve future batches and can be applied to previous rankings.
 </p>
 <textarea id="feedbackText" placeholder="Example: 'Give more weight to startup experience over enterprise experience.'" rows="4"></textarea>
 
 <div style="margin: 1rem 0;">
 <label style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem;">
 <input type="checkbox" id="applyToPrevious"> Apply to previous rankings
 </label>
 </div>
 
 <button onclick="applyFeedback()" class="btn-primary">
 üí° Apply Feedback
 </button>
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="nav-btn secondary" id="prevBtn" onclick="navigateTab(-1)">
                    ‚Üê Previous
                </button>
                <div class="tab-progress">
                    <span id="currentTabInfo">Step 1 of 3</span>
                </div>
                <button class="nav-btn" id="nextBtn" onclick="navigateTab(1)">
                    Next ‚Üí
                </button>
            </div>
 </div>
 </div>
 
            

 <!-- Results Tab -->
 <div id="results" class="tab-content">
 <!-- Results Header -->
 <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;">
 <h2>üìä Ranking Results</h2>
 <div style="display: flex; gap: 1rem;">
 <button class="btn-primary" onclick="exportCandidates()"> Export CSV (Score √¢¬â¬•60)</button>
 <button class="btn-secondary" onclick="exportInsights()">üìÑ Export AI Insights</button>
 <button class="btn-secondary" onclick="exportCustomList()" id="exportCustomBtn" style="display: none;"> Export Custom List (<span id="customExportCount">0</span>)</button>
 </div>
 </div>

 <!-- Summary Cards -->
 <div class="results-summary">
 <div class="summary-card">
 <h3>üèÜ TOP Candidates</h3>
 <div class="summary-number">23</div>
 <p>75-100 score</p>
 </div>
 <div class="summary-card">
 <h3>‚úÖ GOOD Candidates</h3>
 <div class="summary-number">19</div>
 <p>60-74 score</p>
 </div>
 <div class="summary-card">
 <h3>üíé Hidden Gems</h3>
 <div class="summary-number">3</div>
 <p>Special cases</p>
 </div>
 <div class="summary-card">
 <h3> Average</h3>
 <div class="summary-number">45</div>
 <p>Below 60 score</p>
 </div>
 </div>

 <!-- TOP Candidates Table -->
 <div class="section">
 <h2>üèÜ TOP Candidates (75-100)</h2>
 <table class="results-table">
 <thead>
 <tr>
 <th>Name</th>
 <th>Company</th>
 <th>Position</th>
 <th>Overall Score</th>
 <th>Embedding Score</th>
 <th>Category</th>
 <th>Actions</th>
 </tr>
 </thead>
 <tbody>
 <tr>
 <td><strong>Alex Semyzhonov</strong></td>
 <td>Inetex LTD</td>
 <td>Full Stack Developer</td>
 <td><span class="score-badge score-high">87/100</span></td>
 <td><span class="score-badge score-high">89/100</span></td>
 <td><span style="background: #dcfdf7; color: #065f46; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">üèÜ TOP</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('alex-semyzhonov')">üëÅ√Ø¬∏¬è View Details</button>
 <a href="https://linkedin.com/in/alex-semyzhonov" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Dror Reshef</strong></td>
 <td>SuperCom</td>
 <td>Full-stack Developer</td>
 <td><span class="score-badge score-high">82/100</span></td>
 <td><span class="score-badge score-high">85/100</span></td>
 <td><span style="background: #dcfdf7; color: #065f46; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">üèÜ TOP</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('dror-reshef')">üëÅ√Ø¬∏¬è View Details</button>
 <a href="https://linkedin.com/in/dror-reshef-1a9533a" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Tomer Landesman</strong></td>
 <td>env0</td>
 <td>Fullstack Software Engineer</td>
 <td><span class="score-badge score-high">79/100</span></td>
 <td><span class="score-badge score-high">83/100</span></td>
 <td><span style="background: #dcfdf7; color: #065f46; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">üèÜ TOP</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('tomer-landesman')">üëÅ√Ø¬∏¬è View Details</button>
 <a href="https://linkedin.com/in/tomerlm" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 </tbody>
 </table>
 </div>

 <!-- GOOD Candidates Table -->
 <div class="section">
 <h2>‚úÖ GOOD Candidates (60-74)</h2>
 <table class="results-table">
 <thead>
 <tr>
 <th>Name</th>
 <th>Company</th>
 <th>Position</th>
 <th>Overall Score</th>
 <th>Embedding Score</th>
 <th>Category</th>
 <th>Actions</th>
 </tr>
 </thead>
 <tbody>
 <tr>
 <td><strong>Aviram Shubeili</strong></td>
 <td>Philips</td>
 <td>Software Engineer</td>
 <td><span class="score-badge score-medium">71/100</span></td>
 <td><span class="score-badge score-medium">74/100</span></td>
 <td><span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">‚úÖ GOOD</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('aviram-shubeili')">üëÅ√Ø¬∏¬è View Details</button>
 <a href="https://linkedin.com/in/aviram-shubeili" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Leon Kannanovich</strong></td>
 <td>Sapiens Decision</td>
 <td>Full Stack Developer</td>
 <td><span class="score-badge score-medium">68/100</span></td>
 <td><span class="score-badge score-medium">70/100</span></td>
 <td><span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">‚úÖ GOOD</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('leon-kannanovich')">üëÅ√Ø¬∏¬è View Details</button>
 <a href="https://linkedin.com/in/leon-kannanovich-414a64120" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 </tbody>
 </table>
 </div>

 <!-- Hidden Gems Table -->
 <div class="section">
 <h2>üíé Hidden Gems</h2>
 <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
 Candidates with overall lower scores but exceptional qualities in specific areas.
 </p>
 <table class="results-table">
 <thead>
 <tr>
 <th>Name</th>
 <th>Company</th>
 <th>Position</th>
 <th>Overall Score</th>
 <th>Embedding Score</th>
 <th>Best Quality</th>
 <th>Actions</th>
 </tr>
 </thead>
 <tbody>
 <tr>
 <td><strong>Israel Zanani</strong></td>
 <td>Harel Insurance</td>
 <td>Full Stack Engineer</td>
 <td><span class="score-badge score-low">58/100</span></td>
 <td><span class="score-badge score-medium">65/100</span></td>
 <td><span style="background: #dcfdf7; color: #065f46; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem;">Technical: 82/100</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('israel-zanani')">üëÅ√Ø¬∏¬è View Details</button>
 <button class="btn-add-export" onclick="addToExportList('israel-zanani')"> Add to Export</button>
 <a href="https://linkedin.com/in/israel-zanani-b7aa1a134" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Michal Dan</strong></td>
 <td>Bringg</td>
 <td>Senior Frontend Developer</td>
 <td><span class="score-badge score-low">55/100</span></td>
 <td><span class="score-badge score-medium">62/100</span></td>
 <td><span style="background: #dcfdf7; color: #065f46; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem;">Technical: 88/100</span></td>
 <td>
 <button class="btn-view-details" onclick="showCandidateDetails('michal-dan')">üëÅ√Ø¬∏¬è View Details</button>
 <button class="btn-add-export" onclick="addToExportList('michal-dan')"> Add to Export</button>
 <a href="https://linkedin.com/in/michal-dan-639983a7" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 </tbody>
 </table>
 </div>

 <!-- Insufficient Data Table -->
 <div class="section">
 <h2>√¢¬ì Profiles with Insufficient Data</h2>
 <p style="color: var(--text-secondary); margin-bottom: 1rem;">
 Profiles that couldn't be properly ranked due to missing information.
 </p>
 <table class="results-table">
 <thead>
 <tr>
 <th>Name</th>
 <th>Company</th>
 <th>Position</th>
 <th>Reason</th>
 <th>Actions</th>
 </tr>
 </thead>
 <tbody>
 <tr>
 <td><strong>Stav A.</strong></td>
 <td>ControlUp</td>
 <td>Full Stack Developer</td>
 <td><small>Limited job description and skills information</small></td>
 <td>
 <button class="btn-add-export" onclick="addToExportList('stav-a')"> Add to Export</button>
 <a href="https://linkedin.com/in/stavab" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Vakho Baratashvili</strong></td>
 <td>VFR</td>
 <td>Senior Software Engineer</td>
 <td><small>Incomplete education and experience data</small></td>
 <td>
 <button class="btn-add-export" onclick="addToExportList('vakho-baratashvili')"> Add to Export</button>
 <a href="https://linkedin.com/in/vakho-baratashvili-05895b55" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 <tr>
 <td><strong>Luba Epshtein</strong></td>
 <td>bolt</td>
 <td>Full Stack Developer</td>
 <td><small>Missing detailed technical skills information</small></td>
 <td>
 <button class="btn-add-export" onclick="addToExportList('luba-epshtein')"> Add to Export</button>
 <a href="https://linkedin.com/in/luba-epshtein-2aa0bb164" target="_blank" style="margin-left: 0.5rem; color: var(--primary-color); text-decoration: none;"> LinkedIn</a>
 </td>
 </tr>
 </tbody>
 </table>
 </div>

 <!-- Smart AI Insights -->
 <div class="ai-insights-panel">
 <h2>  Smart AI Engine Insights</h2>
 
 <div class="insights-grid">
 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">üìà Common Success Patterns</h3>
 <div class="insight-list">
 <li>üíº <strong>Company Background:</strong> 78% come from tech companies with 50+ employees</li>
 <li>üéì <strong>Education:</strong> 85% have Computer Science or related degrees</li>
 <li>üöÄ <strong>Career Progression:</strong> Average 2.3 promotions in last 5 years</li>
 <li>‚ö° <strong>Tech Stack:</strong> React + Node.js combination appears in 67% of top candidates</li>
 <li>üèÜ <strong>Excellence Indicators:</strong> 42% show at least one excellence marker</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">üè¢ Top Companies for Talent</h3>
 <div class="insight-list">
 <li> <strong>Technion Alumni:</strong> Average score 84/100 (3 candidates)</li>
 <li> <strong>env0:</strong> Average score 79/100 (1 candidate)</li>
 <li> <strong>SuperCom:</strong> Average score 82/100 (1 candidate)</li>
 <li>üèÜ <strong>Tel Aviv University:</strong> Average score 78/100 (2 candidates)</li>
 <li>üìä <strong>EPAM Systems:</strong> Good technical foundation (1 candidate)</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">üîç Recommended Searches</h3>
 <div class="insight-list">
 <li>üéØ "Search for Senior Full Stack developers from Technion with React experience"</li>
 <li>üéØ "Look for env0 alumni with Infrastructure as Code background"</li>
 <li>üéØ "Find Tel Aviv University CS graduates in fintech companies"</li>
 <li>üéØ "Search for developers with military technology unit experience"</li>
 <li>üéØ "Look for React + Spring Boot specialists in Israeli startups"</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">üìä Skills Gap Analysis</h3>
 <div class="insight-list">
 <li>‚ö†√Ø¬∏¬è <strong>DevOps Skills:</strong> Only 23% show strong CI/CD experience</li>
 <li>‚ö†√Ø¬∏¬è <strong>Cloud Platforms:</strong> AWS experience varies significantly</li>
 <li>‚ö†√Ø¬∏¬è <strong>Testing:</strong> Limited automated testing mentions</li>
 <li>‚ö†√Ø¬∏¬è <strong>Leadership:</strong> 34% show clear leadership progression</li>
 <li>‚ö†√Ø¬∏¬è <strong>Startup Experience:</strong> 28% have fast-growth company background</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">üó∫√Ø¬∏¬è Geographic Distribution</h3>
 <div class="insight-list">
 <li>üìç <strong>Tel Aviv District:</strong> 67% of TOP candidates (highest concentration)</li>
 <li>üìç <strong>Haifa District:</strong> 22% of TOP candidates (strong technical focus)</li>
 <li>üìç <strong>Center District:</strong> 11% of TOP candidates</li>
 <li>üìç <strong>Remote Work:</strong> 78% mention remote-friendly experience</li>
 <li>üìç <strong>Relocation:</strong> 34% open to location changes</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">üìà Career Trajectory Analysis</h3>
 <div class="insight-list">
 <li>‚è±√Ø¬∏¬è <strong>Promotion Speed:</strong> Top candidates average 18 months per promotion</li>
 <li>üîÑ <strong>Job Stability:</strong> Average 2.8 years per position (healthy progression)</li>
 <li>üìö <strong>Continuous Learning:</strong> 67% show recent skill acquisitions</li>
 <li>üöÄ <strong>Startup Transition:</strong> 45% moved from enterprise to startup environments</li>
 <li>üíº <strong>Role Evolution:</strong> 78% show clear specialization development</li>
 </div>
 </div>

 <div class="insight-section">
 <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">‚úÖ Action Items</h3>
 <div class="insight-list">
 <li>üéØ <strong>Priority Outreach:</strong> Contact TOP candidates within 48 hours</li>
 <li>üîç <strong>Extended Search:</strong> Look for more Technion and TAU CS graduates</li>
 <li>üìû <strong>Company Referrals:</strong> Ask current team for env0 and SuperCom connections</li>
 <li>üí° <strong>Skill Development:</strong> Consider DevOps training for good technical candidates</li>
 <li>üåü <strong>Hidden Gems Review:</strong> Schedule calls with identified hidden gems</li>
 </div>
 </div>
 </div>
 </div>
 
            
 </div>

 <!-- Modal for Candidate Details -->
 <div id="candidateModal" class="modal">
 <div class="modal-content">
 <div class="modal-header">
 <h2 id="modalCandidateName">Candidate Details</h2>
 <span class="close" onclick="closeCandidateModal()">&times;</span>
 </div>
 <div class="modal-body" id="modalCandidateBody">
 <!-- Candidate details will be inserted here -->
 </div>
 </div>
 </div>

 <!-- PapaParse Library -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js">
    // Global variables for file data and application state
    let uploadedFileData = null;
    let filteredData = null;
    let currentTab = 0;
    const tabs = ['setup', 'ranking', 'results'];
    const tabNames = ['Setup', 'Ranking', 'Results'];

    // Enhanced Navigation Functions
    function navigateTab(direction) {
        const newTab = currentTab + direction;
        if (newTab >= 0 && newTab < tabs.length) {
            // Hide current tab
            document.getElementById(tabs[currentTab]).classList.remove('active');
            document.querySelector(`[data-tab="${tabs[currentTab]}"]`).classList.remove('active');

            // Show new tab
            currentTab = newTab;
            document.getElementById(tabs[currentTab]).classList.add('active');
            document.querySelector(`[data-tab="${tabs[currentTab]}"]`).classList.add('active');

            // Update navigation buttons
            updateNavigationButtons();
            updateTabInfo();
        }
    }

    function updateNavigationButtons() {
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        if (prevBtn && nextBtn) {
            prevBtn.disabled = currentTab === 0;
            nextBtn.disabled = currentTab === tabs.length - 1;

            // Update button text based on current tab
            if (currentTab === tabs.length - 1) {
                nextBtn.style.display = 'none';
            } else {
                nextBtn.style.display = 'flex';
            }
        }
    }

    function updateTabInfo() {
        const tabInfo = document.getElementById('currentTabInfo');
        if (tabInfo) {
            tabInfo.textContent = `Step ${currentTab + 1} of ${tabs.length}: ${tabNames[currentTab]}`;
        }
    }

    // API Key Save Functionality
    function setupApiKeySaving() {
        const embeddingApiKey = document.getElementById('embeddingApiKey');
        const gptApiKey = document.getElementById('gptApiKey');

        // Load saved values on page load
        if (embeddingApiKey) {
            const savedEmbedding = localStorage.getItem('embeddingApiKey');
            if (savedEmbedding) {
                embeddingApiKey.value = savedEmbedding;
                showEnhancedSaveIndicator('embeddingApiKeySaveIndicator');
            }
        }

        if (gptApiKey) {
            const savedGpt = localStorage.getItem('gptApiKey');
            if (savedGpt) {
                gptApiKey.value = savedGpt;
                showEnhancedSaveIndicator('gptApiKeySaveIndicator');
            }
        }
    }

    function saveApiKey(keyName, value) {
        localStorage.setItem(keyName, value);
    }

    function showSaveIndicator(indicatorId) {
        const indicator = document.getElementById(indicatorId);
        if (indicator) {
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }
    }

    // Enhanced File Upload Functionality
    function setupFileUpload() {
        const fileInput = document.getElementById('csvFile');
        const uploadArea = document.getElementById('uploadArea');

        if (fileInput && uploadArea) {
            // Drag and drop functionality
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    enhancedHandleFileUpload(files[0]);
                }
            });

            fileInput.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    enhancedHandleFileUpload(e.target.files[0]);
                }
            });
        }
    }

    function handleFileUpload(file) {
        if (!file.name.toLowerCase().endsWith('.csv')) {
            showToast('Please upload a CSV file only', 'error');
            return;
        }

        // Show progress
        const progressDiv = document.getElementById('uploadProgress');
        const progressFill = document.getElementById('progressFill');
        const successMessage = document.getElementById('uploadSuccess');

        if (progressDiv) progressDiv.style.display = 'block';
        if (successMessage) successMessage.classList.remove('show');

        // Simulate progress
        let progress = 0;
        const progressInterval = setInterval(() => {
            progress += 10;
            if (progressFill) progressFill.style.width = progress + '%';

            if (progress >= 100) {
                clearInterval(progressInterval);
                setTimeout(() => {
                    parseCSVFile(file);
                }, 500);
            }
        }, 100);
    }

    function parseCSVFile(file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const csv = e.target.result;
            const lines = csv.split('\n');
            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));

            // Parse data
            const data = [];
            for (let i = 1; i < lines.length && i < 1000; i++) { // Limit to 1000 rows for performance
                if (lines[i].trim()) {
                    const row = lines[i].split(',').map(cell => cell.trim().replace(/"/g, ''));
                    if (row.length === headers.length) {
                        const rowObj = {};
                        headers.forEach((header, index) => {
                            rowObj[header] = row[index];
                        });
                        data.push(rowObj);
                    }
                }
            }

            uploadedFileData = {
                filename: file.name,
                size: formatFileSize(file.size),
                totalRows: lines.length - 1,
                headers: headers,
                data: data
            };

            displayFileInfo();
            hideProgress();
            showSuccess();
            enableFiltering();
        };
        reader.readAsText(file);
    }

    function displayFileInfo() {
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const fileRows = document.getElementById('fileRows');
        const fileColumns = document.getElementById('fileColumns');
        const filePreview = document.getElementById('filePreview');

        if (fileInfo && uploadedFileData) {
            fileInfo.style.display = 'block';

            if (fileName) fileName.textContent = uploadedFileData.filename;
            if (fileSize) fileSize.textContent = uploadedFileData.size;
            if (fileRows) fileRows.textContent = uploadedFileData.totalRows.toLocaleString();

            // Display columns
            if (fileColumns) {
                fileColumns.innerHTML = uploadedFileData.headers.map(header => 
                    `<span style="display: inline-block; background: var(--gray-100); padding: 4px 8px; margin: 2px; border-radius: 4px; font-size: 0.8rem;">${header}</span>`
                ).join('');
            }

            // Display preview
            if (filePreview && uploadedFileData.data.length > 0) {
                const previewData = uploadedFileData.data.slice(0, 5);
                let tableHTML = '<table><thead><tr>';
                uploadedFileData.headers.forEach(header => {
                    tableHTML += `<th>${header}</th>`;
                });
                tableHTML += '</tr></thead><tbody>';

                previewData.forEach(row => {
                    tableHTML += '<tr>';
                    uploadedFileData.headers.forEach(header => {
                        tableHTML += `<td>${row[header] || ''}</td>`;
                    });
                    tableHTML += '</tr>';
                });
                tableHTML += '</tbody></table>';
                filePreview.innerHTML = tableHTML;
            }
        }
    }

    function hideProgress() {
        const progressDiv = document.getElementById('uploadProgress');
        if (progressDiv) {
            setTimeout(() => {
                progressDiv.style.display = 'none';
            }, 500);
        }
    }

    function showSuccess() {
        const successMessage = document.getElementById('uploadSuccess');
        if (successMessage) {
            successMessage.classList.add('show');
        }
    }

    function enableFiltering() {
        const applyButton = document.querySelector('button[onclick="applyFiltering()"]');
        if (applyButton) {
            applyButton.disabled = false;
            applyButton.textContent = 'üîç Apply Filters & Show Summary';
        }
    }

    function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    // Enhanced Apply Filtering Function
    function applyFiltering() {
        if (!uploadedFileData) {
            showToast('Please upload a CSV file first', 'error');
            return;
        }

        const blacklistText = document.getElementById('blacklistCompanies').value.trim();
        const inProcessText = document.getElementById('inProcessCandidates').value.trim();

        const blacklistCompanies = blacklistText ? blacklistText.split(',').map(c => c.trim().toLowerCase()) : [];
        const inProcessCandidates = inProcessText ? inProcessText.split(',').map(c => c.trim().toLowerCase()) : [];

        // Apply filtering
        let filteredByBlacklist = 0;
        let filteredByInProcess = 0;

        filteredData = uploadedFileData.data.filter(row => {
            // Check company blacklist
            const company = (row.Company || row.company || '').toLowerCase();
            if (blacklistCompanies.some(bc => company.includes(bc))) {
                filteredByBlacklist++;
                return false;
            }

            // Check already in process
            const name = (row.Name || row.name || row['Full Name'] || '').toLowerCase();
            if (inProcessCandidates.some(ip => name.includes(ip))) {
                filteredByInProcess++;
                return false;
            }

            return true;
        });

        // Update dashboard
        updateFilteringDashboard(uploadedFileData.totalRows, filteredByBlacklist, filteredByInProcess, filteredData.length);

        showToast('Filtering applied successfully!', 'success');
    }

    function updateFilteringDashboard(total, blacklisted, inProcess, remaining) {
        const dashboard = document.getElementById('filteringDashboard');
        const totalCount = document.getElementById('totalRowsCount');
        const blacklistCount = document.getElementById('blacklistFilteredCount');
        const inProcessCount = document.getElementById('inProcessFilteredCount');
        const remainingCount = document.getElementById('remainingForRankingCount');

        if (dashboard) {
            dashboard.classList.add('show');
        }

        if (totalCount) totalCount.textContent = total.toLocaleString();
        if (blacklistCount) blacklistCount.textContent = blacklisted.toLocaleString();
        if (inProcessCount) inProcessCount.textContent = inProcess.toLocaleString();
        if (remainingCount) remainingCount.textContent = remaining.toLocaleString();
    }

    // Toast notification function
    function showToast(message, type = 'info') {
        const toast = document.getElementById('toast');
        if (toast) {
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    }

    // Initialize everything when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        setupApiKeySaving();
        setupFileUpload();
        updateNavigationButtons();
        updateTabInfo();

        // Set up tab switching
        document.querySelectorAll('.tab-btn').forEach((btn, index) => {
            btn.addEventListener('click', function() {
                currentTab = index;
                updateNavigationButtons();
                updateTabInfo();
            });
        });
    });

    </script>
 
 
    <script>
    // Enhanced API Key Auto-Save Functionality
    function handleAutoSave(keyName) {
        const input = document.getElementById(keyName);
        const indicatorId = keyName + 'SaveIndicator';

        if (input && input.value.trim()) {
            // Save to localStorage
            localStorage.setItem(keyName, input.value);

            // Show save indicator
            showEnhancedSaveIndicator(indicatorId);

            // Auto-hide after 2 seconds
            setTimeout(() => {
                hideEnhancedSaveIndicator(indicatorId);
            }, 2000);
        }
    }

    function showEnhancedSaveIndicator(indicatorId) {
        const indicator = document.getElementById(indicatorId);
        if (indicator) {
            indicator.classList.add('show');
        }
    }

    function hideEnhancedSaveIndicator(indicatorId) {
        const indicator = document.getElementById(indicatorId);
        if (indicator) {
            indicator.classList.remove('show');
        }
    }

    // Enhanced File Upload Handler
    function enhancedHandleFileUpload(file) {
        if (!file.name.toLowerCase().endsWith('.csv')) {
            showToast('Please upload a CSV file only', 'error');
            return;
        }

        // Show progress
        const progressDiv = document.getElementById('uploadProgress');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const successBanner = document.getElementById('uploadSuccessBanner');
        const fileInfoSection = document.getElementById('fileInfoSection');

        // Reset and show progress
        if (progressDiv) progressDiv.style.display = 'block';
        if (successBanner) successBanner.classList.remove('show');
        if (fileInfoSection) fileInfoSection.style.display = 'none';

        // Animate progress
        let progress = 0;
        const progressInterval = setInterval(() => {
            progress += Math.random() * 15 + 5; // Random increment between 5-20
            if (progress > 95) progress = 95;

            if (progressFill) progressFill.style.width = progress + '%';
            if (progressText) progressText.textContent = Math.round(progress) + '%';

            if (progress >= 95) {
                clearInterval(progressInterval);
                // Complete the upload
                setTimeout(() => {
                    completeFileUpload(file);
                }, 500);
            }
        }, 100);
    }

    function completeFileUpload(file) {
        const progressDiv = document.getElementById('uploadProgress');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');

        // Complete progress
        if (progressFill) progressFill.style.width = '100%';
        if (progressText) progressText.textContent = '100%';

        // Hide progress after a moment
        setTimeout(() => {
            if (progressDiv) progressDiv.style.display = 'none';

            // Parse the file
            parseAndDisplayCSV(file);
        }, 800);
    }

    function parseAndDisplayCSV(file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const csv = e.target.result;
                const lines = csv.split('\n').filter(line => line.trim());

                if (lines.length < 2) {
                    showToast('CSV file must have at least 2 rows (header + data)', 'error');
                    return;
                }

                // Parse headers
                const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));

                // Parse data rows (limit to first 1000 for performance)
                const dataRows = [];
                for (let i = 1; i < Math.min(lines.length, 1001); i++) {
                    if (lines[i].trim()) {
                        const row = lines[i].split(',').map(cell => cell.trim().replace(/"/g, ''));
                        if (row.length >= headers.length - 1) { // Allow slight mismatch
                            const rowObj = {};
                            headers.forEach((header, index) => {
                                rowObj[header] = row[index] || '';
                            });
                            dataRows.push(rowObj);
                        }
                    }
                }

                // Store data globally
                window.uploadedFileData = {
                    filename: file.name,
                    size: formatFileSize(file.size),
                    totalRows: lines.length - 1,
                    headers: headers,
                    data: dataRows
                };

                // Display file info
                displayEnhancedFileInfo();

                // Show success banner
                const successBanner = document.getElementById('uploadSuccessBanner');
                if (successBanner) {
                    successBanner.classList.add('show');
                }

                // Enable filtering
                const applyButton = document.querySelector('button[onclick*="applyFiltering"]');
                if (applyButton) {
                    applyButton.disabled = false;
                    applyButton.style.opacity = '1';
                    applyButton.innerHTML = 'üîç Apply Filters & Show Summary (File Ready!)';
                }

            } catch (error) {
                console.error('Error parsing CSV:', error);
                showToast('Error parsing CSV file. Please check the format.', 'error');
            }
        };

        reader.onerror = function() {
            showToast('Error reading file', 'error');
        };

        reader.readAsText(file);
    }

    function displayEnhancedFileInfo() {
        const data = window.uploadedFileData;
        if (!data) return;

        // Update file stats
        const fileNameStat = document.getElementById('fileNameStat');
        const fileSizeStat = document.getElementById('fileSizeStat');
        const totalRowsStat = document.getElementById('totalRowsStat');
        const columnsStat = document.getElementById('columnsStat');
        const columnsDisplay = document.getElementById('columnsDisplay');
        const filePreview = document.getElementById('filePreview');
        const fileInfoSection = document.getElementById('fileInfoSection');

        if (fileNameStat) fileNameStat.textContent = data.filename;
        if (fileSizeStat) fileSizeStat.textContent = data.size;
        if (totalRowsStat) totalRowsStat.textContent = data.totalRows.toLocaleString();
        if (columnsStat) columnsStat.textContent = data.headers.length;

        // Display columns
        if (columnsDisplay) {
            columnsDisplay.innerHTML = data.headers.map(header => 
                `<span style="display: inline-block; background: var(--primary-color); color: white; padding: 4px 8px; margin: 2px; border-radius: 4px; font-size: 0.8rem;">${header}</span>`
            ).join('');
        }

        // Display preview
        if (filePreview && data.data.length > 0) {
            const previewData = data.data.slice(0, 5);
            let tableHTML = '<table style="width: 100%; border-collapse: collapse;"><thead><tr>';
            data.headers.forEach(header => {
                tableHTML += `<th style="border: 1px solid var(--border-color); padding: 8px; background: var(--gray-100);">${header}</th>`;
            });
            tableHTML += '</tr></thead><tbody>';

            previewData.forEach(row => {
                tableHTML += '<tr>';
                data.headers.forEach(header => {
                    const cellValue = row[header] || '';
                    tableHTML += `<td style="border: 1px solid var(--border-color); padding: 8px; font-size: 0.8rem;">${cellValue}</td>`;
                });
                tableHTML += '</tr>';
            });
            tableHTML += '</tbody></table>';
            filePreview.innerHTML = tableHTML;
        }

        // Show file info section
        if (fileInfoSection) {
            fileInfoSection.style.display = 'block';
        }
    }

    function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }


        // Global variables for enhanced functionality
        let currentFileData = null;
        let currentTab = 0;
        const tabs = ['setup', 'ranking', 'results'];
        let autoSaveTimeouts = {};
        let filteringStats = {
            total: 0,
            blacklisted: 0,
            inProcess: 0,
            available: 0
        };

        // Initialize enhanced functionality
        document.addEventListener('DOMContentLoaded', function() {
            initializeEnhancedFeatures();
            loadFromLocalStorage();
            updateTabProgress();
            updateNavigationButtons();
        });

        function initializeEnhancedFeatures() {
            // Initialize tabs
            initTabs();

            // Initialize file upload
            initFileUpload();

            // Initialize profile input toggles
            initProfileInputs();

            // Load saved session
            loadSession();

            // Initialize auto-save for all inputs
            initAutoSave();

            console.log('‚úÖ Enhanced Scorely Beta initialized');
        }

        // Enhanced File Upload with Loading Indicators
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            showLoadingOverlay('üìÅ Analyzing file...', 0);

            const uploadArea = document.querySelector('.upload-area-enhanced');
            uploadArea.classList.add('uploading');

            // Simulate file processing with progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 20;
                if (progress > 90) progress = 90;

                updateProgressBar(progress, `Processing ${file.name}...`);
            }, 200);

            // Simulate file analysis
            setTimeout(() => {
                clearInterval(progressInterval);
                analyzeFile(file);
                hideLoadingOverlay();
                uploadArea.classList.remove('uploading');

                // Show file info
                const fileInfo = document.getElementById('fileInfoEnhanced');
                fileInfo.classList.add('show');

                showAutoSaveIndicator('File analyzed successfully!', 'saved');
            }, 2000);
        }

        function analyzeFile(file) {
            // Simulate file analysis
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                const lines = content.split('
');
                const validLines = lines.filter(line => line.trim().length > 0);

                // Update file stats
                document.getElementById('fileNameStat').textContent = file.name;
                document.getElementById('fileSizeStat').textContent = formatFileSize(file.size);
                document.getElementById('totalRowsStat').textContent = lines.length - 1; // Minus header
                document.getElementById('validProfilesStat').textContent = validLines.length - 1;
                document.getElementById('columnsStat').textContent = (lines[0] || '').split(',').length;

                // Store file data
                currentFileData = {
                    name: file.name,
                    size: file.size,
                    rows: lines.length - 1,
                    validProfiles: validLines.length - 1,
                    columns: (lines[0] || '').split(',').length,
                    content: content
                };

                // Update filtering stats
                filteringStats.total = currentFileData.validProfiles;
                updateFilteringStats();

                // Save to localStorage
                saveToLocalStorage('fileData', currentFileData);

                console.log('üìä File analyzed:', currentFileData);
            };
            reader.readAsText(file);
        }

        // Drag and Drop Enhancement
        function handleDragOver(event) {
            event.preventDefault();
            event.target.closest('.upload-area-enhanced').classList.add('dragover');
        }

        function handleDragLeave(event) {
            event.target.closest('.upload-area-enhanced').classList.remove('dragover');
        }

        function handleDrop(event) {
            event.preventDefault();
            event.target.closest('.upload-area-enhanced').classList.remove('dragover');

            const files = event.dataTransfer.files;
            if (files.length > 0) {
                document.getElementById('csvFile').files = files;
                handleFileUpload({ target: { files: files } });
            }
        }

        // Auto-save Functionality
        function initAutoSave() {
            const autoSaveInputs = [
                'embeddingApiKey', 'gptApiKey', 'blacklistCompanies', 'inProcessCandidates',
                'profile1Text', 'profile2Text', 'jobDesc', 'keyAchievements', 
                'additionalKeywords', 'aiInstructions', 'educationLevel', 'location'
            ];

            autoSaveInputs.forEach(inputId => {
                const element = document.getElementById(inputId);
                if (element) {
                    element.addEventListener('input', () => handleAutoSave(inputId));
                }
            });
        }

        function handleAutoSave(inputId) {
            const element = document.getElementById(inputId);
            if (!element) return;

            // Clear existing timeout
            if (autoSaveTimeouts[inputId]) {
                clearTimeout(autoSaveTimeouts[inputId]);
            }

            // Show saving indicator
            showInputSaveIndicator(inputId, 'saving');

            // Set new timeout for auto-save
            autoSaveTimeouts[inputId] = setTimeout(() => {
                const value = element.value;
                saveToLocalStorage(inputId, value);
                showInputSaveIndicator(inputId, 'saved');

                console.log(`üíæ Auto-saved: ${inputId}`);

                // Hide indicator after 2 seconds
                setTimeout(() => {
                    hideInputSaveIndicator(inputId);
                }, 2000);
            }, 1000); // Save after 1 second of no typing
        }

        function showInputSaveIndicator(inputId, state) {
            const indicator = document.getElementById(inputId + 'SaveIndicator');
            if (indicator) {
                indicator.className = 'input-save-indicator ' + state;
                indicator.textContent = state === 'saving' ? 'üíæ' : '‚úÖ';
            }
        }

        function hideInputSaveIndicator(inputId) {
            const indicator = document.getElementById(inputId + 'SaveIndicator');
            if (indicator) {
                indicator.className = 'input-save-indicator';
            }
        }

        // Enhanced Filtering with Real-time Updates
        function updateFilteringStats() {
            if (!currentFileData) return;

            const blacklistText = document.getElementById('blacklistCompanies')?.value || '';
            const inProcessText = document.getElementById('inProcessCandidates')?.value || '';

            // Simulate filtering logic
            const blacklistItems = blacklistText.split(',').map(item => item.trim()).filter(item => item.length > 0);
            const inProcessItems = inProcessText.split(',').map(item => item.trim()).filter(item => item.length > 0);

            // Estimate filtering impact (simplified calculation)
            const blacklistFiltered = Math.floor(blacklistItems.length * 0.8); // Assume each blacklist item filters ~0.8 profiles
            const inProcessFiltered = inProcessItems.length;

            filteringStats.blacklisted = Math.min(blacklistFiltered, filteringStats.total);
            filteringStats.inProcess = Math.min(inProcessFiltered, filteringStats.total - filteringStats.blacklisted);
            filteringStats.available = filteringStats.total - filteringStats.blacklisted - filteringStats.inProcess;

            // Update live stats
            updateLiveFilteringDisplay();

            // Update dashboard if visible
            updateFilteringDashboard();
        }

        function updateLiveFilteringDisplay() {
            document.getElementById('liveTotalProfiles').textContent = filteringStats.total;
            document.getElementById('liveBlacklistMatches').textContent = filteringStats.blacklisted;
            document.getElementById('liveInProcessMatches').textContent = filteringStats.inProcess;
            document.getElementById('liveAvailableProfiles').textContent = filteringStats.available;
        }

        function updateFilteringDashboard() {
            const total = filteringStats.total;
            if (total === 0) return;

            document.getElementById('totalProfilesNum').textContent = total;
            document.getElementById('totalProfilesPerc').textContent = '100%';

            document.getElementById('blacklistFilteredNum').textContent = filteringStats.blacklisted;
            document.getElementById('blacklistFilteredPerc').textContent = 
                Math.round((filteringStats.blacklisted / total) * 100) + '%';

            document.getElementById('inProcessFilteredNum').textContent = filteringStats.inProcess;
            document.getElementById('inProcessFilteredPerc').textContent = 
                Math.round((filteringStats.inProcess / total) * 100) + '%';

            document.getElementById('remainingForRankingNum').textContent = filteringStats.available;
            document.getElementById('remainingForRankingPerc').textContent = 
                Math.round((filteringStats.available / total) * 100) + '%';
        }

        function applyFiltering() {
            showLoadingOverlay('üîç Applying filters...', 0);

            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 25;
                if (progress > 90) progress = 90;
                updateProgressBar(progress, 'Processing filters...');
            }, 300);

            setTimeout(() => {
                clearInterval(progressInterval);
                updateProgressBar(100, 'Filtering complete!');

                // Show enhanced dashboard
                const dashboard = document.getElementById('filteringDashboardEnhanced');
                dashboard.classList.add('show');

                updateFilteringDashboard();

                setTimeout(() => {
                    hideLoadingOverlay();
                    showAutoSaveIndicator('Filtering applied successfully!', 'saved');
                }, 500);
            }, 2000);
        }

        // Ideal Profile Save Confirmation
        function handleIdealProfileSave(profileNumber, type) {
            const confirmationId = `profile${profileNumber}Confirmation`;
            const confirmation = document.getElementById(confirmationId);

            if (confirmation) {
                confirmation.classList.add('show');

                // Hide after 3 seconds
                setTimeout(() => {
                    confirmation.classList.remove('show');
                }, 3000);
            }

            // Save to localStorage
            const textElementId = `profile${profileNumber}Text`;
            const textElement = document.getElementById(textElementId);
            if (textElement && textElement.value.trim()) {
                saveToLocalStorage(textElementId, textElement.value);
                console.log(`‚úÖ Ideal Profile #${profileNumber} saved`);
            }
        }

        // Navigation Enhancement
        function updateTabProgress() {
            const progressFill = document.getElementById('tabProgress');
            const stepText = document.getElementById('currentStepText');

            if (progressFill && stepText) {
                const progressPercent = ((currentTab + 1) / tabs.length) * 100;
                progressFill.style.width = progressPercent + '%';

                const stepNames = ['Setup', 'Ranking', 'Results'];
                stepText.textContent = `Step ${currentTab + 1} of ${tabs.length}: ${stepNames[currentTab]}`;
            }
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            if (prevBtn) {
                prevBtn.disabled = currentTab === 0;
            }

            if (nextBtn) {
                nextBtn.disabled = currentTab === tabs.length - 1;
                nextBtn.textContent = currentTab === tabs.length - 1 ? 'Complete' : 'Next ‚Üí';
            }
        }

        function previousTab() {
            if (currentTab > 0) {
                currentTab--;
                switchTab(tabs[currentTab]);
                updateTabProgress();
                updateNavigationButtons();
            }
        }

        function nextTab() {
            if (currentTab < tabs.length - 1) {
                currentTab++;
                switchTab(tabs[currentTab]);
                updateTabProgress();
                updateNavigationButtons();
            }
        }

        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab content
            const targetContent = document.getElementById(tabName);
            if (targetContent) {
                targetContent.classList.add('active');
            }

            // Add active class to selected tab button
            const targetBtn = document.querySelector(`[data-tab="${tabName}"]`);
            if (targetBtn) {
                targetBtn.classList.add('active');
            }

            // Update current tab index
            currentTab = tabs.indexOf(tabName);
            updateTabProgress();
            updateNavigationButtons();
        }

        // Loading Overlay Functions
        function showLoadingOverlay(text = 'Loading...', progress = 0) {
            const overlay = document.getElementById('loadingOverlay');
            const loadingText = document.getElementById('loadingText');

            if (overlay && loadingText) {
                loadingText.textContent = text;
                updateProgressBar(progress, text);
                overlay.style.display = 'flex';
            }
        }

        function hideLoadingOverlay() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.style.display = 'none';
            }
        }

        function updateProgressBar(percentage, text = '') {
            const progressBar = document.getElementById('progressBar');
            const loadingText = document.getElementById('loadingText');

            if (progressBar) {
                progressBar.style.width = Math.min(percentage, 100) + '%';
                progressBar.textContent = Math.round(percentage) + '%';
            }

            if (loadingText && text) {
                loadingText.textContent = text;
            }
        }

        // Auto-save Indicator Functions
        function showAutoSaveIndicator(message, type = 'saved') {
            const indicator = document.getElementById('autoSaveIndicator');
            const saveText = document.getElementById('saveText');

            if (indicator && saveText) {
                saveText.textContent = message;
                indicator.className = `auto-save-indicator ${type}`;

                // Hide after 3 seconds
                setTimeout(() => {
                    indicator.className = 'auto-save-indicator';
                }, 3000);
            }
        }

        // Local Storage Functions
        function saveToLocalStorage(key, value) {
            try {
                localStorage.setItem(`scorely_${key}`, JSON.stringify(value));
            } catch (error) {
                console.error('Failed to save to localStorage:', error);
            }
        }

        function loadFromLocalStorage(key) {
            try {
                const value = localStorage.getItem(`scorely_${key}`);
                return value ? JSON.parse(value) : null;
            } catch (error) {
                console.error('Failed to load from localStorage:', error);
                return null;
            }
        }

        function loadFromLocalStorage() {
            // Load all saved inputs
            const inputs = [
                'embeddingApiKey', 'gptApiKey', 'blacklistCompanies', 'inProcessCandidates',
                'profile1Text', 'profile2Text', 'jobDesc', 'keyAchievements', 
                'additionalKeywords', 'aiInstructions', 'educationLevel', 'location'
            ];

            inputs.forEach(inputId => {
                const element = document.getElementById(inputId);
                const savedValue = loadFromLocalStorage(inputId);

                if (element && savedValue) {
                    element.value = savedValue;
                }
            });

            // Load file data
            const savedFileData = loadFromLocalStorage('fileData');
            if (savedFileData) {
                currentFileData = savedFileData;
                filteringStats.total = savedFileData.validProfiles || 0;

                // Restore file info display
                if (savedFileData.name) {
                    document.getElementById('fileNameStat').textContent = savedFileData.name;
                    document.getElementById('fileSizeStat').textContent = formatFileSize(savedFileData.size);
                    document.getElementById('totalRowsStat').textContent = savedFileData.rows;
                    document.getElementById('validProfilesStat').textContent = savedFileData.validProfiles;
                    document.getElementById('columnsStat').textContent = savedFileData.columns;

                    const fileInfo = document.getElementById('fileInfoEnhanced');
                    if (fileInfo) fileInfo.classList.add('show');
                }
            }

            // Update filtering stats
            updateFilteringStats();

            console.log('üì• Data loaded from localStorage');
        }

        // Utility Functions
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Enhanced Tab Initialization
        function initTabs() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    if (tabName) {
                        switchTab(tabName);
                    }
                });
            });
        }

        // Keep existing functions from original code...
        function initFileUpload() {
            console.log('File upload initialized');
        }

        function initProfileInputs() {
            // Profile 1
            const p1Pdf = document.getElementById('p1-pdf');
            const p1Text = document.getElementById('p1-text');

            if (p1Pdf) {
                p1Pdf.addEventListener('change', function() {
                    const fileInput = document.getElementById('profile1File');
                    const textInput = document.getElementById('profile1Text');
                    if (fileInput && textInput) {
                        fileInput.style.display = this.checked ? 'block' : 'none';
                        textInput.style.display = this.checked ? 'none' : 'block';
                    }
                });
            }

            if (p1Text) {
                p1Text.addEventListener('change', function() {
                    const fileInput = document.getElementById('profile1File');
                    const textInput = document.getElementById('profile1Text');
                    if (fileInput && textInput) {
                        fileInput.style.display = this.checked ? 'none' : 'block';
                        textInput.style.display = this.checked ? 'block' : 'none';
                    }
                });
            }

            // Profile 2 - similar logic
            const p2Pdf = document.getElementById('p2-pdf');
            const p2Text = document.getElementById('p2-text');

            if (p2Pdf) {
                p2Pdf.addEventListener('change', function() {
                    const fileInput = document.getElementById('profile2File');
                    const textInput = document.getElementById('profile2Text');
                    if (fileInput && textInput) {
                        fileInput.style.display = this.checked ? 'block' : 'none';
                        textInput.style.display = this.checked ? 'none' : 'block';
                    }
                });
            }

            if (p2Text) {
                p2Text.addEventListener('change', function() {
                    const fileInput = document.getElementById('profile2File');
                    const textInput = document.getElementById('profile2Text');
                    if (fileInput && textInput) {
                        fileInput.style.display = this.checked ? 'none' : 'block';
                        textInput.style.display = this.checked ? 'block' : 'none';
                    }
                });
            }
        }

        function loadSession() {
            console.log('Session loaded');
        }

        function resetSession() {
            if (confirm('üîÑ Are you sure you want to reset all data? This will clear all saved information.')) {
                // Clear localStorage
                Object.keys(localStorage).forEach(key => {
                    if (key.startsWith('scorely_')) {
                        localStorage.removeItem(key);
                    }
                });

                // Clear form inputs
                document.querySelectorAll('input, textarea, select').forEach(element => {
                    if (element.type !== 'radio' && element.type !== 'checkbox') {
                        element.value = '';
                    } else if (element.type === 'radio' || element.type === 'checkbox') {
                        element.checked = false;
                    }
                });

                // Reset to default state
                currentFileData = null;
                filteringStats = { total: 0, blacklisted: 0, inProcess: 0, available: 0 };

                // Hide dynamic elements
                document.getElementById('fileInfoEnhanced')?.classList.remove('show');
                document.getElementById('filteringDashboardEnhanced')?.classList.remove('show');

                // Switch to first tab
                currentTab = 0;
                switchTab('setup');

                showAutoSaveIndicator('üîÑ Session reset successfully!', 'info');

                console.log('üîÑ Session reset completed');
            }
        }

        // Additional enhanced functions can be added here...

        console.log('‚úÖ Enhanced JavaScript loaded successfully');
    </script>


 <!-- Enhanced Modal for Candidate Details -->
 <div id="candidateModal" class="modal">
 <div class="modal-content">
 <div class="modal-header">
 <h2 id="modalTitle">Candidate Details</h2>
 <span class="close" onclick="closeCandidateModal()">&times;</span>
 </div>
 <div class="modal-body" id="modalBody">
 <div style="text-align: center; padding: 2rem;">
 <div class="pulse" style="color: var(--primary-color);">Loading candidate details...</div>
 </div>
 </div>
 </div>
 </div>

 <!-- Additional hidden elements for advanced functionality -->
 <div id="analyticsPanel" style="display: none;">
 <!-- Analytics content would go here -->
 </div>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"94f3124ce9395623","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.6.2","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
